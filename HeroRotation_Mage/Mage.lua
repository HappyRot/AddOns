local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.MultiSpell;local l=d.Item;local m=d.Utils.MergeTableByKey;local n=HeroRotation;local GetTime=GetTime;n.Commons.Mage={}local o=n.GUISettings.APL.Mage.Commons;local p=n.Commons.Mage;if not j.Mage then j.Mage={}end;j.Mage.Commons={AncestralCall=j(274738),BagofTricks=j(312411),Berserking=j(26297),BloodFury=j(20572),Fireblood=j(265221),LightsJudgment=j(255647),ArcaneExplosion=j(1449),ArcaneIntellect=j(1459),Blink=k(1953,212653),Frostbolt=j(116),FrostNova=j(122),SlowFall=j(130),TimeWarp=j(80353),AlterTime=j(342245),BlastWave=j(157981),Counterspell=j(2139),DragonsBreath=j(31661),FocusMagic=j(321358),IceBlock=j(45438),IceFloes=j(108839),IceNova=j(157997),Invisibility=j(66),Meteor=j(153561),MirrorImage=j(55342),RemoveCurse=j(475),RingOfFrost=j(113724),ShiftingPower=j(382440),SpellSteal=j(30449),TemporalWarp=j(386539),ArcaneIntellectBuff=j(1459),BerserkingBuff=j(26297),BloodFuryBuff=j(20572),TemporalWarpBuff=j(386540),SpoilsofNeltharusCrit=j(381954),SpoilsofNeltharusHaste=j(381955),SpoilsofNeltharusMastery=j(381956),SpoilsofNeltharusVers=j(381957),MassBarrier=j(414660),Pool=j(999910)}j.Mage.Arcane=m(j.Mage.Commons,{ArcaneBlast=j(30451),FireBlast=j(319836),Amplification=j(236628),ArcaneBarrage=j(44425),ArcaneBombardment=j(384581),ArcaneEcho=j(342231),ArcaneFamiliar=j(205022),ArcaneHarmony=j(384452),ArcaneMissiles=j(5143),ArcaneOrb=j(153626),ArcanePower=j(321739),ArcaneSurge=j(365350),CascadingPower=j(384276),ChargedOrb=j(384651),ConjureManaGem=j(759),Concentration=j(384374),Enlightened=j(321387),Evocation=j(12051),GreaterInvisibility=j(110959),NetherTempest=j(114923),NetherPrecision=j(383782),OrbBarrage=j(384858),Overpowered=j(155147),PresenceofMind=j(205025),PrismaticBarrier=j(235450),RadiantSpark=j(376103),Resonance=j(205028),RuleofThrees=j(264354),SiphonStorm=j(384187),Slipstream=j(236457),Supernova=j(157980),TimeAnomaly=j(383243),TouchoftheMagi=j(321507),ArcaneArtilleryBuff=j(424331),ArcaneFamiliarBuff=j(210126),ArcaneHarmonyBuff=j(384455),ArcaneOverloadBuff=j(409022),ArcaneSurgeBuff=j(365362),ClearcastingBuff=j(263725),ConcentrationBuff=j(384379),NetherPrecisionBuff=j(383783),PresenceofMindBuff=j(205025),RuleofThreesBuff=j(264774),SiphonStormBuff=j(384267),NetherTempestDebuff=j(114923),RadiantSparkDebuff=j(376103),RadiantSparkVulnerability=j(376104),TouchoftheMagiDebuff=j(210824),StopAM=j(363653)})j.Mage.Fire=m(j.Mage.Commons,{Fireball=j(133),Flamestrike=j(2120),AlexstraszasFury=j(235870),BlazingBarrier=j(235313),Combustion=j(190319),FeeltheBurn=j(383391),FireBlast=j(108853),Firestarter=j(205026),FlameOn=j(205029),FlamePatch=j(205037),FromTheAshes=j(342344),FueltheFire=j(416094),Hyperthermia=j(383860),ImprovedScorch=j(383604),Kindling=j(155148),LivingBomb=j(44457),PhoenixFlames=j(257541),Pyroblast=j(11366),Scorch=j(2948),SearingTouch=j(269644),SunKingsBlessing=j(383886),TemperedFlames=j(383659),CombustionBuff=j(190319),FeeltheBurnBuff=j(383395),FlameAccelerantBuff=j(203277),FlamesFuryBuff=j(409964),HeatingUpBuff=j(48107),HotStreakBuff=j(48108),HyperthermiaBuff=j(383874),SunKingsBlessingBuff=j(383882),FuryoftheSunKingBuff=j(383883),CharringEmbersDebuff=j(408665),IgniteDebuff=j(12654),ImprovedScorchDebuff=j(383608)})j.Mage.Frost=m(j.Mage.Commons,{Blizzard=j(190356),ConeofCold=j(120),FireBlast=j(319836),BoneChilling=j(205027),ChainReaction=j(278309),ColdestSnap=j(417493),CometStorm=j(153595),DeepShatter=j(378749),Flurry=j(44614),FreezingRain=j(270233),FreezingWinds=j(382103),Frostbite=j(378756),FrozenOrb=j(84714),FrozenTouch=j(205030),GlacialSpike=j(199786),IceBarrier=j(11426),IceCaller=j(236662),IceLance=j(30455),IcyVeins=j(12472),RayofFrost=j(205021),SlickIce=j(382144),Snowstorm=j(381706),SplinteringCold=j(379049),SplittingIce=j(56377),Freeze=j(33395),WaterJet=j(135029),BoneChillingBuff=j(205766),BrainFreezeBuff=j(190446),FingersofFrostBuff=j(44544),FreezingRainBuff=j(270232),FreezingWindsBuff=j(382106),GlacialSpikeBuff=j(199844),IciclesBuff=j(205473),IcyVeinsBuff=j(12472),SnowstormBuff=j(381522),FrostbiteDebuff=j(378760),WintersChillDebuff=j(228358)})if not l.Mage then l.Mage={}end;l.Mage.Commons={AshesoftheEmbersoul=l(207167,{13,14}),BalefireBranch=l(159630,{13,14}),BeacontotheBeyond=l(203963,{13,14}),BelorrelostheSuncaller=l(207172,{13,14}),ConjuredChillglobe=l(194300,{13,14}),DesperateInvokersCodex=l(194310,{13,14}),DMDDance=l(198088,{13,14}),DMDDanceBox=l(198478,{13,14}),DMDInferno=l(198086,{13,14}),DMDInfernoBox=l(194872,{13,14}),DMDRime=l(198087,{13,14}),DMDRimeBox=l(198477,{13,14}),DragonfireBombDispenser=l(202610,{13,14}),EruptingSpearFragment=l(193769,{13,14}),HornofValor=l(133642,{13,14}),IcebloodDeathsnare=l(194304,{13,14}),IrideusFragment=l(193743,{13,14}),MirrorofFracturedTomorrows=l(207581,{13,14}),MoonlitPrism=l(137541,{13,14}),NeltharionsCalltoChaos=l(204201,{13,14}),NymuesUnravelingSpindle=l(208615,{13,14}),SeaStar=l(56290,{13,14}),SpoilsofNeltharus=l(193773,{13,14}),TimebreachingTalon=l(193791,{13,14}),TimeThiefsGambit=l(207579,{13,14}),TomeofUnstablePower=l(193628,{13,14}),VoidmendersShadowgem=l(110007,{13,14}),CrimsonGladiatorsBadge=l(201807,{13,14}),ObsidianGladiatorsBadge=l(205708,{13,14}),VerdantGladiatorsBadge=l(209343,{13,14}),Dreambinder=l(208616,{16}),IridaltheEarthsMaster=l(208321,{16})}l.Mage.Arcane=m(l.Mage.Commons,{ManaGem=l(36799)})l.Mage.Fire=m(l.Mage.Commons,{})l.Mage.Frost=m(l.Mage.Commons,{})p.IFST={CurrStacks=0,CurrStacksTime=0,OldStacks=0,OldStacksTime=0,Direction=0}local q={}q.IncantersFlowBuff=j(116267)d:RegisterForEvent(function()p.IFST.CurrStacks=0;p.IFST.CurrStacksTime=0;p.IFST.OldStacks=0;p.IFST.OldStacksTime=0;p.IFST.Direction=0 end,"PLAYER_REGEN_ENABLED")function p.IFTracker()if d.CombatTime()==0 then return end;local r=p.IFST.CurrStacksTime-p.IFST.OldStacksTime;local s=p.IFST.CurrStacks;local t=p.IFST.CurrStacksTime;local u=p.IFST.OldStacks;if g:BuffUp(q.IncantersFlowBuff)then if g:BuffStack(q.IncantersFlowBuff)~=s or g:BuffStack(q.IncantersFlowBuff)==s and r>1 then p.IFST.OldStacks=s;p.IFST.OldStacksTime=t end;p.IFST.CurrStacks=g:BuffStack(q.IncantersFlowBuff)p.IFST.CurrStacksTime=d.CombatTime()if p.IFST.CurrStacks>p.IFST.OldStacks then if p.IFST.CurrStacks==5 then p.IFST.Direction=0 else p.IFST.Direction=1 end elseif p.IFST.CurrStacks<p.IFST.OldStacks then if p.IFST.CurrStacks==1 then p.IFST.Direction=0 else p.IFST.Direction=-1 end else if p.IFST.CurrStacks==1 then p.IFST.Direction=1 else p.IFST.Direction=-1 end end else p.IFST.OldStacks=0;p.IFST.OldStacksTime=0;p.IFST.CurrStacks=0;p.IFST.CurrStacksTime=0;p.IFST.Direction=0 end end;function p.IFTimeToX(v,w)local x;local y;local z;if p.IFST.Direction==-1 or p.IFST.Direction==0 and p.IFST.CurrStacks==0 then z=10-p.IFST.CurrStacks+1 else z=p.IFST.CurrStacks end;if w=="up"then x=v;y=v elseif w=="down"then x=10-v+1;y=10-v+1 else x=v;y=10-v+1 end;if x==z or y==z then return 0 end;local A=(10+x-z)%10;local B=(10+y-z)%10;return p.IFST.CurrStacksTime-p.IFST.OldStacksTime+math.min(A,B)-1 end