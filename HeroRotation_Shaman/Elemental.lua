local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Pet;local i=f.Target;local j=d.Spell;local k=d.MultiSpell;local l=d.Item;local m=HeroRotation;local n=m.Cast;local o=m.AoEON;local p=m.CDsON;local q=HeroRotationCharDB.Toggles[4]local r=HeroRotationCharDB.Toggles[5]local s=HeroRotationCharDB.Toggles[6]local t=HeroRotationCharDB.Toggles[15]local u=HeroRotationCharDB.Toggles[12]local v=HeroRotationCharDB.Toggles[60]local w=HeroRotationCharDB.Toggles[90]local x=HeroRotationCharDB.Toggles[91]local y=HeroRotationCharDB.Toggles[92]local z=HeroRotationCharDB.Toggles[93]local A=HeroRotationCharDB.Toggles[94]local B=HeroRotationCharDB.Toggles[96]local C=HeroRotationCharDB.Toggles[95]local D=HeroRotationCharDB.Toggles[97]local E=0;local UnitPower=UnitPower;local F=Enum.PowerType.Maelstrom;local G=j.Shaman.Elemental;local H=l.Shaman.Elemental;local I={}local J=g:GetEquipment()local K=l(0)local L=l(0)local M,N=GetInventoryItemID("player",13)local O,N=GetInventoryItemID("player",14)local P;local Q,R,S,T;local U,V;local W;local X;local Y=0;local Z=0;local _=0;local a0=m.Commons.Everyone;local a1=m.Commons.Shaman;local a2={General=m.GUISettings.General,Commons=m.GUISettings.APL.Shaman.Commons,Elemental=m.GUISettings.APL.Shaman.Elemental}local a3=g:HasLegendaryEquipped(131)local a4=g:HasLegendaryEquipped(134)local a5=g:HasLegendaryEquipped(135)local a6=g:HasLegendaryEquipped(136)local a7=g:HasLegendaryEquipped(137)local a8=G.CallOfFlame:ConduitEnabled()local a9=g:HasLegendaryEquipped(246)or g:HasUnity()and G.FaeTransfusion:IsAvailable()local aa=g:HasLegendaryEquipped(228)or g:HasUnity()and G.PrimordialWave:IsAvailable()d:RegisterForEvent(function()a3=g:HasLegendaryEquipped(131)a4=g:HasLegendaryEquipped(134)a5=g:HasLegendaryEquipped(135)a6=g:HasLegendaryEquipped(136)a7=g:HasLegendaryEquipped(137)a8=G.CallOfFlame:ConduitEnabled()aa=g:HasLegendaryEquipped(228)end,"PLAYER_EQUIPMENT_CHANGED")d:RegisterForEvent(function()G.PrimordialWave:RegisterInFlightEffect(327162)G.PrimordialWave:RegisterInFlight()G.LavaBurst:RegisterInFlight()end,"LEARNED_SPELL_IN_TAB")G.PrimordialWave:RegisterInFlightEffect(327162)G.PrimordialWave:RegisterInFlight()G.LavaBurst:RegisterInFlight()local function ab(ac)if ac then return 1 else return 0 end end;local function ad(ac)return ac~=0 end;local ae;local af;local ag;local ah;local ai;local aj;local ak;local al;local am;local an;local function ao()ae=0;af=0;ag=0;ah=0;ai=0;al={}aj=nil;ak=nil;local ap=999;local aq=0;if o()then for N,ar in pairs(g:GetEnemiesInRange(40))do if ar:AffectingCombat()or ar:IsDummy()or ar:NPCID()==153285 then ae=ae+1;local as=ar:DebuffRemains(G.FlameShockDebuff)if as>0 then ag=ag+1 end;if as<5 then ah=ah+1 end;if as<ap then ap=as;ak=ar end;if as==0 and ar:Health()>aq then aq=ar:Health()ak=ar end;local at=ar:GetEnemiesInSplashRange(10)local au={}for N,av in pairs(at)do local aw=false;for N,ax in pairs(au)do if av:GUID()==ax:GUID()then aw=true;break end end;if not aw then table.insert(au,av)end end;al[ar]=au;if#au>af then af=#au;aj=ar end;if not ar:TimeToDieIsNotValid()and not ar:IsUserCycleBlacklisted()then ai=math.max(ai,ar:TimeToDie())end end end else ae=1;local as=i:DebuffRemains(G.FlameShockDebuff)if as>0 then ag=1 end;if as<5 then ah=1 end;ak=i;af=1;aj=i;if not i:TimeToDieIsNotValid()and not i:IsUserCycleBlacklisted()then ai=i:TimeToDie()end end end;local function ay()am=false;an=false;local az=h:IsActive()local aA=h:NPCID()if az then if aA==77942 then am=true elseif aA==61029 then an=true end end end;local function aB(aC)if aC==nil then return nil end;local aD=aC:IsCastable()and aC:IsReady()if aC==G.Stormkeeper or aC==G.ElementalBlast or aC==G.Icefury then local aE=not g:IsMoving()or g:BuffUp(G.SpiritwalkersGraceBuff)return aD and aE and not g:IsCasting(aC)elseif aC==G.LightningBolt or aC==G.ChainLightning then local aE=not g:IsMoving()or g:BuffUp(G.StormkeeperBuff)or g:BuffUp(G.SpiritwalkersGraceBuff)return aD and aE elseif aC==G.LavaBurst then local aE=not g:IsMoving()or g:BuffUp(G.LavaSurgeBuff)or g:BuffUp(G.SpiritwalkersGraceBuff)local aF=g:BuffUp(G.LavaSurgeBuff)local aG=not g:IsCasting(G.LavaBurst)and G.LavaBurst:Charges()>=1;local aH=g:IsCasting(G.LavaBurst)and G.LavaBurst:Charges()==2;return aD and aE and(aF or aG or aH)elseif aC==G.PrimordialWave then return aD and not g:BuffUp(G.PrimordialWaveBuff)and not g:BuffUp(G.LavaSurgeBuff)else return aD end end;local function aI(aJ)return aJ:DebuffRemains(G.FlameShockDebuff)end;local function aK(aJ)return aJ:DebuffDown(G.FlameShockDebuff)end;local function aL(aJ)if g:BuffDown(G.PrimordialWaveBuff)and(not am or V<3 and g:BuffStack(G.WindGustBuff)<20 or G.LeadByExample:SoulbindEnabled()or aa)and(V<5 or G.MasterOfTheElements:IsAvailable()or a4 or G.LeadByExample:SoulbindEnabled()or aa)and not g:BuffUp(G.SplinteredElementsBuff)and aJ:IsInRange(40)and aJ:GUID()==f("mouseover"):GUID()then Y=1326059;return true elseif g:BuffDown(G.PrimordialWaveBuff)and(not am or V<3 and g:BuffStack(G.WindGustBuff)<20 or G.LeadByExample:SoulbindEnabled()or aa)and(V<5 or G.MasterOfTheElements:IsAvailable()or a4 or G.LeadByExample:SoulbindEnabled()or aa)and not g:BuffUp(G.SplinteredElementsBuff)and aJ:IsInRange(40)and a2.Elemental.TargetSwap=="AutoSwap"and aJ:GUID()~=i:GUID()and not u then Y=999;return true elseif g:BuffDown(G.PrimordialWaveBuff)and(not am or V<3 and g:BuffStack(G.WindGustBuff)<20 or G.LeadByExample:SoulbindEnabled()or aa)and(V<5 or G.MasterOfTheElements:IsAvailable()or a4 or G.LeadByExample:SoulbindEnabled()or aa)and not g:BuffUp(G.SplinteredElementsBuff)and aJ:IsInRange(40)and aJ:GUID()==i:GUID()then Z=326059;return true elseif g:BuffDown(G.PrimordialWaveBuff)and(not am or V<3 and g:BuffStack(G.WindGustBuff)<20 or G.LeadByExample:SoulbindEnabled()or aa)and(V<5 or G.MasterOfTheElements:IsAvailable()or a4 or G.LeadByExample:SoulbindEnabled()or aa)and not g:BuffUp(G.SplinteredElementsBuff)and aJ:IsInRange(40)then return true end end;local function aM(aJ)if G.PrimordialWave:IsAvailable()and g:BuffDown(G.PrimordialWaveBuff)and g:BuffDown(G.SplinteredElementsBuff)and aJ:IsInRange(40)and aJ:GUID()==f("mouseover"):GUID()then Y=1326059;return true elseif G.PrimordialWave:IsAvailable()and g:BuffDown(G.PrimordialWaveBuff)and g:BuffDown(G.SplinteredElementsBuff)and aJ:IsInRange(40)and a2.Elemental.TargetSwap=="AutoSwap"and aJ:GUID()~=i:GUID()and not u then Y=999;return true elseif G.PrimordialWave:IsAvailable()and g:BuffDown(G.PrimordialWaveBuff)and g:BuffDown(G.SplinteredElementsBuff)and aJ:IsInRange(40)and aJ:GUID()==i:GUID()then Z=326059;return true elseif G.PrimordialWave:IsAvailable()and g:BuffDown(G.PrimordialWaveBuff)and g:BuffDown(G.SplinteredElementsBuff)and aJ:IsInRange(40)then return true end end;local function aN(aJ)if aJ:DebuffDown(G.FlameShockDebuff)and(not am or V<3 and g:BuffStack(G.WindGustBuff)<20)and(V<3 or G.MasterOfTheElements:IsAvailable()or a4)and aJ:IsInRange(40)and aJ:GUID()==f("mouseover"):GUID()then Y=1188389;return true elseif aJ:DebuffDown(G.FlameShockDebuff)and(not am or V<3 and g:BuffStack(G.WindGustBuff)<20)and(V<3 or G.MasterOfTheElements:IsAvailable()or a4)and aJ:IsInRange(40)and a2.Elemental.TargetSwap=="AutoSwap"and aJ:GUID()~=i:GUID()and not u then Y=999;return true elseif aJ:DebuffDown(G.FlameShockDebuff)and(not am or V<3 and g:BuffStack(G.WindGustBuff)<20)and(V<3 or G.MasterOfTheElements:IsAvailable()or a4)and aJ:IsInRange(40)and aJ:GUID()==i:GUID()then Z=188389;return true elseif aJ:DebuffDown(G.FlameShockDebuff)and(not am or V<3 and g:BuffStack(G.WindGustBuff)<20)and(V<3 or G.MasterOfTheElements:IsAvailable()or a4)and aJ:IsInRange(40)then return true end end;local function aO(aJ)if(aJ:DebuffRefreshable(G.FlameShockDebuff)or aJ:DebuffDown(G.FlameShockDebuff))and aJ:IsInRange(40)and aJ:GUID()==f("mouseover"):GUID()then Y=1188389;return true elseif(aJ:DebuffRefreshable(G.FlameShockDebuff)or aJ:DebuffDown(G.FlameShockDebuff))and aJ:IsInRange(40)and a2.Elemental.TargetSwap=="AutoSwap"and aJ:GUID()~=i:GUID()and not u then Y=999;return true elseif(aJ:DebuffRefreshable(G.FlameShockDebuff)or aJ:DebuffDown(G.FlameShockDebuff))and aJ:IsInRange(40)and aJ:GUID()==i:GUID()then Z=188389;return true elseif(aJ:DebuffRefreshable(G.FlameShockDebuff)or aJ:DebuffDown(G.FlameShockDebuff))and aJ:IsInRange(40)then return true end end;local function aP(aJ)if(aJ:DebuffDown(G.FlameShockDebuff)or aJ:DebuffRemains(G.FlameShockDebuff)<=g:GCD()or G.Ascendance:IsAvailable()and aJ:DebuffRemains(G.FlameShockDebuff)<G.Ascendance:CooldownRemains()+g:BuffRemains(G.AscendanceBuff)and G.Ascendance:CooldownRemains()<4)and(g:BuffUp(G.LavaSurgeBuff)or not g:BloodlustUp())and aJ:IsInRange(40)and aJ:GUID()==f("mouseover"):GUID()then Y=1188389;return true elseif(aJ:DebuffDown(G.FlameShockDebuff)or aJ:DebuffRemains(G.FlameShockDebuff)<=g:GCD()or G.Ascendance:IsAvailable()and aJ:DebuffRemains(G.FlameShockDebuff)<G.Ascendance:CooldownRemains()+g:BuffRemains(G.AscendanceBuff)and G.Ascendance:CooldownRemains()<4)and(g:BuffUp(G.LavaSurgeBuff)or not g:BloodlustUp())and aJ:IsInRange(40)and a2.Elemental.TargetSwap=="AutoSwap"and aJ:GUID()~=i:GUID()and not u then Y=999;return true elseif(aJ:DebuffDown(G.FlameShockDebuff)or aJ:DebuffRemains(G.FlameShockDebuff)<=g:GCD()or G.Ascendance:IsAvailable()and aJ:DebuffRemains(G.FlameShockDebuff)<G.Ascendance:CooldownRemains()+g:BuffRemains(G.AscendanceBuff)and G.Ascendance:CooldownRemains()<4)and(g:BuffUp(G.LavaSurgeBuff)or not g:BloodlustUp())and aJ:IsInRange(40)and aJ:GUID()==i:GUID()then Z=188389;return true elseif(aJ:DebuffDown(G.FlameShockDebuff)or aJ:DebuffRemains(G.FlameShockDebuff)<=g:GCD()or G.Ascendance:IsAvailable()and aJ:DebuffRemains(G.FlameShockDebuff)<G.Ascendance:CooldownRemains()+g:BuffRemains(G.AscendanceBuff)and G.Ascendance:CooldownRemains()<4)and(g:BuffUp(G.LavaSurgeBuff)or not g:BloodlustUp())and aJ:IsInRange(40)then return true end end;local function aQ(aJ)if aJ:DebuffRemains(G.FlameShock)>G.LavaBurst:CastTime()and aJ:IsInRange(40)and aJ:GUID()==f("mouseover"):GUID()then Y=151505;return true elseif aJ:DebuffRemains(G.FlameShock)>G.LavaBurst:CastTime()and aJ:IsInRange(40)and a2.Elemental.TargetSwap=="AutoSwap"and aJ:GUID()~=i:GUID()and not u then Y=999;return true elseif aJ:DebuffRemains(G.FlameShock)>G.LavaBurst:CastTime()and aJ:IsInRange(40)and aJ:GUID()==i:GUID()then Z=51505;return true elseif aJ:DebuffRemains(G.FlameShock)>G.LavaBurst:CastTime()and aJ:IsInRange(40)then return true end end;local function aR()local aS=UnitPower("player",F)if not g:IsCasting()then return aS else if g:IsCasting(G.ElementalBlast)then return aS+30 elseif g:IsCasting(G.Icefury)then return aS+25 elseif g:IsCasting(G.LightningBolt)then return aS+8 elseif g:IsCasting(G.LavaBurst)then return aS+10*(1+ab(g:BuffUp(G.PrimordialWaveBuff))*ag)elseif g:IsCasting(G.ChainLightning)then return aS+4*ae else return aS end end end;local function aT()if not G.MasterOfTheElements:IsAvailable()then return false end;local aU=g:BuffUp(G.MasterOfTheElementsBuff)if not g:IsCasting()then return aU else if g:IsCasting(G.LavaBurst)then return true elseif g:IsCasting(G.ElementalBlast)then return false elseif g:IsCasting(G.Icefury)then return false elseif g:IsCasting(G.LightningBolt)then return false elseif g:IsCasting(G.ChainLightning)then return false else return aU end end end;local function aV()if not G.Stormkeeper:IsAvailable()then return false end;local aW=g:BuffUp(G.StormkeeperBuff)if not g:IsCasting()then return aW else if g:IsCasting(G.Stormkeeper)then return true else return aW end end end;local function aX()if not G.Icefury:IsAvailable()then return false end;local aY=g:BuffUp(G.IcefuryBuff)if not g:IsCasting()then return aY else if g:IsCasting(G.Icefury)then return true else return aY end end end;local function aZ()if aB(G.EarthElemental)and not w and i:IsSpellInRange(G.LightningBolt)and not G.PrimalElementalist:IsAvailable()and p()then if n(G.EarthElemental,nil,nil)then Z=198103;return"Precombat Earth Ele"end end;if aB(G.Stormkeeper)and(E==0 or E>G.Stormkeeper:ExecuteTime())and i:IsSpellInRange(G.LightningBolt)and G.Stormkeeper:IsAvailable()and r then if n(G.Stormkeeper,nil)then Z=191634;return"Precombat Stormkeeper"end end;if aB(G.FireElemental)and i:IsSpellInRange(G.ElementalBlast)and not G.StormElemental:IsAvailable()then if n(G.FireElemental,nil,nil)then Z=198067;return"Precombat FireElemental"end end;if aB(G.ElementalBlast)and(E==0 or E>G.ElementalBlast:ExecuteTime())and i:IsSpellInRange(G.LightningBolt)and G.ElementalBlast:IsAvailable()and V<3 then if n(G.ElementalBlast,nil,nil,not i:IsSpellInRange(G.ElementalBlast))then Z=117014;return"Precombat Elemental Blast"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and not g:IsCasting(G.LavaBurst)and(not G.ElementalBlast:IsAvailable()and U<3 or aV())then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Precombat Lavaburst"end end;if aB(G.ChainLightning)and(E==0 or E>G.ChainLightning:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and not G.ElementalBlast:IsAvailable()and U>=3 and not aV()then if n(G.ChainLightning,nil)then Z=188443;return"Precombat ChaimLightning"end end;if aB(G.ChainLightning)and(E==0 or E>G.Fleshcraft:ExecuteTime())and G.PustuleEruption:SoulbindEnabled()or G.VolatileSolvent:SoulbindEnabled()and not g:IsMoving()then if n(G.Fleshcraft,nil,nil)then Z=324631;return"Precombat Fleshcraft"end end end;local function a_()if aB(G.StormElemental)and i:IsInRange(40)and G.StormElemental:IsAvailable()and p()then if n(G.StormElemental,nil)then Z=192249;return"Storm Elemental 1"end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and g:BuffUp(G.EchoingShockBuff)then if n(G.Earthquake,nil)then Z=61882;return"EQ 1"end end;if aB(G.ChainHarvest)and(E==0 or E>G.ChainHarvest:ExecuteTime())and i:IsInRange(40)and q then if n(G.ChainHarvest,nil)then Z=320674;return"Chain Harvest 1"end end;if aB(G.Stormkeeper)and(E==0 or E>G.Stormkeeper:ExecuteTime())and i:IsInRange(40)and G.Stormkeeper:IsAvailable()and r then if n(G.Stormkeeper,nil)then Z=191634;return"AoE Stormkeeper 1"end end;if aB(G.FlameShock)and i:IsInRange(40)and(ag<2 and V<=3 and G.PrimordialWave:CooldownRemains()<16 and G.PrimordialWave:IsAvailable()and not am or ag<1 and V>=4 and not am and G.MasterOfTheElements:IsAvailable()or a4 and not am or aa and(ag<3 and not a6 or ag<4)and(G.PrimordialWave:CooldownRemains()<16 or g:BuffUp(G.PrimordialWaveBuff))and i:DebuffRefreshable(G.FlameShockDebuff))then if n(G.FlameShock,nil)then Z=188389;return"Flameshock aoe 1"end end;if aB(G.FlameShock)and(ag<2 and V<=3 and G.PrimordialWave:CooldownRemains()<16 and G.PrimordialWave:IsAvailable()and not am or ag<1 and V>=4 and not am and G.MasterOfTheElements:IsAvailable()or a4 and not am or aa and(ag<3 and not a6 or ag<4)and(G.PrimordialWave:CooldownRemains()<16 or g:BuffUp(G.PrimordialWaveBuff)))then if a0.CastCycle(G.FlameShock,S,aO,not i:IsSpellInRange(G.FlameShock),nil)then return"FlameShock aoe 104"end end;if aB(G.FlameShock)and i:IsInRange(40)and i:DebuffDown(G.FlameShockDebuff)and(not am and(G.MasterOfTheElements:IsAvailable()or a4)or aa and i:DebuffDown(G.FlameShockDebuff)and g:BuffUp(G.PrimordialWaveBuff))then if n(G.FlameShock,nil)then Z=188389;return"Flameshock aoe 2"end end;if aB(G.EchoingShock)and i:IsInRange(40)and r and G.EchoingShock:IsAvailable()and aR()>=60 and(a6 and g:BuffUp(G.EchoesofGreatSunderingBuff)or not a6)then if n(G.EchoingShock,nil)then Z=320125;return"Echoing Shock aoe 2"end end;if aB(G.Ascendance)and i:IsInRange(40)and p()and G.Ascendance:IsAvailable()and not am and(not G.Icefury:IsAvailable()or not aX()and not G.Icefury:CooldownUp(G.Icefury))then if n(G.Ascendance,nil)then Z=114050;return"Ascendance aoe 2"end end;if aB(G.LiquidMagmaTotem)and i:IsInRange(40)and r and G.LiquidMagmaTotem:IsAvailable()then if n(G.LiquidMagmaTotem,nil)then Z=192222;return"LiquidMagmaTotem aoe 2"end end;if aB(G.ChainLightning)and(E==0 or E>G.ChainLightning:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and V<4 and aT()and aR()<50 then if n(G.ChainLightning,nil)then Z=188443;return"ChainLightning aoe 1"end end;if aB(G.EarthShock)and i:IsInRange(40)and a6 and not g:BuffUp(G.EchoesofGreatSunderingBuff)then if n(G.EarthShock,nil)then Z=8042;return"EarthShock aoe 1"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and V<4 and not am and(g:BuffUp(G.LavaSurgeBuff)and not aT()and G.MasterOfTheElements:IsAvailable())then if a0.CastTargetIf(G.LavaBurst,S,"max",aI,aQ)then return"Lava Burst aoe 108"end;if aI(i)and aQ(i)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"LavaBurst aoe 1"end end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and V>=2 and not a6 and(G.MasterOfTheElements:IsAvailable()and aR()>=50 and not aT())then if n(G.Earthquake,nil)then Z=61882;return"EQ aoe 2"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and G.PrimordialWave:IsAvailable()and a6 and g:HasTier(28,4)and g:BuffUp(G.LavaSurgeBuff)and g:BuffDown(G.PrimordialWaveBuff)then if a0.CastTargetIf(G.LavaBurst,S,"max",aI,aQ)then return"Lava Burst aoe 208"end;if aI(i)and aQ(i)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"LavaBurst aoe 2"end end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and g:BuffUp(G.LavaSurgeBuff)and g:BuffUp(G.PrimordialWaveBuff)and(g:BuffRemains(G.PrimordialWaveBuff)<3*g:GCD()or ag==V or ag==3 and not a6 or ag==4)then if a0.CastTargetIf(G.LavaBurst,S,"max",aI,aQ)then return"Lava Burst aoe 208"end;if aI(i)and aQ(i)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"LavaBurst aoe 2"end end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and V<4 and a4 and g:BuffUp(G.LavaSurgeBuff)and G.MasterOfTheElements:IsAvailable()and not aT()and aR()>=50 then if a0.CastTargetIf(G.LavaBurst,S,"max",aI,aQ)then return"Lava Burst aoe 308"end;if aI(i)and aQ(i)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"LavaBurst aoe 3"end end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and(V<4 and a4 and G.MasterOfTheElements:IsAvailable()or G.MasterOfTheElements:IsAvailable()and aR()>=50 and not aT()and(not a6 or g:BuffUp(G.EchoesofGreatSunderingBuff))and not a4)then if a0.CastTargetIf(G.LavaBurst,S,"max",aI,aQ)then return"Lava Burst aoe 408"end;if aI(i)and aQ(i)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"LavaBurst aoe 4"end end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and(V==4 and a4 and g:BuffUp(G.LavaSurgeBuff)and G.MasterOfTheElements:IsAvailable()and not aT()and aR()>=50)then if a0.CastTargetIf(G.LavaBurst,S,"max",aI,aQ)then return"Lava Burst aoe 508"end;if aI(i)and aQ(i)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"LavaBurst aoe 5"end end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and V>=2 then if n(G.Earthquake,nil)then Z=61882;return"EQ aoe 3"end end;if aB(G.ChainLightning)and(E==0 or E>G.ChainLightning:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and(aV()or g:BuffRemains(G.StormkeeperBuff)<3*g:GCD()*g:BuffStack(G.StormkeeperBuff))then if n(G.ChainLightning,nil)then Z=188443;return"ChainLightning aoe 2"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and(g:HasTier(28,4)and g:BuffUp(G.LavaSurgeBuff)and g:BuffDown(G.PrimordialWaveBuff))then if a0.CastTargetIf(G.LavaBurst,S,"max",aI,aQ)then return"Lava Burst aoe 508"end;if aI(i)and aQ(i)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"LavaBurst aoe 6"end end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and(g:HasTier(28,4)and g:BuffUp(G.LavaSurgeBuff)and g:BuffDown(G.PrimordialWaveBuff))then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"LavaBurst aoe 7"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and g:BuffUp(G.LavaSurgeBuff)and V<4 and not am and i:DebuffUp(G.FlameShockDebuff)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst aoe 8"end end;if aB(G.ElementalBlast)and(E==0 or E>G.ElementalBlast:ExecuteTime())and i:IsInRange(40)and G.ElementalBlast:IsAvailable()and V<5 and not am then if n(G.ElementalBlast,nil,nil,not i:IsSpellInRange(G.ElementalBlast))then Z=117014;return"Elemental Blast aoe 1"end end;if aB(G.LavaBeam)and(E==0 or E>G.LavaBeam:ExecuteTime())and i:IsInRange(40)and G.Ascendance:IsAvailable()then if n(G.LavaBeam,nil,nil,not i:IsSpellInRange(G.LavaBeam))then Z=117014;return"LavaBeam aoe 1"end end;if aB(G.ChainLightning)and(E==0 or E>G.ChainLightning:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)then if n(G.ChainLightning,nil)then Z=188443;return"ChainLightning aoe 1"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and g:BuffUp(G.LavaSurgeBuff)and g:IsMoving()then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst aoe 6"end end;if aB(G.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(G.FlameShockDebuff)and g:IsMoving()then if n(G.FlameShock,nil)then Z=188389;return"Flameshock aoe 2"end end;if aB(G.FlameShock)and g:IsMoving()then if a0.CastCycle(G.FlameShock,S,aO,not i:IsSpellInRange(G.FlameShock),nil)then return"FlameShock aoe 204"end end;if aB(G.FrostShock)and i:IsInRange(40)and g:IsMoving()then if n(G.FrostShock,nil)then Z=196840;return"FrostShock aoe 1"end end end;local function b0()if aB(G.LightningBolt)and(E==0 or E>G.LightningBolt:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and g:BuffRemains(G.StormkeeperBuff)<1.1*g:GCD()*g:BuffStack(G.StormkeeperBuff)then if n(G.LightningBolt,nil)then Z=188196;return"LightningBolt st 1"end end;if aB(G.FrostShock)and i:IsInRange(40)and G.Icefury:IsAvailable()and aX()and g:BuffRemains(G.IcefuryBuff)<1.1*g:GCD()*g:BuffStack(G.IcefuryBuff)then if n(G.FrostShock,nil)then Z=196840;return"FrostShock st 1"end end;if aB(G.FlameShock)and i:IsInRange(40)and((i:DebuffDown(G.FlameShockDebuff)or i:DebuffRemains(G.FlameShockDebuff)<=g:GCD()or G.Ascendance:IsAvailable()and i:DebuffRemains(G.FlameShockDebuff)<G.Ascendance:CooldownRemains()+g:BuffRemains(G.AscendanceBuff)and G.Ascendance:CooldownRemains()<4)and(g:BuffUp(G.LavaSurgeBuff)or not g:BloodlustUp()))then if n(G.FlameShock,nil)then Z=188389;return"Flameshock st 2"end end;if aB(G.FlameShock)and g:IsMoving()then if a0.CastCycle(G.FlameShock,S,aP,not i:IsSpellInRange(G.FlameShock),nil)then return"FlameShock st 204"end end;if aB(G.FlameShock)and g:BuffUp(G.PrimordialWaveBuff)then if a0.CastTargetIf(G.FlameShock,S,"min",aI,aO)then return"FlameShock st 204"end;if aI(i)and aO(i)then if n(G.FlameShock,nil,nil,not i:IsSpellInRange(G.FlameShock))then Z=188389;return"FlameShock st 204"end end end;if aB(G.Ascendance)and i:IsInRange(40)and p()and G.Ascendance:IsAvailable()and(g:CombatTime()>=60 or g:BloodlustUp())and G.LavaBurst:CooldownRemains()>0 and(not G.Icefury:IsAvailable()or not aX()and not G.Icefury:CooldownUp())then if n(G.Ascendance,nil)then Z=114050;return"Ascendance st 1"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and g:BuffUp(G.LavaSurgeBuff)and(a7 or not aT()and G.MasterOfTheElements:IsAvailable())then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst st 1"end end;if aB(G.ElementalBlast)and(E==0 or E>G.ElementalBlast:ExecuteTime())and i:IsInRange(40)and G.ElementalBlast:IsAvailable()and aR()<70 then if n(G.ElementalBlast,nil,nil,not i:IsSpellInRange(G.ElementalBlast))then Z=117014;return"Elemental Blast st 1"end end;if aB(G.Stormkeeper)and(E==0 or E>G.Stormkeeper:ExecuteTime())and i:IsInRange(40)and G.Stormkeeper:IsAvailable()and aR()<44 and r then if n(G.Stormkeeper,nil)then Z=191634;return"st Stormkeeper 1"end end;if aB(G.EchoingShock)and i:IsInRange(40)and r and G.EchoingShock:IsAvailable()and G.LavaBurst:CooldownRemains()<=g:GCD()then if n(G.EchoingShock,nil)then Z=320125;return"Echoing Shock st 1"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and G.EchoingShock:IsAvailable()and g:BuffUp(G.EchoingShockBuff)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst st 2"end end;if aB(G.LiquidMagmaTotem)and i:IsInRange(40)and r and G.LiquidMagmaTotem:IsAvailable()then if n(G.LiquidMagmaTotem,nil)then Z=192222;return"LiquidMagmaTotem st 2"end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and g:BuffUp(G.EchoesofGreatSunderingBuff)and G.MasterOfTheElements:IsAvailable()and aT()then if n(G.Earthquake,nil)then Z=61882;return"EQ st 1"end end;if aB(G.LightningBolt)and(E==0 or E>G.LightningBolt:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and aV()and aT()and aR()<60 then if n(G.LightningBolt,nil)then Z=188196;return"LightningBolt st 1"end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and g:BuffUp(G.EchoesofGreatSunderingBuff)and(G.MasterOfTheElements:IsAvailable()or G.LavaBurst:CooldownRemains()>0 and aR()>=92 or V<2 and aV()and G.LavaBurst:CooldownRemains()<=g:GCD()or not G.MasterOfTheElements:IsAvailable()or G.ElementalBlast:CooldownRemains()<=1.1*g:GCD()*2)then if n(G.Earthquake,nil)then Z=61882;return"EQ st 2"end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and V>1 and not i:DebuffRefreshable(G.FlameShockDebuff)and not a6 and(not G.MasterOfTheElements:IsAvailable()or aT()or G.LavaBurst:CooldownRemains()>0 and aR()>=92)then if n(G.Earthquake,nil)then Z=61882;return"EQ st 3"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and not aT()and aX()then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst st 3"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and G.LavaBurst:Charges()>ab(G.EchoOfTheElements:IsAvailable())and not aX()then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst st 4"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and G.EchoOfTheElements:IsAvailable()and not aT()and aR()>=50 and g:BuffDown(G.EchoesofGreatSunderingBuff)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst st 5"end end;if aB(G.EarthShock)and i:IsInRange(40)and(a6 or V<2)and(G.MasterOfTheElements:IsAvailable()and g:BuffDown(G.EchoesofGreatSunderingBuff)and(aT()or aR()>=92 or V<2 and aV()and G.LavaBurst:CooldownRemains()<=g:GCD())or(not G.MasterOfTheElements:IsAvailable()or G.ElementalBlast:CooldownRemains()<=1.1*g:GCD()*2))then if n(G.EarthShock,nil)then Z=8042;return"EarthShock st 1"end end;if aB(G.FrostShock)and i:IsInRange(40)and G.Icefury:IsAvailable()and G.MasterOfTheElements:IsAvailable()and aX()and aT()then if n(G.FrostShock,nil)then Z=196840;return"FrostShock st 2"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and g:BuffUp(G.AscendanceBuff)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst st 6"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and not G.MasterOfTheElements:IsAvailable()then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst st 7"end end;if aB(G.Icefury)and G.Icefury:IsAvailable()and not(aR()>35 and G.LavaBurst:CooldownRemains()<=0)then if n(G.Icefury,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=210714;return"Icefury st 1"end end;if aB(G.FrostShock)and i:IsInRange(40)and G.Icefury:IsAvailable()and aX()and(g:BuffRemains(G.IcefuryBuff)<g:GCD()*4*g:BuffStack(G.IcefuryBuff)or aV()or not G.MasterOfTheElements:IsAvailable())then if n(G.FrostShock,nil)then Z=196840;return"FrostShock st 3"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst st 8"end end;if aB(G.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(G.FlameShockDebuff)then if n(G.FlameShock,nil)then Z=188389;return"Flameshock st 4"end end;if aB(G.FlameShock)then if a0.CastCycle(G.FlameShock,S,aO,not i:IsSpellInRange(G.FlameShock),nil)then return"FlameShock st 304"end end;if aB(G.FrostShock)and i:IsInRange(40)and a5 and g:BuffDown(G.ElementalEquilibriumBuff)and not G.ElementalBlast:IsAvailable()and not G.EchoingShock:IsAvailable()then if n(G.FrostShock,nil)then Z=196840;return"FrostShock st 5"end end;if aB(G.ChainHarvest)and(E==0 or E>G.ChainHarvest:ExecuteTime())and i:IsInRange(40)and q then if n(G.ChainHarvest,nil)then Z=320674;return"Chain Harvest st 1"end end;if aB(G.FrostShock)and i:IsInRange(40)and G.Icefury:IsAvailable()and aX()then if n(G.FrostShock,nil)then Z=196840;return"FrostShock st 6"end end;if aB(G.StaticDischarge)and G.StaticDischarge:IsAvailable()and r then if n(G.StaticDischarge,nil,nil)then Z=342243;return"st StaticDischarge"end end;if aB(G.EarthElemental)and p()and not w and(not G.PrimalElementalist:IsAvailable()or not an)then if n(G.EarthElemental,nil,nil)then Z=198103;return"st Earth Ele"end end;if aB(G.ChainLightning)and(E==0 or E>G.ChainLightning:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and V>1 then if n(G.ChainLightning,nil)then Z=188443;return"ChainLightning st 1"end end;if aB(G.LightningBolt)and(E==0 or E>G.LightningBolt:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)then if n(G.LightningBolt,nil)then Z=188196;return"LightningBolt st 2"end end;if aB(G.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(G.FlameShockDebuff)and g:IsMoving()then if n(G.FlameShock,nil)then Z=188389;return"Flameshock st 2"end end;if aB(G.FlameShock)and g:IsMoving()then if a0.CastCycle(G.FlameShock,S,aO,not i:IsSpellInRange(G.FlameShock),nil)then return"FlameShock st 204"end end;if aB(G.FrostShock)and i:IsInRange(40)and g:IsMoving()then if n(G.FrostShock,nil)then Z=196840;return"FrostShock st 7"end end;if aB(G.FrostShock)and i:IsInRange(40)and G.Icefury:IsAvailable()and aX()and g:BuffRemains(G.IcefuryBuff)<1.1*g:GCD()*g:BuffStack(G.IcefuryBuff)then if n(G.FrostShock,nil)then Z=196840;return"FrostShock st 7"end end end;local function b1()if aB(G.StormElemental)and i:IsInRange(40)and G.StormElemental:IsAvailable()and p()then if n(G.StormElemental,nil)then Z=192249;return"Storm Elemental sest 1"end end;if aB(G.LightningBolt)and(E==0 or E>G.LightningBolt:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and g:BuffUp(G.SurgeOfPower)then if n(G.LightningBolt,nil)then Z=188196;return"LightningBolt sest 1"end end;if aB(G.PrimordialWave)and q and G.PrimordialWave:IsAvailable()and g:BuffDown(G.PrimordialWaveBuff)and g:BuffDown(G.SplinteredElementsBuff)then if a0.CastTargetIf(G.PrimordialWave,S,"min",aI,aM)then return"Primo Wave 108"end;if aI(i)and aM(i)then if n(G.PrimordialWave,nil,nil,not i:IsSpellInRange(G.PrimordialWave))then Z=326059;return"PrimordialWave 108"end end end;if aB(G.FrostShock)and i:IsInRange(40)and G.Icefury:IsAvailable()and aX()and g:BuffRemains(G.IcefuryBuff)<1.1*g:GCD()*g:BuffStack(G.IcefuryBuff)and g:BuffStack(G.WindGustBuff)<18 then if n(G.FrostShock,nil)then Z=196840;return"FrostShock sest 1"end end;if aB(G.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(G.FlameShockDebuff)then if n(G.FlameShock,nil)then Z=188389;return"Flameshock sest 2"end end;if aB(G.FrostShock)and i:IsInRange(40)and G.Icefury:IsAvailable()and aX()and g:BuffRemains(G.IcefuryBuff)<1.1*g:GCD()*g:BuffStack(G.IcefuryBuff)then if n(G.FrostShock,nil)then Z=196840;return"FrostShock sest 2"end end;if aB(G.ElementalBlast)and(E==0 or E>G.ElementalBlast:ExecuteTime())and i:IsInRange(40)and G.ElementalBlast:IsAvailable()then if n(G.ElementalBlast,nil,nil,not i:IsSpellInRange(G.ElementalBlast))then Z=117014;return"Elemental Blast sest 1"end end;if aB(G.Stormkeeper)and(E==0 or E>G.Stormkeeper:ExecuteTime())and i:IsInRange(40)and G.Stormkeeper:IsAvailable()and r then if n(G.Stormkeeper,nil)then Z=191634;return"sest Stormkeeper 1"end end;if aB(G.EchoingShock)and i:IsInRange(40)and r and G.EchoingShock:IsAvailable()and(G.LavaBurst:CooldownRemains()<=g:GCD()and V<2 or aR()>=60 and V>=2 and(not a6 or g:BuffUp(G.EchoesofGreatSunderingBuff))or V<2 and g:BuffStack(G.WindGustBuff)>=18 and(not a6 or g:BuffUp(G.EchoesofGreatSunderingBuff))and aR()>=60)then if n(G.EchoingShock,nil)then Z=320125;return"Echoing Shock sest 2"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and(g:BuffStack(G.WindGustBuff)<18 and not g:BloodlustUp()or g:BuffUp(G.LavaSurgeBuff))then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst sest 6"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and G.EchoingShock:IsAvailable()and g:BuffUp(G.EchoingShockBuff)and V<2 then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst sest 6"end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and G.EchoingShock:IsAvailable()and g:BuffUp(G.EchoingShockBuff)and V>=2 then if n(G.Earthquake,nil)then Z=61882;return"EQ sest 1"end end;if aB(G.LightningBolt)and(E==0 or E>G.LightningBolt:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and aV()then if n(G.LightningBolt,nil)then Z=188196;return"LightningBolt sest 1"end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and g:BuffUp(G.EchoesofGreatSunderingBuff)then if n(G.Earthquake,nil)then Z=61882;return"EQ sest 2"end end;if aB(G.EarthShock)and i:IsInRange(40)and(V<2 and aR()>=60 and(g:BuffStack(G.WindGustBuff)<20 or aR()>90)or a6 and not g:BuffUp(G.EchoesofGreatSunderingBuff)or a7)then if n(G.EarthShock,nil)then Z=8042;return"EarthShock sest 2"end end;if aB(G.Earthquake)and(E==0 or E>G.Earthquake:ExecuteTime())and i:IsInRange(40)and V>1 and not i:DebuffRefreshable(G.FlameShockDebuff)then if n(G.Earthquake,nil)then Z=61882;return"EQ sest 3"end end;if aB(G.ChainLightning)and(E==0 or E>G.ChainLightning:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and V>1 and am and g:BloodlustUp()then if n(G.ChainLightning,nil)then Z=188443;return"ChainLightning sest 1"end end;if aB(G.LightningBolt)and(E==0 or E>G.LightningBolt:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and am and g:BloodlustUp()then if n(G.LightningBolt,nil)then Z=188196;return"LightningBolt sest 1"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and g:BuffUp(G.AscendanceBuff)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst sest 6"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst sest 7"end end;if aB(G.LavaBurst)and(E==0 or E>G.LavaBurst:ExecuteTime()or g:BuffUp(G.LavaSurgeBuff))and i:IsInRange(40)and G.LavaBurst:SpellCharges()>ab(G.EchoOfTheElements:IsAvailable())then if n(G.LavaBurst,nil,nil,not i:IsSpellInRange(G.LavaBurst))then Z=51505;return"Lavaburst sest 8"end end;if aB(G.FrostShock)and i:IsInRange(40)and G.Icefury:IsAvailable()and aX()then if n(G.FrostShock,nil)then Z=196840;return"FrostShock SEST 1"end end;if aB(G.ChainHarvest)and(E==0 or E>G.ChainHarvest:ExecuteTime())and i:IsInRange(40)and q then if n(G.ChainHarvest,nil)then Z=320674;return"Chain Harvest SEST 1"end end;if aB(G.StaticDischarge)and G.StaticDischarge:IsAvailable()and r then if n(G.StaticDischarge,nil,nil)then Z=342243;return"SEST StaticDischarge"end end;if aB(G.EarthElemental)and p()and not w and i:IsSpellInRange(G.LightningBolt)and(not G.PrimalElementalist:IsAvailable()or G.PrimalElementalist:IsAvailable()and not am)then if n(G.EarthElemental,nil,nil)then Z=198103;return"sest Earth Ele"end end;if aB(G.ChainLightning)and(E==0 or E>G.ChainLightning:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)and V>1 then if n(G.ChainLightning,nil)then Z=188443;return"ChainLightning sest 2"end end;if aB(G.LightningBolt)and(E==0 or E>G.LightningBolt:ExecuteTime()or g:BuffUp(G.StormkeeperBuff))and i:IsInRange(40)then if n(G.LightningBolt,nil)then Z=188196;return"LightningBolt sest 2"end end;if aB(G.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(G.FlameShockDebuff)and g:IsMoving()then if n(G.FlameShock,nil)then Z=188389;return"Flameshock sest 2"end end;if aB(G.FlameShock)and g:IsMoving()then if a0.CastCycle(G.FlameShock,S,aO,not i:IsSpellInRange(G.FlameShock),nil)then return"FlameShock sest 204"end end;if aB(G.FrostShock)and i:IsInRange(40)and g:IsMoving()then if n(G.FrostShock,nil)then Z=196840;return"FrostShock aoe 1"end end end;local function b2()s=HeroRotationCharDB.Toggles[6]q=HeroRotationCharDB.Toggles[4]r=HeroRotationCharDB.Toggles[5]u=HeroRotationCharDB.Toggles[12]t=HeroRotationCharDB.Toggles[15]v=HeroRotationCharDB.Toggles[60]p=m.CDsON;w=HeroRotationCharDB.Toggles[90]x=HeroRotationCharDB.Toggles[91]y=HeroRotationCharDB.Toggles[92]z=HeroRotationCharDB.Toggles[93]A=HeroRotationCharDB.Toggles[94]B=HeroRotationCharDB.Toggles[96]C=HeroRotationCharDB.Toggles[95]D=HeroRotationCharDB.Toggles[97]E=0;for b3=1,20 do if select(10,UnitDebuff("player",b3))==240447 then if select(6,UnitDebuff("player",b3))~=nil then E=select(6,UnitDebuff("player",b3))-GetTime()end end end end;local function b4()Q=g:GetEnemiesInMeleeRange(8)R=g:GetEnemiesInRange(30)S=g:GetEnemiesInRange(40)T=i:GetEnemiesInSplashRange(15)M,N=GetInventoryItemID("player",13)O,N=GetInventoryItemID("player",14)if o()and a2.Commons.AoeMode=="Conservative"then U=i:GetEnemiesInSplashRangeCount(8)V=i:GetEnemiesInSplashRangeCount(15)elseif o()and a2.Commons.AoeMode=="Aggresive"then local b5=0;for b6=1,20 do local b7="nameplate"..b6;if UnitExists(b7)then if UnitCanAttack("player",b7)then if UnitCanAttack("player",b7)and UnitAffectingCombat("target")and IsItemInRange(32698,b7)and UnitDetailedThreatSituation("player",b7)~=nil or f(b7):IsDummy()or string.find(UnitGUID(b7),153285)or string.find(UnitGUID(b7),31146)or string.find(UnitGUID(b7),176581)or string.find(UnitGUID(b7),179124)or string.find(UnitGUID(b7),179010)or string.find(UnitGUID(b7),180323)or string.find(UnitGUID(b7),179010)or string.find(UnitGUID(b7),179942)or string.find(UnitGUID(b7),176521)or string.find(UnitGUID(b7),177594)or string.find(UnitGUID(b7),177117)or string.find(UnitGUID(b7),176581)or string.find(UnitGUID(b7),180840)or string.find(UnitGUID(b7),176605)or UnitName(b7)=="Glacial Spike"or string.find(UnitGUID(b7),180473)or string.find(UnitGUID(b7),180474)or string.find(UnitGUID(b7),176929)or string.find(UnitGUID(b7),176920)or string.find(UnitGUID(b7),177154)or string.find(UnitGUID(b7),177787)or string.find(UnitGUID(b7),177889)or string.find(UnitGUID(b7),177891)or string.find(UnitGUID(b7),177892)or string.find(UnitGUID(b7),168326)then b5=b5+1 end end end end;U=b5;V=b5 end;if not o()then U=1;V=1 end;if v then V=10;U=10 end;ao()ay()if not BotOn then Y=0;Z=0 end;if Y>0 then Y=0 end;if Z>0 then Z=0 end;P=b2()if m.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+m.GUISettings.General.OpenerReset elseif m.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]m.ToggleIconFrame:UpdateButtonText(6)m.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if a2.Elemental.PreferEarthShield and G.EarthShield:IsCastable()and(g:BuffDown(G.EarthShield)or not g:AffectingCombat()and g:BuffStack(G.EarthShield)<5)then if n(G.EarthShield,nil)then Z=974;return"Earth Shield Refresh"end elseif G.LightningShield:IsCastable()and g:BuffDown(G.LightningShield)and(a2.Elemental.PreferEarthShield and g:BuffDown(G.EarthShield)or not a2.Elemental.PreferEarthShield)then if n(G.LightningShield,nil)then Z=192106;return"Lightning Shield Refresh"end end;if g:IsChanneling()or g:IsChanneling(G.FaeTransfusion)then if n(G.Pool,nil)then Z=99999;return"Trinket Channel"end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if G.FrostShock:IsCastable()then if n(G.FrostShock,nil)then Y=1196840;return"explosive MO FS"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if G.FrostShock:IsCastable()then if n(G.FrostShock,nil)then Z=196840;return"explosive  FS"end end end;if x and G.CapacitorTotem:IsUsableP()and G.CapacitorTotem:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.CapacitorTotem,nil,nil,nil)then Z=1192058;return"queue CapacitorTotem"end elseif(not G.CapacitorTotem:IsUsableP()or G.CapacitorTotem:CooldownRemains(BypassRecovery)>0)and x then HeroRotationCharDB.Toggles[91]=not HeroRotationCharDB.Toggles[91]m.Print("Capacitor Totem Queue is now "..(HeroRotationCharDB.Toggles[91]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if y and G.HealingStreamTotem:IsUsableP()and G.HealingStreamTotem:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.HealingStreamTotem,nil,nil,nil)then Z=5394;return"queue HealingStreamTotem"end elseif(not G.HealingStreamTotem:IsUsableP()or G.HealingStreamTotem:CooldownRemains(BypassRecovery)>0)and y then HeroRotationCharDB.Toggles[92]=not HeroRotationCharDB.Toggles[92]m.Print("Healing Stream Totem Queue is now "..(HeroRotationCharDB.Toggles[92]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if z and G.TremorTotem:IsUsableP()and G.TremorTotem:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.TremorTotem,nil,nil,nil)then Z=8143;return"queue TremorTotem"end elseif(not G.TremorTotem:IsUsableP()or G.TremorTotem:CooldownRemains(BypassRecovery)>0)and z then HeroRotationCharDB.Toggles[93]=not HeroRotationCharDB.Toggles[93]m.Print("Tremor Totem Queue is now "..(HeroRotationCharDB.Toggles[93]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if A and G.WindRushTotem:IsUsableP()and G.WindRushTotem:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.WindRushTotem,nil,nil,nil)then Z=192077;return"queue WindRushTotem"end elseif(not G.WindRushTotem:IsUsableP()or G.WindRushTotem:CooldownRemains(BypassRecovery)>0)and A then HeroRotationCharDB.Toggles[94]=not HeroRotationCharDB.Toggles[94]m.Print("Wind Rush Totem Queue is now "..(HeroRotationCharDB.Toggles[94]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if B and G.FaeTransfusion:IsUsableP()and G.FaeTransfusion:CooldownRemains(BypassRecovery)<=0 and G.FaeTransfusion:IsAvailable()then if n(G.FaeTransfusion,nil)then Z=328923;return"FaeTransfusion 1"end elseif(not G.FaeTransfusion:IsUsableP()or G.FaeTransfusion:CooldownRemains(BypassRecovery)>0 or not G.FaeTransfusion:IsAvailable())and B then HeroRotationCharDB.Toggles[96]=not HeroRotationCharDB.Toggles[96]m.Print("Fae Transfusion Queue is now"..(HeroRotationCharDB.Toggles[96]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if C and G.Hex:IsUsableP()and G.Hex:CooldownRemains(BypassRecovery)<=0 and UnitExists("mouseover")then if m.Cast(G.Hex,nil,nil,nil)then if UnitExists("mouseover")and f("mouseover"):IsInRange(40)then Y=151514;return"queue Hex MO"end end elseif(not G.Hex:IsUsableP()or G.Hex:CooldownRemains()>0)and C then HeroRotationCharDB.Toggles[95]=not HeroRotationCharDB.Toggles[95]m.Print("Hex Queue is now "..(HeroRotationCharDB.Toggles[95]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if not g:AffectingCombat()and a0.TargetIsValid()and s then local P=aZ()if P then return P end end;for b3=1,25 do local b8,N,N,b9=UnitBuff("target",b3)if b9~=nil and b9=="Magic"then if G.Purge:IsCastable()and D and i:IsInRange(30)then if n(G.Purge,nil)then Z=370;return"Purge"end end end end;for b3=0,40 do local N,N,ba,b9,N,N,N,N,N,bb=UnitDebuff("mouseover",b3)if G.CleanseSpirit:IsCastable()and UnitIsDead("mouseover")~=true and UnitCanAttack("player","mouseover")~=true and IsItemInRange(34471,"mouseover")and b9=="Curse"then if n(G.CleanseSpirit,nil)then Y=151886;return"Cleanse Spirit MO"end end end;if a0.TargetIsValid()and g:AffectingCombat()and(i:AffectingCombat()or i:IsDummy()or i:NPCID()==153285 or i:NPCID()==168326 or i:NPCID()==176581 or i:NPCID()==176920 or i:NPCID()==177892 or i:NPCID()==182778 or i:NPCID()==185402 or i:NPCID()==183945 or i:NPCID()==182074 or i:NPCID()==184737 or UnitExists("boss1"))and not g:IsDeadOrGhost()then if am and G.EyeOfTheStorm:CooldownRemains()<=0 and h:BuffUp(G.CallLightningBuff)then if n(G.EyeOfTheStorm,nil)then Z=157375;return"EyeOfTheStorm  Pet"end end;if an and G.Meteor:CooldownRemains()<=0 then if n(G.Meteor,nil)then Z=117588;return"Meteor  Pet"end end;local bc=0;local bd=0;if GetNumGroupMembers()>0 then if UnitInParty("player")then for b3=1,GetNumGroupMembers()do if UnitExists("party"..b3)then bd=bd+UnitHealth("party"..b3)bc=bc+UnitHealthMax("party"..b3)end end end;if UnitInRaid("player")then for b3=1,GetNumGroupMembers()do if UnitExists("raid"..b3)then bd=bd+UnitHealth("raid"..b3)bc=bc+UnitHealthMax("raid"..b3)end end end elseif GetNumGroupMembers()==0 then bd=UnitHealth("player")bc=UnitHealthMax("player")end;if g:HealthPercentage()<a2.Elemental.HealthstoneHP and H.Healthstone:IsReady()and H.Healthstone:CooldownRemains()<=0 then if n(H.Healthstone,nil)then Z=40;return"Healthstone HP"end end;if g:HealthPercentage()<a2.Elemental.HealPotHP and H.HealPot:IsReady()and H.HealPot:CooldownRemains()<=0 then if n(H.HealPot,nil)then Z=41;return"HealPot HP"end end;if g:HealthPercentage()<a2.Elemental.PhialHP and H.PhialofSerenity:IsReady()and H.PhialofSerenity:CooldownRemains()<=0 then if n(H.HealPot,nil)then Z=55;return"PhialofSerenity HP"end end;if bd/bc*100<=a2.Elemental.FaeTransfusionHealHP and g:BuffUp(j(328933))then if n(G.FaeTransfusion,nil)then Z=328923;return"FaeTransfusion Heal"end end;if g:HealthPercentage()<a2.Elemental.AncestralGuideanceHP and G.AncestralGuidance:IsAvailable()and G.AncestralGuidance:IsReady()then if n(G.AncestralGuidance)then Z=108281;return"AncestralGuidance HP"end end;if H.PotionofSpectralIntellect:IsReady()and a2.Commons.Enabled.Potions then if n(H.PotionofSpectralIntellect,nil,nil)then Z=50;return"potion main 16"end end;if(a2.Commons.Enabled.TopTrinket or a2.Commons.Enabled.BottomTrinket)and p()then local be=g:GetUseableTrinkets(I)if be then if n(be,nil,nil)then if be:ID()==M and a2.Commons.Enabled.TopTrinket then Z=24;return"top trinket 1"elseif be:ID()==O and a2.Commons.Enabled.BottomTrinket then Z=30;return"Bot trinket 2"end end end end;if aB(G.FlameShock)and i:IsInRange(30)and not G.ElementalBlast:IsAvailable()and i:DebuffDown(G.FlameShockDebuff)and not am and(V<3 or G.MasterOfTheElements:IsAvailable()or a4)then if n(G.FlameShock,nil)then Z=188389;return"Flameshock 1"end end;if aB(G.PrimordialWave)and q then if a0.CastTargetIf(G.PrimordialWave,S,"min",aI,aL)then return"Primo Wave 108"end;if aI(i)and aL(i)then if n(G.PrimordialWave,nil,nil,not i:IsSpellInRange(G.PrimordialWave))then Z=326059;return"PrimordialWave 108"end end end;if aB(G.FlameShock)then if a0.CastTargetIf(G.FlameShock,S,"min",aI,aN)then return"Flame Shock 108"end;if aI(i)and aN(i)then if n(G.FlameShock,nil,nil,not i:IsSpellInRange(G.FlameShock))then Z=188389;return"FlameShock 108"end end end;if aB(G.FireElemental)and p()and not G.StormElemental:IsAvailable()then if n(G.FireElemental,nil)then Z=198067;return"Fire Elemental 1"end end;if p()then if G.BloodFury:IsCastable()and p()and i:IsInRange(8)and(not G.Ascendance:IsAvailable()or g:BuffUp(G.Ascendance)or G.Ascendance:CooldownRemains()>50)then if m.Cast(G.BloodFury,nil)then Z=20572;return"Blood Fury 420"end end;if G.Berserking:IsCastable()and p()and i:IsInRange(8)and(not G.Ascendance:IsAvailable()or g:BuffUp(G.Ascendance))then if m.Cast(G.Berserking,nil)then Z=26297;return"Berserking 422"end end;if G.Fireblood:IsCastable()and p()and i:IsInRange(8)and(not G.Ascendance:IsAvailable()or g:BuffUp(G.Ascendance)or G.Ascendance:CooldownRemains()>50)then if m.Cast(G.Fireblood,nil)then Z=265221;return"Fireblood 426"end end;if G.AncestralCall:IsCastable()and p()and i:IsInRange(8)and(not G.Ascendance:IsAvailable()or g:BuffUp(G.Ascendance)or G.Ascendance:CooldownRemains()>50)then if m.Cast(G.AncestralCall,nil)then Z=274738;return"Ancestral Call 428"end end;if G.BagofTricks:IsCastable()and p()and i:IsInRange(8)and(not G.Ascendance:IsAvailable()or g:BuffUp(G.Ascendance))then if m.Cast(G.BagofTricks,nil,nil,not i:IsInRange(40))then Z=312411;return"Bag of Tricks 430"end end end;if aB(G.VesperTotem)and q and i:IsInRange(40)and G.VesperTotem:IsAvailable()then if n(G.VesperTotem,nil)then Z=324386;return"VesperTotem 1"end end;if aB(G.FaeTransfusion)and q and G.FaeTransfusion:IsAvailable()and not a9 and(not G.MasterOfTheElements:IsAvailable()or aT())and V<3 then if n(G.FaeTransfusion,nil)then Z=328923;return"FaeTransfusion 1"end end;if aB(G.FaeTransfusion)and q and G.FaeTransfusion:IsAvailable()and a9 and(not G.MasterOfTheElements:IsAvailable()or aT()or V>=3)and(G.FireElemental:CooldownRemains()>20 and not G.StormElemental:IsAvailable()or G.StormElemental:CooldownRemains()>20 and G.StormElemental:IsAvailable())then if n(G.FaeTransfusion,nil)then Z=328923;return"FaeTransfusion 1"end end;if V>2 then local P=a_()if P then return P end end;if not G.StormElemental:IsAvailable()and V<=2 then local P=b0()if P then return P end end;if G.StormElemental:IsAvailable()and V<=2 then local P=b1()if P then return P end end;m.CastAnnotated(G.Pool,false,"ERR")end end;local function bf()end;function ReturnSpell1()if Z==0 then return 0 else return Z end end;function ReturnSpellMO1()if Y==0 then return 0 else return Y end end;m.SetAPL(262,b4,bf)