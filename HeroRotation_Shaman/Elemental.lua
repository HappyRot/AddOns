local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Pet;local i=f.Target;local j=d.Spell;local k=d.MultiSpell;local l=d.Item;local m=HeroRotation;local n=m.Cast;local o=m.AoEON;local p=m.CDsON;local q=HeroRotationCharDB.Toggles[4]local r=HeroRotationCharDB.Toggles[5]local s=HeroRotationCharDB.Toggles[6]local t=not HeroRotationCharDB.Toggles[15]local u=HeroRotationCharDB.Toggles[12]local v=HeroRotationCharDB.Toggles[60]local UnitPower=UnitPower;local w=Enum.PowerType.Maelstrom;local x=j.Shaman.Elemental;local y=l.Shaman.Elemental;local z={}local A=g:GetEquipment()local B=l(0)local C=l(0)local D,E=GetInventoryItemID("player",13)local F,E=GetInventoryItemID("player",14)local G;local H,I,J,K;local L,M;local N;local O;local P=0;local Q=0;local R=0;local S=m.Commons.Everyone;local T=m.Commons.Shaman;local U={General=m.GUISettings.General,Commons=m.GUISettings.APL.Shaman.Commons,Elemental=m.GUISettings.APL.Shaman.Elemental}local V=g:HasLegendaryEquipped(131)local W=g:HasLegendaryEquipped(134)local X=g:HasLegendaryEquipped(135)local Y=g:HasLegendaryEquipped(136)local Z=g:HasLegendaryEquipped(137)local _=x.CallOfFlame:ConduitEnabled()local a0=g:HasLegendaryEquipped(246)d:RegisterForEvent(function()V=g:HasLegendaryEquipped(131)W=g:HasLegendaryEquipped(134)X=g:HasLegendaryEquipped(135)Y=g:HasLegendaryEquipped(136)Z=g:HasLegendaryEquipped(137)_=x.CallOfFlame:ConduitEnabled()end,"PLAYER_EQUIPMENT_CHANGED")d:RegisterForEvent(function()x.PrimordialWave:RegisterInFlightEffect(327162)x.PrimordialWave:RegisterInFlight()x.LavaBurst:RegisterInFlight()end,"LEARNED_SPELL_IN_TAB")x.PrimordialWave:RegisterInFlightEffect(327162)x.PrimordialWave:RegisterInFlight()x.LavaBurst:RegisterInFlight()local function a1(a2)if a2 then return 1 else return 0 end end;local function a3(a2)return a2~=0 end;local a4;local a5;local a6;local a7;local a8;local a9;local aa;local ab;local ac;local ad;local function ae()a4=0;a5=0;a6=0;a7=0;a8=0;ab={}a9=nil;aa=nil;local af=999;local ag=0;if o()then for E,ah in pairs(g:GetEnemiesInRange(40))do if ah:AffectingCombat()or ah:IsDummy()or ah:NPCID()==153285 then a4=a4+1;local ai=ah:DebuffRemains(x.FlameShockDebuff)if ai>0 then a6=a6+1 end;if ai<5 then a7=a7+1 end;if ai<af then af=ai;aa=ah end;if ai==0 and ah:Health()>ag then ag=ah:Health()aa=ah end;local aj=ah:GetEnemiesInSplashRange(10)local ak={}for E,al in pairs(aj)do local am=false;for E,an in pairs(ak)do if al:GUID()==an:GUID()then am=true;break end end;if not am then table.insert(ak,al)end end;ab[ah]=ak;if#ak>a5 then a5=#ak;a9=ah end;if not ah:TimeToDieIsNotValid()and not ah:IsUserCycleBlacklisted()then a8=math.max(a8,ah:TimeToDie())end end end else a4=1;local ai=i:DebuffRemains(x.FlameShockDebuff)if ai>0 then a6=1 end;if ai<5 then a7=1 end;aa=i;a5=1;a9=i;if not i:TimeToDieIsNotValid()and not i:IsUserCycleBlacklisted()then a8=i:TimeToDie()end end end;local function ao()ac=false;ad=false;local ap=h:IsActive()local aq=h:NPCID()if ap then if aq==77942 then ac=true elseif aq==61029 then ad=true end end end;local function ar(as)if as==nil then return nil end;local at=as:IsCastable()and as:IsReady()if as==x.Stormkeeper or as==x.ElementalBlast or as==x.Icefury then local au=not g:IsMoving()or g:BuffUp(x.SpiritwalkersGraceBuff)return at and au and not g:IsCasting(as)elseif as==x.LightningBolt or as==x.ChainLightning then local au=not g:IsMoving()or g:BuffUp(x.StormkeeperBuff)or g:BuffUp(x.SpiritwalkersGraceBuff)return at and au elseif as==x.LavaBurst then local au=not g:IsMoving()or g:BuffUp(x.LavaSurgeBuff)or g:BuffUp(x.SpiritwalkersGraceBuff)local av=g:BuffUp(x.LavaSurgeBuff)local aw=not g:IsCasting(x.LavaBurst)and x.LavaBurst:Charges()>=1;local ax=g:IsCasting(x.LavaBurst)and x.LavaBurst:Charges()==2;return at and au and(av or aw or ax)elseif as==x.PrimordialWave then return at and not g:BuffUp(x.PrimordialWaveBuff)and not g:BuffUp(x.LavaSurgeBuff)else return at end end;local function ay(az)return az:DebuffRemains(x.FlameShockDebuff)end;local function aA(az)return az:DebuffDown(x.FlameShockDebuff)end;local function aB(az)if g:BuffDown(x.PrimordialWaveBuff)and(not ac or M<3 and g:BuffStack(x.WindGustBuff)<20 or x.LeadByExample:SoulbindEnabled())and(M<5 or x.MasterOfTheElements:IsAvailable()or W or x.LeadByExample:SoulbindEnabled())and az:GUID()==f("mouseover"):GUID()and U.Elemental.TargetSwap=="Mouseover"then P=1326059;return true elseif g:BuffDown(x.PrimordialWaveBuff)and(not ac or M<3 and g:BuffStack(x.WindGustBuff)<20 or x.LeadByExample:SoulbindEnabled())and(M<5 or x.MasterOfTheElements:IsAvailable()or W or x.LeadByExample:SoulbindEnabled())and U.Elemental.TargetSwap=="AutoSwap"and az:GUID()~=i:GUID()and not u then P=999;return true elseif g:BuffDown(x.PrimordialWaveBuff)and(not ac or M<3 and g:BuffStack(x.WindGustBuff)<20 or x.LeadByExample:SoulbindEnabled())and(M<5 or x.MasterOfTheElements:IsAvailable()or W or x.LeadByExample:SoulbindEnabled())and az:GUID()==i:GUID()then Q=326059;return true elseif g:BuffDown(x.PrimordialWaveBuff)and(not ac or M<3 and g:BuffStack(x.WindGustBuff)<20 or x.LeadByExample:SoulbindEnabled())and(M<5 or x.MasterOfTheElements:IsAvailable()or W or x.LeadByExample:SoulbindEnabled())then return true end end;local function aC(az)if az:DebuffDown(x.FlameShockDebuff)and(not ac or M<3 and g:BuffStack(x.WindGustBuff)<20)and(M<3 or x.MasterOfTheElements:IsAvailable()or W)and az:GUID()==f("mouseover"):GUID()and U.Elemental.TargetSwap=="Mouseover"then P=1188389;return true elseif az:DebuffDown(x.FlameShockDebuff)and(not ac or M<3 and g:BuffStack(x.WindGustBuff)<20)and(M<3 or x.MasterOfTheElements:IsAvailable()or W)and U.Elemental.TargetSwap=="AutoSwap"and az:GUID()~=i:GUID()and not u then P=999;return true elseif az:DebuffDown(x.FlameShockDebuff)and(not ac or M<3 and g:BuffStack(x.WindGustBuff)<20)and(M<3 or x.MasterOfTheElements:IsAvailable()or W)and az:GUID()==i:GUID()then Q=188389;return true elseif az:DebuffDown(x.FlameShockDebuff)and(not ac or M<3 and g:BuffStack(x.WindGustBuff)<20)and(M<3 or x.MasterOfTheElements:IsAvailable()or W)then return true end end;local function aD(az)if(az:DebuffRefreshable(x.FlameShockDebuff)or az:DebuffDown(x.FlameShockDebuff))and az:GUID()==f("mouseover"):GUID()and U.Elemental.TargetSwap=="Mouseover"then P=1188389;return true elseif(az:DebuffRefreshable(x.FlameShockDebuff)or az:DebuffDown(x.FlameShockDebuff))and U.Elemental.TargetSwap=="AutoSwap"and az:GUID()~=i:GUID()and not u then P=999;return true elseif(az:DebuffRefreshable(x.FlameShockDebuff)or az:DebuffDown(x.FlameShockDebuff))and az:GUID()==i:GUID()then Q=188389;return true elseif az:DebuffRefreshable(x.FlameShockDebuff)or az:DebuffDown(x.FlameShockDebuff)then return true end end;local function aE(az)if(az:DebuffDown(x.FlameShockDebuff)or az:DebuffRemains(x.FlameShockDebuff)<=g:GCD()or x.Ascendance:IsAvailable()and az:DebuffRemains(x.FlameShockDebuff)<x.Ascendance:CooldownRemains()+g:BuffRemains(x.AscendanceBuff)and x.Ascendance:CooldownRemains()<4)and(g:BuffUp(x.LavaSurgeBuff)or not g:BloodlustUp())and az:GUID()==f("mouseover"):GUID()and U.Elemental.TargetSwap=="Mouseover"then P=1188389;return true elseif(az:DebuffDown(x.FlameShockDebuff)or az:DebuffRemains(x.FlameShockDebuff)<=g:GCD()or x.Ascendance:IsAvailable()and az:DebuffRemains(x.FlameShockDebuff)<x.Ascendance:CooldownRemains()+g:BuffRemains(x.AscendanceBuff)and x.Ascendance:CooldownRemains()<4)and(g:BuffUp(x.LavaSurgeBuff)or not g:BloodlustUp())and U.Elemental.TargetSwap=="AutoSwap"and az:GUID()~=i:GUID()and not u then P=999;return true elseif(az:DebuffDown(x.FlameShockDebuff)or az:DebuffRemains(x.FlameShockDebuff)<=g:GCD()or x.Ascendance:IsAvailable()and az:DebuffRemains(x.FlameShockDebuff)<x.Ascendance:CooldownRemains()+g:BuffRemains(x.AscendanceBuff)and x.Ascendance:CooldownRemains()<4)and(g:BuffUp(x.LavaSurgeBuff)or not g:BloodlustUp())and az:GUID()==i:GUID()then Q=188389;return true elseif(az:DebuffDown(x.FlameShockDebuff)or az:DebuffRemains(x.FlameShockDebuff)<=g:GCD()or x.Ascendance:IsAvailable()and az:DebuffRemains(x.FlameShockDebuff)<x.Ascendance:CooldownRemains()+g:BuffRemains(x.AscendanceBuff)and x.Ascendance:CooldownRemains()<4)and(g:BuffUp(x.LavaSurgeBuff)or not g:BloodlustUp())then return true end end;local function aF(az)if az:DebuffRemains(x.FlameShock)>x.LavaBurst:CastTime()and az:GUID()==f("mouseover"):GUID()and U.Elemental.TargetSwap=="Mouseover"then P=151505;return true elseif az:DebuffRemains(x.FlameShock)>x.LavaBurst:CastTime()and U.Elemental.TargetSwap=="AutoSwap"and az:GUID()~=i:GUID()and not u then P=999;return true elseif az:DebuffRemains(x.FlameShock)>x.LavaBurst:CastTime()and az:GUID()==i:GUID()then Q=51505;return true elseif az:DebuffRemains(x.FlameShock)>x.LavaBurst:CastTime()then return true end end;local function aG()local aH=UnitPower("player",w)if not g:IsCasting()then return aH else if g:IsCasting(x.ElementalBlast)then return aH+30 elseif g:IsCasting(x.Icefury)then return aH+25 elseif g:IsCasting(x.LightningBolt)then return aH+8 elseif g:IsCasting(x.LavaBurst)then return aH+10*(1+a1(g:BuffUp(x.PrimordialWaveBuff))*a6)elseif g:IsCasting(x.ChainLightning)then return aH+4*a4 else return aH end end end;local function aI()if not x.MasterOfTheElements:IsAvailable()then return false end;local aJ=g:BuffUp(x.MasterOfTheElementsBuff)if not g:IsCasting()then return aJ else if g:IsCasting(x.LavaBurst)then return true elseif g:IsCasting(x.ElementalBlast)then return false elseif g:IsCasting(x.Icefury)then return false elseif g:IsCasting(x.LightningBolt)then return false elseif g:IsCasting(x.ChainLightning)then return false else return aJ end end end;local function aK()if not x.Stormkeeper:IsAvailable()then return false end;local aL=g:BuffUp(x.StormkeeperBuff)if not g:IsCasting()then return aL else if g:IsCasting(x.Stormkeeper)then return true else return aL end end end;local function aM()if not x.Icefury:IsAvailable()then return false end;local aN=g:BuffUp(x.IcefuryBuff)if not g:IsCasting()then return aN else if g:IsCasting(x.Icefury)then return true else return aN end end end;local function aO()if ar(x.EarthElemental)and i:IsSpellInRange(x.LightningBolt)and not x.PrimalElementalist:IsAvailable()then if n(x.EarthElemental,nil,nil)then Q=198103;return"Precombat Earth Ele"end end;if ar(x.Stormkeeper)and i:IsSpellInRange(x.LightningBolt)and x.Stormkeeper:IsAvailable()then if n(x.Stormkeeper,nil)then Q=191634;return"Precombat Stormkeeper"end end;if ar(x.FireElemental)and i:IsSpellInRange(x.ElementalBlast)and not x.StormElemental:IsAvailable()then if n(x.FireElemental,nil,nil)then Q=198067;return"Precombat FireElemental"end end;if ar(x.ElementalBlast)and i:IsSpellInRange(x.LightningBolt)and x.ElementalBlast:IsAvailable()and M<3 then if n(x.ElementalBlast,nil,nil,not i:IsSpellInRange(x.ElementalBlast))then Q=117014;return"Precombat Elemental Blast"end end;if ar(x.LavaBurst)and i:IsInRange(40)and not g:IsCasting(x.LavaBurst)and(not x.ElementalBlast:IsAvailable()and L<3 or aK())then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Precombat Lavaburst"end end;if ar(x.ChainLightning)and i:IsInRange(40)and not x.ElementalBlast:IsAvailable()and L>=3 and not aK()then if n(x.ChainLightning,nil)then Q=188443;return"Precombat ChaimLightning"end end;if ar(x.Fleshcraft)and x.PustuleEruption:SoulbindEnabled()or x.VolatileSolvent:SoulbindEnabled()then if n(x.Fleshcraft,nil,nil)then Q=324631;return"Precombat Fleshcraft"end end end;local function aP()if ar(x.StormElemental)and i:IsInRange(40)and x.StormElemental:IsAvailable()and p()then if n(x.StormElemental,nil)then Q=192249;return"Storm Elemental 1"end end;if ar(x.Earthquake)and i:IsInRange(40)and g:BuffUp(x.EchoingShockBuff)then if n(x.Earthquake,nil)then Q=61882;return"EQ 1"end end;if ar(x.ChainHarvest)and i:IsInRange(40)and q then if n(x.ChainHarvest,nil)then Q=320674;return"Chain Harvest 1"end end;if ar(x.Stormkeeper)and i:IsInRange(40)and x.Stormkeeper:IsAvailable()then if n(x.Stormkeeper,nil)then Q=191634;return"AoE Stormkeeper 1"end end;if ar(x.FlameShock)and i:IsInRange(40)and(a6<2 and M<=3 and x.PrimordialWave:CooldownRemains()<16 and x.PrimordialWave:IsAvailable()and not ac or a6<1 and M>=4 and not ac and x.MasterOfTheElements:IsAvailable()or W and not ac)and i:DebuffRefreshable(x.FlameShockDebuff)then if n(x.FlameShock,nil)then Q=188389;return"Flameshock aoe 1"end end;if ar(x.FlameShock)and i:IsInRange(40)and(a6<2 and M<=3 and x.PrimordialWave:CooldownRemains()<16 and x.PrimordialWave:IsAvailable()and not ac or a6<1 and M>=4 and not ac and x.MasterOfTheElements:IsAvailable()or W and not ac)then if S.CastCycle(x.FlameShock,J,aD,not i:IsSpellInRange(x.FlameShock),nil)then return"FlameShock aoe 104"end end;if ar(x.FlameShock)and i:IsInRange(40)and i:DebuffDown(x.FlameShockDebuff)and not ac and(x.MasterOfTheElements:IsAvailable()or W)then if n(x.FlameShock,nil)then Q=188389;return"Flameshock aoe 2"end end;if ar(x.EchoingShock)and i:IsInRange(40)and r and x.EchoingShock:IsAvailable()and aG()>=60 and(Y and g:BuffUp(x.EchoesofGreatSunderingBuff)or not Y)then if n(x.EchoingShock,nil)then Q=320125;return"Echoing Shock aoe 2"end end;if ar(x.Ascendance)and i:IsInRange(40)and p()and x.Ascendance:IsAvailable()and not ac and(not x.Icefury:IsAvailable()or not aM()and not x.Icefury:CooldownUp(x.Icefury))then if n(x.Ascendance,nil)then Q=114050;return"Ascendance aoe 2"end end;if ar(x.LiquidMagmaTotem)and i:IsInRange(40)and r and x.LiquidMagmaTotem:IsAvailable()then if n(x.LiquidMagmaTotem,nil)then Q=192222;return"LiquidMagmaTotem aoe 2"end end;if ar(x.ChainLightning)and i:IsInRange(40)and M<4 and aI()and aG()<50 then if n(x.ChainLightning,nil)then Q=188443;return"ChainLightning aoe 1"end end;if ar(x.EarthShock)and i:IsInRange(40)and Y and not g:BuffUp(x.EchoesofGreatSunderingBuff)then if n(x.EarthShock,nil)then Q=8042;return"EarthShock aoe 1"end end;if ar(x.LavaBurst)and M<4 and not ac and(g:BuffUp(x.LavaSurgeBuff)and not aI()and x.MasterOfTheElements:IsAvailable())then if S.CastTargetIf(x.LavaBurst,J,"max",ay,aF)then return"Lava Burst aoe 108"end;if ay(i)and aF(i)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"LavaBurst aoe 1"end end end;if ar(x.Earthquake)and i:IsInRange(40)and M>=2 and not Y and(x.MasterOfTheElements:IsAvailable()and aG()>=50 and not aI())then if n(x.Earthquake,nil)then Q=61882;return"EQ aoe 2"end end;if ar(x.LavaBurst)and g:BuffUp(x.LavaSurgeBuff)and g:BuffUp(x.PrimordialWaveBuff)then if S.CastTargetIf(x.LavaBurst,J,"max",ay,aF)then return"Lava Burst aoe 208"end;if ay(i)and aF(i)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"LavaBurst aoe 2"end end end;if ar(x.LavaBurst)and M<4 and W and g:BuffUp(x.LavaSurgeBuff)and x.MasterOfTheElements:IsAvailable()and not aI()and aG()>=50 then if S.CastTargetIf(x.LavaBurst,J,"max",ay,aF)then return"Lava Burst aoe 308"end;if ay(i)and aF(i)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"LavaBurst aoe 3"end end end;if ar(x.LavaBurst)and(M<4 and W and x.MasterOfTheElements:IsAvailable()or x.MasterOfTheElements:IsAvailable()and aG()>=50 and not aI()and(not Y or g:BuffUp(x.EchoesofGreatSunderingBuff))and not W)then if S.CastTargetIf(x.LavaBurst,J,"max",ay,aF)then return"Lava Burst aoe 408"end;if ay(i)and aF(i)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"LavaBurst aoe 4"end end end;if ar(x.LavaBurst)and(M==4 and W and g:BuffUp(x.LavaSurgeBuff)and x.MasterOfTheElements:IsAvailable()and not aI()and aG()>=50)then if S.CastTargetIf(x.LavaBurst,J,"max",ay,aF)then return"Lava Burst aoe 508"end;if ay(i)and aF(i)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"LavaBurst aoe 5"end end end;if ar(x.Earthquake)and i:IsInRange(40)and M>=2 then if n(x.Earthquake,nil)then Q=61882;return"EQ aoe 3"end end;if ar(x.ChainLightning)and i:IsInRange(40)and(aK()or g:BuffRemains(x.StormkeeperBuff)<3*g:GCD()*g:BuffStack(x.StormkeeperBuff))then if n(x.ChainLightning,nil)then Q=188443;return"ChainLightning aoe 2"end end;if ar(x.LavaBurst)and i:IsInRange(40)and g:BuffUp(x.LavaSurgeBuff)and M<4 and not ac and i:DebuffUp(x.FlameShockDebuff)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst aoe 6"end end;if ar(x.ElementalBlast)and i:IsInRange(40)and x.ElementalBlast:IsAvailable()and M<5 and not ac then if n(x.ElementalBlast,nil,nil,not i:IsSpellInRange(x.ElementalBlast))then Q=117014;return"Elemental Blast aoe 1"end end;if ar(x.LavaBeam)and i:IsInRange(40)and x.Ascendance:IsAvailable()then if n(x.LavaBeam,nil,nil,not i:IsSpellInRange(x.LavaBeam))then Q=117014;return"LavaBeam aoe 1"end end;if ar(x.ChainLightning)and i:IsInRange(40)then if n(x.ChainLightning,nil)then Q=188443;return"ChainLightning aoe 1"end end;if ar(x.LavaBurst)and i:IsInRange(40)and g:BuffUp(x.LavaSurgeBuff)and g:IsMoving()then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst aoe 6"end end;if ar(x.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(x.FlameShockDebuff)and g:IsMoving()then if n(x.FlameShock,nil)then Q=188389;return"Flameshock aoe 2"end end;if ar(x.FlameShock)and g:IsMoving()then if S.CastCycle(x.FlameShock,J,aD,not i:IsSpellInRange(x.FlameShock),nil)then return"FlameShock aoe 204"end end;if ar(x.FrostShock)and i:IsInRange(40)and g:IsMoving()then if n(x.FrostShock,nil)then Q=196840;return"FrostShock aoe 1"end end end;local function aQ()if ar(x.LightningBolt)and i:IsInRange(40)and g:BuffRemains(x.StormkeeperBuff)<1.1*g:GCD()*g:BuffStack(x.StormkeeperBuff)then if n(x.LightningBolt,nil)then Q=188196;return"LightningBolt st 1"end end;if ar(x.FrostShock)and i:IsInRange(40)and x.Icefury:IsAvailable()and aM()and g:BuffRemains(x.IcefuryBuff)<1.1*g:GCD()*g:BuffStack(x.IcefuryBuff)then if n(x.FrostShock,nil)then Q=196840;return"FrostShock st 1"end end;if ar(x.FlameShock)and i:IsInRange(40)and((i:DebuffDown(x.FlameShockDebuff)or i:DebuffRemains(x.FlameShockDebuff)<=g:GCD()or x.Ascendance:IsAvailable()and i:DebuffRemains(x.FlameShockDebuff)<x.Ascendance:CooldownRemains()+g:BuffRemains(x.AscendanceBuff)and x.Ascendance:CooldownRemains()<4)and(g:BuffUp(x.LavaSurgeBuff)or not g:BloodlustUp()))then if n(x.FlameShock,nil)then Q=188389;return"Flameshock st 2"end end;if ar(x.FlameShock)and g:IsMoving()then if S.CastCycle(x.FlameShock,J,aE,not i:IsSpellInRange(x.FlameShock),nil)then return"FlameShock st 204"end end;if ar(x.FlameShock)and g:BuffUp(x.PrimordialWaveBuff)then if S.CastTargetIf(x.FlameShock,J,"min",ay,aD)then return"FlameShock st 204"end;if ay(i)and aD(i)then if n(x.FlameShock,nil,nil,not i:IsSpellInRange(x.FlameShock))then Q=188389;return"FlameShock st 204"end end end;if ar(x.Ascendance)and i:IsInRange(40)and p()and x.Ascendance:IsAvailable()and(g:CombatTime()>=60 or g:BloodlustUp())and x.LavaBurst:CooldownRemains()>0 and(not x.Icefury:IsAvailable()or not aM()and not x.Icefury:CooldownUp())then if n(x.Ascendance,nil)then Q=114050;return"Ascendance st 1"end end;if ar(x.LavaBurst)and i:IsInRange(40)and g:BuffUp(x.LavaSurgeBuff)and(Z or not aI()and x.MasterOfTheElements:IsAvailable())then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst st 1"end end;if ar(x.ElementalBlast)and i:IsInRange(40)and x.ElementalBlast:IsAvailable()and aG()<70 then if n(x.ElementalBlast,nil,nil,not i:IsSpellInRange(x.ElementalBlast))then Q=117014;return"Elemental Blast st 1"end end;if ar(x.Stormkeeper)and i:IsInRange(40)and x.Stormkeeper:IsAvailable()and aG()<44 then if n(x.Stormkeeper,nil)then Q=191634;return"st Stormkeeper 1"end end;if ar(x.EchoingShock)and i:IsInRange(40)and r and x.EchoingShock:IsAvailable()and x.LavaBurst:CooldownRemains()<=g:GCD()then if n(x.EchoingShock,nil)then Q=320125;return"Echoing Shock st 1"end end;if ar(x.LavaBurst)and i:IsInRange(40)and x.EchoingShock:IsAvailable()and g:BuffUp(x.EchoingShockBuff)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst st 2"end end;if ar(x.LiquidMagmaTotem)and i:IsInRange(40)and r and x.LiquidMagmaTotem:IsAvailable()then if n(x.LiquidMagmaTotem,nil)then Q=192222;return"LiquidMagmaTotem st 2"end end;if ar(x.Earthquake)and i:IsInRange(40)and g:BuffUp(x.EchoesofGreatSunderingBuff)and x.MasterOfTheElements:IsAvailable()and aI()then if n(x.Earthquake,nil)then Q=61882;return"EQ st 1"end end;if ar(x.LightningBolt)and i:IsInRange(40)and aK()and aI()and aG()<60 then if n(x.LightningBolt,nil)then Q=188196;return"LightningBolt st 1"end end;if ar(x.Earthquake)and i:IsInRange(40)and g:BuffUp(x.EchoesofGreatSunderingBuff)and(x.MasterOfTheElements:IsAvailable()or x.LavaBurst:CooldownRemains()>0 and aG()>=92 or M<2 and aK()and x.LavaBurst:CooldownRemains()<=g:GCD()or not x.MasterOfTheElements:IsAvailable()or x.ElementalBlast:CooldownRemains()<=1.1*g:GCD()*2)then if n(x.Earthquake,nil)then Q=61882;return"EQ st 2"end end;if ar(x.Earthquake)and i:IsInRange(40)and M>1 and not i:DebuffRefreshable(x.FlameShockDebuff)and not Y and(not x.MasterOfTheElements:IsAvailable()or aI()or x.LavaBurst:CooldownRemains()>0 and aG()>=92)then if n(x.Earthquake,nil)then Q=61882;return"EQ st 3"end end;if ar(x.LavaBurst)and i:IsInRange(40)and not aI()and aM()then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst st 3"end end;if ar(x.LavaBurst)and i:IsInRange(40)and x.LavaBurst:Charges()>a1(x.EchoOfTheElements:IsAvailable())and not aM()then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst st 4"end end;if ar(x.LavaBurst)and i:IsInRange(40)and x.EchoOfTheElements:IsAvailable()and not aI()and aG()>=50 and g:BuffDown(x.EchoesofGreatSunderingBuff)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst st 5"end end;if ar(x.EarthShock)and i:IsInRange(40)and(Y or M<2)and(x.MasterOfTheElements:IsAvailable()and g:BuffDown(x.EchoesofGreatSunderingBuff)and(aI()or aG()>=92 or M<2 and aK()and x.LavaBurst:CooldownRemains()<=g:GCD())or(not x.MasterOfTheElements:IsAvailable()or x.ElementalBlast:CooldownRemains()<=1.1*g:GCD()*2))then if n(x.EarthShock,nil)then Q=8042;return"EarthShock st 1"end end;if ar(x.FrostShock)and i:IsInRange(40)and x.Icefury:IsAvailable()and x.MasterOfTheElements:IsAvailable()and aM()and aI()then if n(x.FrostShock,nil)then Q=196840;return"FrostShock st 2"end end;if ar(x.LavaBurst)and i:IsInRange(40)and g:BuffUp(x.AscendanceBuff)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst st 6"end end;if ar(x.LavaBurst)and i:IsInRange(40)and not x.MasterOfTheElements:IsAvailable()then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst st 7"end end;if ar(x.Icefury)and x.Icefury:IsAvailable()and not(aG()>35 and x.LavaBurst:CooldownRemains()<=0)then if n(x.Icefury,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=210714;return"Icefury st 1"end end;if ar(x.FrostShock)and i:IsInRange(40)and x.Icefury:IsAvailable()and aM()and(g:BuffRemains(x.IcefuryBuff)<g:GCD()*4*g:BuffStack(x.IcefuryBuff)or aK()or not x.MasterOfTheElements:IsAvailable())then if n(x.FrostShock,nil)then Q=196840;return"FrostShock st 3"end end;if ar(x.LavaBurst)and i:IsInRange(40)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst st 8"end end;if ar(x.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(x.FlameShockDebuff)then if n(x.FlameShock,nil)then Q=188389;return"Flameshock st 4"end end;if ar(x.FlameShock)then if S.CastCycle(x.FlameShock,J,aD,not i:IsSpellInRange(x.FlameShock),nil)then return"FlameShock st 304"end end;if ar(x.FrostShock)and i:IsInRange(40)and X and g:BuffDown(x.ElementalEquilibriumBuff)and not x.ElementalBlast:IsAvailable()and not x.EchoingShock:IsAvailable()then if n(x.FrostShock,nil)then Q=196840;return"FrostShock st 5"end end;if ar(x.ChainHarvest)and i:IsInRange(40)and q then if n(x.ChainHarvest,nil)then Q=320674;return"Chain Harvest st 1"end end;if ar(x.FrostShock)and i:IsInRange(40)and x.Icefury:IsAvailable()and aM()then if n(x.FrostShock,nil)then Q=196840;return"FrostShock st 6"end end;if ar(x.Fleshcraft)and x.VolatileSolvent:SoulbindEnabled()then if n(x.Fleshcraft,nil,nil)then Q=324631;return"st Fleshcraft"end end;if ar(x.StaticDischarge)and x.StaticDischarge:IsAvailable()and r then if n(x.StaticDischarge,nil,nil)then Q=342243;return"st StaticDischarge"end end;if ar(x.EarthElemental)and p()and(not x.PrimalElementalist:IsAvailable()or not ad)then if n(x.EarthElemental,nil,nil)then Q=198103;return"st Earth Ele"end end;if ar(x.ChainLightning)and i:IsInRange(40)and M>1 then if n(x.ChainLightning,nil)then Q=188443;return"ChainLightning st 1"end end;if ar(x.LightningBolt)and i:IsInRange(40)then if n(x.LightningBolt,nil)then Q=188196;return"LightningBolt st 2"end end;if ar(x.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(x.FlameShockDebuff)and g:IsMoving()then if n(x.FlameShock,nil)then Q=188389;return"Flameshock st 2"end end;if ar(x.FlameShock)and g:IsMoving()then if S.CastCycle(x.FlameShock,J,aD,not i:IsSpellInRange(x.FlameShock),nil)then return"FlameShock st 204"end end;if ar(x.FrostShock)and i:IsInRange(40)and g:Moving()then if n(x.FrostShock,nil)then Q=196840;return"FrostShock st 7"end end;if ar(x.FrostShock)and i:IsInRange(40)and x.Icefury:IsAvailable()and aM()and g:BuffRemains(x.IcefuryBuff)<1.1*g:GCD()*g:BuffStack(x.IcefuryBuff)then if n(x.FrostShock,nil)then Q=196840;return"FrostShock st 7"end end end;local function aR()if ar(x.StormElemental)and i:IsInRange(40)and x.StormElemental:IsAvailable()and p()then if n(x.StormElemental,nil)then Q=192249;return"Storm Elemental sest 1"end end;if ar(x.FrostShock)and i:IsInRange(40)and x.Icefury:IsAvailable()and aM()and g:BuffRemains(x.IcefuryBuff)<1.1*g:GCD()*g:BuffStack(x.IcefuryBuff)and g:BuffStack(x.WindGustBuff)<18 then if n(x.FrostShock,nil)then Q=196840;return"FrostShock sest 1"end end;if ar(x.ElementalBlast)and i:IsInRange(40)and x.ElementalBlast:IsAvailable()then if n(x.ElementalBlast,nil,nil,not i:IsSpellInRange(x.ElementalBlast))then Q=117014;return"Elemental Blast sest 1"end end;if ar(x.Stormkeeper)and i:IsInRange(40)and x.Stormkeeper:IsAvailable()then if n(x.Stormkeeper,nil)then Q=191634;return"sest Stormkeeper 1"end end;if ar(x.EchoingShock)and i:IsInRange(40)and r and x.EchoingShock:IsAvailable()and(x.LavaBurst:CooldownRemains()<=g:GCD()and M<2 or aG()>=60 and M>=2 and(not Y or g:BuffUp(x.EchoesofGreatSunderingBuff))or M<2 and g:BuffStack(x.WindGustBuff)>=18 and(not Y or g:BuffUp(x.EchoesofGreatSunderingBuff))and aG()>=60)then if n(x.EchoingShock,nil)then Q=320125;return"Echoing Shock sest 2"end end;if ar(x.LavaBurst)and i:IsInRange(40)and(g:BuffStack(x.WindGustBuff)<18 and not g:BloodlustUp()or g:BuffUp(x.LavaSurgeBuff))then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst sest 6"end end;if ar(x.LavaBurst)and i:IsInRange(40)and x.EchoingShock:IsAvailable()and g:BuffUp(x.EchoingShockBuff)and M<2 then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst sest 6"end end;if ar(x.Earthquake)and i:IsInRange(40)and x.EchoingShock:IsAvailable()and g:BuffUp(x.EchoingShockBuff)and M>=2 then if n(x.Earthquake,nil)then Q=61882;return"EQ sest 1"end end;if ar(x.LightningBolt)and i:IsInRange(40)and aK()then if n(x.LightningBolt,nil)then Q=188196;return"LightningBolt sest 1"end end;if ar(x.Earthquake)and i:IsInRange(40)and g:BuffUp(x.EchoesofGreatSunderingBuff)then if n(x.Earthquake,nil)then Q=61882;return"EQ sest 2"end end;if ar(x.EarthShock)and i:IsInRange(40)and r and M<2 and aG()>=60 and(g:BuffStack(x.WindGustBuff)<20 or aG()>90 or Y and not g:BuffUp(x.EchoesofGreatSunderingBuff))then if n(x.EarthShock,nil)then Q=8042;return"EarthShock sest 2"end end;if ar(x.Earthquake)and i:IsInRange(40)and M>1 and not i:DebuffRefreshable(x.FlameShockDebuff)then if n(x.Earthquake,nil)then Q=61882;return"EQ sest 3"end end;if ar(x.ChainLightning)and i:IsInRange(40)and M>1 and ac and g:BloodlustUp()then if n(x.ChainLightning,nil)then Q=188443;return"ChainLightning sest 1"end end;if ar(x.LightningBolt)and i:IsInRange(40)and ac and g:BloodlustUp()then if n(x.LightningBolt,nil)then Q=188196;return"LightningBolt sest 1"end end;if ar(x.LavaBurst)and i:IsInRange(40)and g:BuffUp(x.AscendanceBuff)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst sest 6"end end;if ar(x.LavaBurst)and i:IsInRange(40)then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst sest 7"end end;if ar(x.LavaBurst)and i:IsInRange(40)and x.LavaBurst:SpellCharges()>a1(x.EchoOfTheElements:IsAvailable())then if n(x.LavaBurst,nil,nil,not i:IsSpellInRange(x.LavaBurst))then Q=51505;return"Lavaburst sest 8"end end;if ar(x.FrostShock)and i:IsInRange(40)and x.Icefury:IsAvailable()and aM()then if n(x.FrostShock,nil)then Q=196840;return"FrostShock SEST 1"end end;if ar(x.ChainHarvest)and i:IsInRange(40)and q then if n(x.ChainHarvest,nil)then Q=320674;return"Chain Harvest SEST 1"end end;if ar(x.Fleshcraft)and x.VolatileSolvent:SoulbindEnabled()then if n(x.Fleshcraft,nil,nil)then Q=324631;return"SEST Fleshcraft"end end;if ar(x.StaticDischarge)and x.StaticDischarge:IsAvailable()and r then if n(x.StaticDischarge,nil,nil)then Q=342243;return"SEST StaticDischarge"end end;if ar(x.EarthElemental)and p()and i:IsSpellInRange(x.LightningBolt)and(not x.PrimalElementalist:IsAvailable()or x.PrimalElementalist:IsAvailable()and not ac)then if n(x.EarthElemental,nil,nil)then Q=198103;return"sest Earth Ele"end end;if ar(x.ChainLightning)and i:IsInRange(40)and M>1 then if n(x.ChainLightning,nil)then Q=188443;return"ChainLightning sest 2"end end;if ar(x.LightningBolt)and i:IsInRange(40)then if n(x.LightningBolt,nil)then Q=188196;return"LightningBolt sest 2"end end;if ar(x.FlameShock)and i:IsInRange(40)and i:DebuffRefreshable(x.FlameShockDebuff)and g:IsMoving()then if n(x.FlameShock,nil)then Q=188389;return"Flameshock sest 2"end end;if ar(x.FlameShock)and g:IsMoving()then if S.CastCycle(x.FlameShock,J,aD,not i:IsSpellInRange(x.FlameShock),nil)then return"FlameShock sest 204"end end;if ar(x.FrostShock)and i:IsInRange(40)and g:IsMoving()then if n(x.FrostShock,nil)then Q=196840;return"FrostShock aoe 1"end end end;local function aS()s=HeroRotationCharDB.Toggles[6]q=HeroRotationCharDB.Toggles[4]r=HeroRotationCharDB.Toggles[5]u=HeroRotationCharDB.Toggles[12]t=not HeroRotationCharDB.Toggles[15]v=HeroRotationCharDB.Toggles[60]end;local function aT()H=g:GetEnemiesInMeleeRange(8)I=g:GetEnemiesInRange(30)J=g:GetEnemiesInRange(40)K=i:GetEnemiesInSplashRange(15)D,E=GetInventoryItemID("player",13)F,E=GetInventoryItemID("player",14)if o()and U.Commons.AoeMode=="Conservative"then L=i:GetEnemiesInSplashRangeCount(8)M=i:GetEnemiesInSplashRangeCount(15)elseif o()and U.Commons.AoeMode=="Aggresive"then local aU=0;for aV=1,20 do local aW="nameplate"..aV;if UnitExists(aW)then if UnitCanAttack("player",aW)then if UnitCanAttack("player",aW)and UnitAffectingCombat("target")and IsItemInRange(32698,aW)and UnitDetailedThreatSituation("player",aW)~=nil or f(aW):IsDummy()or string.find(UnitGUID(aW),153285)or string.find(UnitGUID(aW),31146)or string.find(UnitGUID(aW),176581)or string.find(UnitGUID(aW),179124)or string.find(UnitGUID(aW),179010)or string.find(UnitGUID(aW),180323)or string.find(UnitGUID(aW),179010)or string.find(UnitGUID(aW),179942)or string.find(UnitGUID(aW),176521)or string.find(UnitGUID(aW),177594)or string.find(UnitGUID(aW),177117)or string.find(UnitGUID(aW),176581)or string.find(UnitGUID(aW),180840)or string.find(UnitGUID(aW),176605)or UnitName(aW)=="Glacial Spike"or string.find(UnitGUID(aW),180473)or string.find(UnitGUID(aW),180474)or string.find(UnitGUID(aW),176929)or string.find(UnitGUID(aW),176920)or string.find(UnitGUID(aW),177154)or string.find(UnitGUID(aW),177787)or string.find(UnitGUID(aW),177889)or string.find(UnitGUID(aW),177891)or string.find(UnitGUID(aW),177892)or string.find(UnitGUID(aW),168326)then aU=aU+1 end end end end;L=aU;M=aU end;if not o()then L=1;M=1 end;if v then M=10;L=10 end;ae()ao()if not BotOn then P=0;Q=0 end;if P>0 then P=0 end;if Q>0 then Q=0 end;G=aS()if m.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+m.GUISettings.General.OpenerReset elseif m.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]m.ToggleIconFrame:UpdateButtonText(6)m.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if U.Elemental.PreferEarthShield and x.EarthShield:IsCastable()and(g:BuffDown(x.EarthShield)or not g:AffectingCombat()and g:BuffStack(x.EarthShield)<5)then if n(x.EarthShield,nil)then Q=974;return"Earth Shield Refresh"end elseif x.LightningShield:IsCastable()and g:BuffDown(x.LightningShield)and(U.Elemental.PreferEarthShield and g:BuffDown(x.EarthShield)or not U.Elemental.PreferEarthShield)then if n(x.LightningShield,nil)then Q=192106;return"Lightning Shield Refresh"end end;if g:IsChanneling()then if n(x.Pool,nil)then Q=999;return"Trinket Channel"end end;if not g:AffectingCombat()and S.TargetIsValid()and s then local G=aO()if G then return G end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if x.FrostShock:IsCastable()then if n(x.FrostShock,nil)then P=1196840;return"explosive MO FS"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if x.FrostShock:IsCastable()then if n(x.FrostShock,nil)then Q=196840;return"explosive  FS"end end end;if S.TargetIsValid()and g:AffectingCombat()and(i:AffectingCombat()or i:IsDummy()or i:NPCID()==153285 or i:NPCID()==168326 or i:NPCID()==176581 or i:NPCID()==176920)and not g:IsDeadOrGhost()then if y.PotionofSpectralIntellect:IsReady()and U.Commons.Enabled.Potions then if n(y.PotionofSpectralIntellect,nil,nil)then Q=50;return"potion main 16"end end;if(U.Commons.Enabled.TopTrinket or U.Commons.Enabled.BottomTrinket)and p()then local aX=g:GetUseableTrinkets(z)if aX then if n(aX,nil,nil)then if aX:ID()==D and U.Commons.Enabled.TopTrinket then Q=24;return"top trinket 1"elseif aX:ID()==F and U.Commons.Enabled.BottomTrinket then Q=30;return"Bot trinket 2"end end end end;if ar(x.FlameShock)and i:IsInRange(40)and not x.ElementalBlast:IsAvailable()and i:DebuffDown(x.FlameShockDebuff)and not ac and(M<3 or x.MasterOfTheElements:IsAvailable()or W)then if n(x.FlameShock,nil)then Q=188389;return"Flameshock 1"end end;if ar(x.PrimordialWave)then if S.CastTargetIf(x.PrimordialWave,J,"min",ay,aB)then return"Primo Wave 108"end;if ay(i)and aB(i)then if n(x.PrimordialWave,nil,nil,not i:IsSpellInRange(x.PrimordialWave))then Q=326059;return"PrimordialWave 108"end end end;if ar(x.FlameShock)then if S.CastTargetIf(x.FlameShock,J,"min",ay,aC)then return"Flame Shock 108"end;if ay(i)and aC(i)then if n(x.FlameShock,nil,nil,not i:IsSpellInRange(x.FlameShock))then Q=188389;return"FlameShock 108"end end end;if ar(x.FireElemental)and p()and not x.StormElemental:IsAvailable()then if n(x.FireElemental,nil)then Q=198067;return"Fire Elemental 1"end end;if p()then if x.BloodFury:IsCastable()and p()and i:IsInRange(8)and(not x.Ascendance:IsAvailable()or g:BuffUp(x.Ascendance)or x.Ascendance:CooldownRemains()>50)then if m.Cast(x.BloodFury,nil)then Q=20572;return"Blood Fury 420"end end;if x.Berserking:IsCastable()and p()and i:IsInRange(8)and(not x.Ascendance:IsAvailable()or g:BuffUp(x.Ascendance))then if m.Cast(x.Berserking,nil)then Q=26297;return"Berserking 422"end end;if x.Fireblood:IsCastable()and p()and i:IsInRange(8)and(not x.Ascendance:IsAvailable()or g:BuffUp(x.Ascendance)or x.Ascendance:CooldownRemains()>50)then if m.Cast(x.Fireblood,nil)then Q=265221;return"Fireblood 426"end end;if x.AncestralCall:IsCastable()and p()and i:IsInRange(8)and(not x.Ascendance:IsAvailable()or g:BuffUp(x.Ascendance)or x.Ascendance:CooldownRemains()>50)then if m.Cast(x.AncestralCall,nil)then Q=274738;return"Ancestral Call 428"end end;if x.BagofTricks:IsCastable()and p()and i:IsInRange(8)and(not x.Ascendance:IsAvailable()or g:BuffUp(x.Ascendance))then if m.Cast(x.BagofTricks,nil,nil,not i:IsInRange(40))then Q=312411;return"Bag of Tricks 430"end end end;if ar(x.VesperTotem)and q and i:IsInRange(40)and x.VesperTotem:IsAvailable()then if n(x.VesperTotem,nil)then Q=324386;return"VesperTotem 1"end end;if ar(x.FaeTransfusion)and q and x.FaeTransfusion:IsAvailable()and not a0 and(not x.MasterOfTheElements:IsAvailable()or aI())and M<3 then if n(x.FaeTransfusion,nil)then Q=328923;return"FaeTransfusion 1"end end;if ar(x.FaeTransfusion)and q and x.FaeTransfusion:IsAvailable()and a0 and(not x.MasterOfTheElements:IsAvailable()or aI()or M>=3)and(x.FireElemental:CooldownRemains()>20 and not x.StormElemental:IsAvailable()or x.StormElemental:CooldownRemains()>20 and x.StormElemental:IsAvailable())then if n(x.FaeTransfusion,nil)then Q=328923;return"FaeTransfusion 1"end end;if M>2 then local G=aP()if G then return G end end;if not x.StormElemental:IsAvailable()and M<=2 then local G=aQ()if G then return G end end;if x.StormElemental:IsAvailable()and M<=2 then local G=aR()if G then return G end end;m.CastAnnotated(x.Pool,false,"ERR")end end;local function aY()end;function ReturnSpell1()if Q==0 then return 0 else return Q end end;function ReturnSpellMO1()if P==0 then return 0 else return P end end;m.SetAPL(262,aT,aY)