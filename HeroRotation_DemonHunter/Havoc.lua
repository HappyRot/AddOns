local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=HeroRotation;local m=l.AoEON;local n=l.CDsON;local o=HeroRotationCharDB.Toggles[4]local p=HeroRotationCharDB.Toggles[5]local q=HeroRotationCharDB.Toggles[6]local r=HeroRotationCharDB.Toggles[12]local s=not HeroRotationCharDB.Toggles[15]local t=HeroRotationCharDB.Toggles[40]local u=HeroRotationCharDB.Toggles[42]local v=HeroRotationCharDB.Toggles[43]local w=HeroRotationCharDB.Toggles[41]local x=HeroRotationCharDB.Toggles[45]local y=HeroRotationCharDB.Toggles[46]local z=HeroRotationCharDB.Toggles[47]local A=HeroRotationCharDB.Toggles[48]local B=HeroRotationCharDB.Toggles[44]local C=false;local D=false;local E=false;local F=false;local G=GetInventoryItemID("player",13)local H=GetInventoryItemID("player",14)local I=0;local J=l.Cast;local K=l.CastSuggested;local L=string.match;local M=j.DemonHunter.Havoc;local N=k.DemonHunter.Havoc;local O={}local P=g:GetEquipment()local Q=k(0)local R=k(0)if P[13]then Q=k(P[13])end;if P[14]then R=k(P[14])end;local S;local T,U;local V,W;local X=g:HasLegendaryEquipped(20)local Y=g:HasLegendaryEquipped(23)local Z=g:HasLegendaryEquipped(25)local _=l.Commons.Everyone;local a0={General=l.GUISettings.General,Commons=l.GUISettings.APL.DemonHunter.Commons,Havoc=l.GUISettings.APL.DemonHunter.Havoc}local a1={{M.FelEruption,"Cast Fel Eruption (Interrupt)",function()return true end},{M.ChaosNova,"Cast Chaos Nova (Interrupt)",function()return true end}}local a2=0;local a3=0;local a4=false;local a5=false;local a6=false;local a7=false;local a8=false;local a9=false;local aa=false;local ab=0;local ac=false;d:RegisterForEvent(function()a5=false;a6=false;a7=false;a8=false;a9=false;aa=false end,"PLAYER_REGEN_ENABLED")d:RegisterForEvent(function()P=g:GetEquipment()Q=k(0)R=k(0)if P[13]then Q=k(P[13])end;if P[14]then R=k(P[14])end;X=g:HasLegendaryEquipped(20)Y=g:HasLegendaryEquipped(23)Z=g:HasLegendaryEquipped(25)end,"PLAYER_EQUIPMENT_CHANGED")local function ad(ae)if ae then return 1 else return 0 end end;local function af(ae)return ae~=0 end;local function ag(ah)local ag=0;if ah~=nil then for ai in pairs(ah)do local aj=ah[ai]if aj:NPCID()==169421 or aj:NPCID()==169425 or aj:NPCID()==168932 or aj:NPCID()==169426 or aj:NPCID()==169429 or aj:NPCID()==169428 or aj:NPCID()==169430 then ag=ag+1 end end end;return ag end;local function ak(al)if M.Felblade:TimeSinceLastCast()<=g:GCD()then return true elseif M.VengefulRetreat:TimeSinceLastCast()<1.0 and M.VengefulRetreat:TimeSinceLastCast()>0.25 or M.FelRush:TimeSinceLastCast()<1.0 then return false end;return al and h:IsInMeleeRange(al)or h:IsInMeleeRange(5)end;local function am()return true end;local function an(ah)local ao=0;if ah~=nil then for ai in pairs(ah)do local aj=ah[ai]if aj:DebuffDown(M.BurningWoundDebuff)then ao=ao+1 end end end;return ao end;local function ap(ah)local aq=0;if ah~=nil then for ai in pairs(ah)do local aj=ah[ai]if aj:DebuffDown(M.SadisticGleeDebuff)then aq=aq+1 end end end;return aq end;local function ar(as)return as:DebuffRemains(M.BurningWoundDebuff)end;local function at(as)if Z and as:DebuffRemains(M.BurningWoundDebuff)<4 and as:IsInRange(8)and as:GUID()==f("mouseover"):GUID()then if M.DemonBlades:IsAvailable()then a3=1111 else a3=111 end;return true elseif Z and as:DebuffRemains(M.BurningWoundDebuff)<4 and as:IsInRange(8)and a0.Havoc.TargetSwap=="AutoSwap"and as:GUID()~=h:GUID()and not r then a3=999;return true elseif Z and as:DebuffRemains(M.BurningWoundDebuff)<4 and as:IsInRange(8)and as:GUID()==h:GUID()and h:IsInRange(8)then a2=162243;return true elseif Z and as:DebuffRemains(M.BurningWoundDebuff)<4 and as:IsInRange(8)then return true end end;local function au(as)return as:DebuffRemains(M.BurningWoundDebuff)end;local function av(as)if Z and as:DebuffRemains(M.BurningWoundDebuff)<4 and as:IsInRange(8)and as:GUID()==f("mouseover"):GUID()then if M.DemonBlades:IsAvailable()then a3=1111 else a3=111 end;return true elseif Z and as:DebuffRemains(M.BurningWoundDebuff)<4 and as:IsInRange(8)and a0.Havoc.TargetSwap=="AutoSwap"and as:GUID()~=h:GUID()and not r then a3=999;return true elseif Z and as:DebuffRemains(M.BurningWoundDebuff)<4 and as:IsInRange(8)and as:GUID()==h:GUID()then a2=162243;return true elseif Z and as:DebuffRemains(M.BurningWoundDebuff)<4 and as:IsInRange(8)then return true end end;local function aw()if Q:TrinketHasStatAnyDps()and not R:TrinketHasStatAnyDps()then ab=1 end;if R:TrinketHasStatAnyDps()and not Q:TrinketHasStatAnyDps()then ab=2 end;if Q:TrinketHasStatAnyDps()and R:TrinketHasStatAnyDps()or not(Q:TrinketHasStatAnyDps()and R:TrinketHasStatAnyDps())then ab=0 end;ac=M.BlindFury:IsAvailable()and(X or M.DemonBlades:IsAvailable())if not h:IsInMeleeRange(5)and M.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and h:IsInRange(15)and M.FelRush:IsCastable()and C then if J(M.FelRush,nil,nil,not h:IsInRange(15))then a2=195072;return"fel_rush precombat 2"end end;if h:IsInMeleeRange(5)and(M.DemonsBite:IsCastable()or M.DemonBlades:IsAvailable())then if M.DemonBlades:IsAvailable()and IsCurrentSpell(6603)~=true then if J(M.DemonsBite,nil,nil,not h:IsInMeleeRange(5))then a2=1162243;return"demons_bite or demon_blades precombat 4"end else if J(M.DemonsBite,nil,nil,not h:IsInMeleeRange(5))then a2=162243;return"demons_bite or demon_blades precombat 4"end end end end;local function ax()if M.Metamorphosis:IsCastable()and E and h:IsInRange(8)and(not M.Demonic:IsAvailable()and(M.EyeBeam:CooldownRemains()>20 or not F)and(not M.SinfulBrand:IsAvailable()or h:DebuffDown(M.SinfulBrandDebuff))or d.BossFilteredFightRemains("<",25))then if J(M.Metamorphosis,nil,nil,not h:IsInRange(40))then a2=191427;return"metamorphosis cooldown 2"end end;if M.Metamorphosis:IsCastable()and E and h:IsInRange(8)and(M.Demonic:IsAvailable()and((M.EyeBeam:CooldownRemains()>20 or not F)and(not a6 or M.BladeDance:CooldownRemains()>g:GCD()))and(not M.SinfulBrand:IsAvailable()or h:DebuffDown(M.SinfulBrandDebuff))or d.BossFilteredFightRemains("<",25))then if J(M.Metamorphosis,nil,nil,not h:IsInRange(40))then a2=191427;return"metamorphosis cooldown 4"end end;if(N.PotionofPhantomFire:IsReady()or N.PotionofSpectralAgility:IsReady())and h:IsInMeleeRange(8)and l.CDsON()and s and a0.Commons.Enabled.Potions and(g:BuffRemains(M.MetamorphosisBuff)>25 or d.BossFilteredFightRemains("<",60))then if J(N.PotionofPhantomFire,nil,nil)then a2=4;return"potion cooldown 6"end end;if Q:IsReady()and h:IsInRange(10)and a0.Commons.Enabled.TopTrinket and l.CDsON()and(ab==1 and(g:BuffUp(M.MetamorphosisBuff)or not M.Demonic:IsAvailable()and(M.Metamorphosis:CooldownRemains()>d.FightRemains(U)or not E)or d.BossFilteredFightRemains("<=",20))or ab==2 and not R:IsReady()or ab==0)then if J(Q,nil,nil)then if Q:ID()==GetInventoryItemID("player",13)and a0.Commons.Enabled.TopTrinket then a2=20;return"top trinket 1"elseif Q:ID()==GetInventoryItemID("player",14)and a0.Commons.Enabled.BottomTrinket then a2=25;return"bot trinket 1"end end end;if R:IsReady()and h:IsInRange(10)and a0.Commons.Enabled.BottomTrinket and l.CDsON()and(ab==2 and(g:BuffUp(M.MetamorphosisBuff)or not M.Demonic:IsAvailable()and(M.Metamorphosis:CooldownRemains()>d.FightRemains(U)or not E)or d.BossFilteredFightRemains("<=",20))or ab==1 and not Q:IsReady()or ab==0)then if J(R,nil,nil)then if R:ID()==GetInventoryItemID("player",13)and a0.Commons.Enabled.TopTrinket then a2=20;return"top trinket 1"elseif R:ID()==GetInventoryItemID("player",14)and a0.Commons.Enabled.BottomTrinket then a2=25;return"bot trinket 1"end end end;if M.SinfulBrand:IsCastable()and h:IsInMeleeRange(30)and o and h:DebuffDown(M.SinfulBrandDebuff)then if J(M.SinfulBrand,nil,nil,not h:IsSpellInRange(M.SinfulBrand))then a2=317009;return"sinful_brand cooldown 12"end end;if M.TheHunt:IsCastable()and not g:IsMoving()and(I==0 or I>M.TheHunt:CastTime())and h:IsInRange(40)and o and(not M.Demonic:IsAvailable()and not aa and not a5 or g:BuffUp(M.FuriousGazeBuff)or M.Demonic:IsAvailable())then if J(M.TheHunt,nil,nil,not h:IsSpellInRange(M.TheHunt))then a2=323639;return"the_hunt cooldown 14"end end;if M.ElysianDecree:IsCastable()and h:IsInRange(30)and o and V>0 then if J(M.ElysianDecree,nil,nil,not h:IsInRange(30))then a2=306830;return"elysian_decree cooldown 16"end end end;local function ay()if M.FelRush:IsCastable()and h:IsInRange(15)and M.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(M.UnboundChaos:IsAvailable()and g:BuffUp(M.UnboundChaosBuff)and M.FelRush:Charges()==2)and C then if J(M.FelRush,nil,nil)then a2=195072;return"fel_rush demonic 2"end end;if M.DeathSweep:IsReady()and M.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a6 then if J(M.DeathSweep,nil,nil,not ak(8))then a2=210152;return"death_sweep demonic 4"end end;if M.GlaiveTempest:IsReady()and h:IsInMeleeRange(8)and V>0 then if J(M.GlaiveTempest,nil,nil,not h:IsInMeleeRange(8))then a2=342817;return"glaive_tempest demonic 6"end end;if M.ThrowGlaive:IsCastable()and h:IsInMeleeRange(30)and M.VengefulRetreat:TimeSinceLastCast()>1 and(M.SerratedGlaive:ConduitEnabled()and(M.EyeBeam:CooldownRemains()<6 and F)and g:BuffDown(M.MetamorphosisBuff)and h:DebuffDown(M.ExposedWoundDebuff))then if J(M.ThrowGlaive,nil,nil,not h:IsSpellInRange(M.ThrowGlaive))then a2=185123;return"throw_glaive demonic 8"end end;if M.EyeBeam:IsReady()and not g:IsMoving()and(I==0 or I>M.EyeBeam:ExecuteTime())and F and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and M.VengefulRetreat:TimeSinceLastCast()>=1 and(V>0 and(not ac or V>1 or g:Fury()<70))then if J(M.EyeBeam,nil,nil,not h:IsInRange(20))then a2=198013;return"eye_beam demonic 10"end end;if M.BladeDance:IsReady()and M.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and(a6 and not M.Metamorphosis:CooldownUp()and(M.EyeBeam:CooldownRemains()>5 or not F))then if J(M.BladeDance,nil,nil,not ak(8))then a2=188499;return"blade_dance demonic 12"end end;if M.ImmolationAura:IsCastable()and not u and M.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and g:BuffDown(M.ImmolationAuraBuff)then if J(M.ImmolationAura,nil,nil,not ak(8))then a2=258920;return"immolation_aura demonic 14"end end;if M.Annihilation:IsReady()and h:IsInRange(8)and h:IsInMeleeRange(8)and not a7 then if J(M.Annihilation,nil,nil,not h:IsSpellInRange(M.Annihilation))then a2=201427;return"annihilation demonic 16"end end;if M.Felblade:IsCastable()and not g:IsMoving()and not v and h:IsInRange(15)and(h:IsInRange(8)or not t)and g:FuryDeficit()>=40 and(not ak()or M.VengefulRetreat:TimeSinceLastCast()>=1.0)then if J(M.Felblade,nil,nil,not h:IsSpellInRange(M.Felblade))then a2=183226;return"felblade demonic 18"end end;if M.EssenceBreak:IsCastable()and h:IsInMeleeRange(10)and M.VengefulRetreat:TimeSinceLastCast()>1 then if J(M.EssenceBreak,nil,nil,not ak(10))then a2=258860;return"essence_break demonic 20"end end;if M.ChaosStrike:IsReady()and h:IsInMeleeRange(8)and(not a7 and not a8)then if J(M.ChaosStrike,nil,nil,not h:IsSpellInRange(M.ChaosStrike))then a2=162794;return"chaos_strike demonic 22"end end;if M.FelRush:IsCastable()and h:IsInRange(15)and M.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(M.DemonBlades:IsAvailable()and not M.EyeBeam:CooldownUp()and am())and C then if J(M.FelRush,nil,nil)then a2=195072;return"fel_rush demonic 24"end end;if M.DemonsBite:IsCastable()or M.DemonBlades:IsAvailable()then if Z and not M.DemonBlades:IsAvailable()and(h:DebuffRemains(M.BurningWoundDebuff)<4 or(UnitsWithoutBWCount==0 or not m()))then if J(M.DemonsBite,nil,nil,not h:IsSpellInRange(M.DemonsBite))then a2=162243;return"demons_bite 26T"end end;if _.CastTargetIf(M.DemonsBite,T,"min",au,av)then return"demons_bite demonic 26"end end;if M.FelRush:IsCastable()and h:IsInRange(15)and M.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not M.DemonBlades:IsAvailable()and V>1 and M.FelRush:Charges()==2)and C then if J(M.FelRush,nil,nil)then a2=195072;return"fel_rush demonic 28"end end;if M.DemonsBite:IsCastable()and not M.DemonBlades:IsAvailable()and h:IsInMeleeRange(8)and not Z then if J(M.DemonsBite,nil,nil,not h:IsSpellInRange(M.DemonsBite))then a2=162243;return"demons_bite demonic 30"end end;if M.ThrowGlaive:IsCastable()and h:IsInRange(30)and not ak()then if J(M.ThrowGlaive,nil,nil,not h:IsSpellInRange(M.ThrowGlaive))then a2=185123;return"throw_glaive demonic 32"end end;if M.FelRush:IsCastable()and h:IsInRange(15)and M.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not ak()and am())and C then if J(M.FelRush,nil,nil)then a2=195072;return"fel_rush demonic 34"end end;if M.VengefulRetreat:IsCastable()and M.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and D and not t and not ak()then if J(M.VengefulRetreat,nil)then a2=198793;return"vengeful_retreat demonic 36"end end;if M.ThrowGlaive:IsCastable()and h:IsInRange(30)and M.DemonBlades:IsAvailable()then if J(M.ThrowGlaive,nil,nil,not h:IsSpellInRange(M.ThrowGlaive))then a2=185123;return"throw_glaive demonic 38"end end end;local function az()if M.VengefulRetreat:IsCastable()and M.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and D and not t and(M.Momentum:IsAvailable()and g:BuffDown(M.PreparedBuff)and d.CombatTime()>1)then if J(M.VengefulRetreat,nil)then a2=198793;return"vengeful_retreat normal 2"end end;if M.FelRush:IsCastable()and h:IsInRange(15)and M.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and((g:BuffUp(M.UnboundChaosBuff)or aa and(not M.UnboundChaos:IsAvailable()or not M.ImmolationAura:CooldownUp()))and am())and C then if J(M.FelRush,nil,nil)then a2=195072;return"fel_rush demonic 34"end end;if M.FelBarrage:IsCastable()and M.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and V>1 then if J(M.FelBarrage,nil,nil,not ak(8))then a2=211053;return"fel_barrage normal 6"end end;if M.DeathSweep:IsReady()and M.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a6 then if J(M.DeathSweep,nil,nil,not ak(8))then a2=210152;return"death_sweep normal 8"end end;if M.ImmolationAura:IsCastable()and not u and M.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and g:BuffDown(M.ImmolationAuraBuff)then if J(M.ImmolationAura,nil,nil,not ak(8))then a2=258920;return"immolation_aura normal 10"end end;if M.GlaiveTempest:IsReady()and M.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and(not aa and V>0)then if J(M.GlaiveTempest,nil)then a2=342817;return"glaive_tempest normal 12"end end;if M.ThrowGlaive:IsCastable()and M.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInRange(30)and(M.SerratedGlaive:ConduitEnabled()and(M.EyeBeam:CooldownRemains()<6 and F)and g:BuffDown(M.MetamorphosisBuff)and h:DebuffDown(M.ExposedWoundDebuff))then if J(M.ThrowGlaive,nil,nil,not h:IsSpellInRange(M.ThrowGlaive))then a2=185123;return"throw_glaive normal 14"end end;if M.EyeBeam:IsReady()and not g:IsMoving()and(I==0 or I>M.EyeBeam:ExecuteTime())and F and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and M.VengefulRetreat:TimeSinceLastCast()>=1 and(not aa and(W>0 and(not ac or V>1 or g:Fury()<70)))then if J(M.EyeBeam,nil,nil,not ak(20))then a2=198013;return"eye_beam normal 16"end end;if M.BladeDance:IsReady()and M.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a6 then if J(M.BladeDance,nil,nil,not ak(8))then a2=188499;return"blade_dance normal 18"end end;if M.Felblade:IsCastable()and not g:IsMoving()and not v and h:IsInMeleeRange(15)and(h:IsInRange(8)or not t)and g:FuryDeficit()>=40 and(not ak()or M.VengefulRetreat:TimeSinceLastCast()>=1.0)then if J(M.Felblade,nil,nil,not h:IsSpellInRange(M.Felblade))then a2=183226;return"felblade normal 20"end end;if M.EssenceBreak:IsCastable()and h:IsInMeleeRange(10)and M.VengefulRetreat:TimeSinceLastCast()>1 then if J(M.EssenceBreak,nil,nil,not ak(10))then a2=258860;return"essence_break normal 22"end end;if M.Annihilation:IsReady()and M.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and((M.DemonBlades:IsAvailable()or not aa or g:FuryDeficit()<30 or g:BuffRemains(M.MetamorphosisBuff)<5)and not a7)then if J(M.Annihilation,nil,nil,not h:IsSpellInRange(M.Annihilation))then a2=201427;return"annihilation normal 24"end end;if M.ChaosStrike:IsReady()and M.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and((M.DemonBlades:IsAvailable()or not aa or g:FuryDeficit()<30)and not a5 and not a7)then if J(M.ChaosStrike,nil,nil,not h:IsSpellInRange(M.ChaosStrike))then a2=162794;return"chaos_strike normal 26"end end;if M.EyeBeam:IsReady()and not g:IsMoving()and(I==0 or I>M.EyeBeam:ExecuteTime())and F and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and M.VengefulRetreat:TimeSinceLastCast()>=1 and M.BlindFury:IsAvailable()then if J(M.EyeBeam,nil,nil,not h:IsInRange(20))then a2=198013;return"eye_beam normal 28"end end;if(M.DemonsBite:IsCastable()or M.DemonBlades:IsAvailable())and M.VengefulRetreat:TimeSinceLastCast()>1 then if Z and not M.DemonBlades:IsAvailable()and(h:DebuffRemains(M.BurningWoundDebuff)<4 or(UnitsWithoutBWCount==0 or not m()))then if J(M.DemonsBite,nil,nil,not h:IsSpellInRange(M.DemonsBite))then a2=162243;return"demons_bite 26T"end end;if _.CastTargetIf(M.DemonsBite,T,"min",ar,at)then return"demons_bite normal 28"end end;if M.DemonsBite:IsCastable()and not M.DemonBlades:IsAvailable()and M.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and not Z then if J(M.DemonsBite,nil,nil,not h:IsSpellInRange(M.DemonsBite))then a2=162243;return"demons_bite normal 30"end end;if M.FelRush:IsCastable()and h:IsInRange(15)and M.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not M.Momentum:IsAvailable()and M.DemonBlades:IsAvailable()and am())and C then if J(M.FelRush,nil,nil)then a2=195072;return"fel_rush demonic 34"end end;if M.Felblade:IsCastable()and not g:IsMoving()and not v and h:IsInRange(15)and(not ak()and not t)then if J(M.Felblade,nil,nil,not h:IsSpellInRange(M.Felblade))then a2=183226;return"felblade normal 34"end end;if M.FelRush:IsCastable()and h:IsInRange(15)and M.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not ak()and not M.Momentum:IsAvailable()and am())and C then if J(M.FelRush,nil,nil)then a2=195072;return"fel_rush demonic 34"end end;if M.VengefulRetreat:IsCastable()and M.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and D and not t and not ak()then if J(M.VengefulRetreat,nil)then a2=198793;return"vengeful_retreat normal 38"end end;if M.ThrowGlaive:IsCastable()and M.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInRange(30)and M.DemonBlades:IsAvailable()then if J(M.ThrowGlaive,nil,nil,not h:IsSpellInRange(M.ThrowGlaive))then a2=185123;return"throw_glaive normal 40"end end end;local function aA()if m()then T=g:GetEnemiesInMeleeRange(8)U=g:GetEnemiesInMeleeRange(20)V=#T;W=#U else V=1;W=1 end;if M.Detainment:IsAvailable()then Imprison=M.Imprison2 else Imprison=M.Imprison end;UnitsWithoutBWCount=an(T)UnitsWithoutSGCount=ap(T)q=HeroRotationCharDB.Toggles[6]o=HeroRotationCharDB.Toggles[4]p=HeroRotationCharDB.Toggles[5]r=HeroRotationCharDB.Toggles[12]s=not HeroRotationCharDB.Toggles[15]t=HeroRotationCharDB.Toggles[40]w=HeroRotationCharDB.Toggles[41]u=HeroRotationCharDB.Toggles[42]v=HeroRotationCharDB.Toggles[43]B=HeroRotationCharDB.Toggles[44]x=HeroRotationCharDB.Toggles[45]y=HeroRotationCharDB.Toggles[46]z=HeroRotationCharDB.Toggles[47]A=HeroRotationCharDB.Toggles[48]C=a0.Havoc.FelRushMode=="All In"or a0.Havoc.FelRushMode=="Safe"and M.Felblade:CooldownRemains(BypassRecovery)<=0 or a0.Havoc.FelRushMode=="w/ Gap Closer"and(M.Felblade:CooldownRemains(BypassRecovery)<=0 or M.Metamorphosis:CooldownRemains(BypassRecovery)<=0 and E or M.FelRush:Charges()==2 or M.TheHunt:CooldownRemains(BypassRecovery)<=0 and o)D=a0.Havoc.VengefulRetreatMode=="All In"or a0.Havoc.VengefulRetreatMode=="Safe"and M.Felblade:CooldownRemains(BypassRecovery)<=0 or a0.Havoc.VengefulRetreatMode=="w/ Gap Closer"and(M.Felblade:CooldownRemains(BypassRecovery)<=0 or M.Metamorphosis:CooldownRemains(BypassRecovery)<=0 and E or M.FelRush:CooldownRemains(BypassRecovery)<=0 or M.TheHunt:CooldownRemains(BypassRecovery)<=0 and o)E=false;F=false;if a0.Havoc.IncludedCooldowns.Metamorphosis and l.CDsON()or a0.Havoc.IncludedSmallCooldowns.Metamorphosis and(l.CDsON()or p)or not a0.Havoc.IncludedSmallCooldowns.Metamorphosis and not a0.Havoc.IncludedCooldowns.Metamorphosis then E=true end;if a0.Havoc.IncludedCooldowns.EyeBeam and l.CDsON()and not z or a0.Havoc.IncludedSmallCooldowns.EyeBeam and(l.CDsON()or p)and not z or not a0.Havoc.IncludedSmallCooldowns.EyeBeam and not a0.Havoc.IncludedCooldowns.EyeBeam and not z then F=true end;I=0;for aB=1,20 do if select(10,UnitDebuff("player",aB))==240447 then if select(6,UnitDebuff("player",aB))~=nil then I=select(6,UnitDebuff("player",aB))-GetTime()end end end;if not BotOn then a3=0;a2=0 end;if a3>0 then a3=0 end;if a2>0 then a2=0 end;a4=false;NecroPetsUpCount=ag(T)if g:IsChanneling(M.EyeBeam)then if J(M.Pool)then a2=9999;return"casting EB"end end;if w and Imprison:IsUsableP()and Imprison:CooldownRemains()<=0 and f("mouseover"):GUID()~=nil then if J(Imprison,nil,nil,nil)then a3=231;return"queue Imprison MO"end elseif w and Imprison:IsUsableP()and Imprison:CooldownRemains()<=0 and _.TargetIsValid()then if J(Imprison,nil,nil,nil)then a2=217832;return"queue Imprison"end elseif(not Imprison:IsUsableP()or Imprison:CooldownRemains()>0)and w then HeroRotationCharDB.Toggles[41]=not HeroRotationCharDB.Toggles[41]l.Print("Imprison Queue is now "..(HeroRotationCharDB.Toggles[41]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if x and M.FelEruption:IsUsableP()and M.FelEruption:CooldownRemains(BypassRecovery)<=0 and M.FelEruption:IsAvailable()and f("mouseover"):GUID()~=nil then if J(M.FelEruption,nil,nil,nil)then a3=1211881;return"queue Fel Eruption"end elseif x and M.FelEruption:IsUsableP()and M.FelEruption:CooldownRemains(BypassRecovery)<=0 and M.FelEruption:IsAvailable()and _.TargetIsValid()then if J(M.FelEruption,nil,nil,nil)then a2=211881;return"queue Fel Eruption"end elseif(not M.FelEruption:IsUsableP()and g:Fury()>10 or M.FelEruption:CooldownRemains()>0 or not M.FelEruption:IsAvailable())and x then HeroRotationCharDB.Toggles[45]=not HeroRotationCharDB.Toggles[45]l.Print("Fel Eruption Queue is now "..(HeroRotationCharDB.Toggles[45]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if y and M.ChaosNova:IsUsableP()and M.ChaosNova:CooldownRemains(BypassRecovery)<=0 then if J(M.ChaosNova,nil,nil,nil)then a2=179057;return"queue Chaos Nova MO"end elseif(not M.ChaosNova:IsUsableP()and g:Fury()>30 or M.ChaosNova:CooldownRemains()>0 or not _.TargetIsValid())and y then HeroRotationCharDB.Toggles[46]=not HeroRotationCharDB.Toggles[46]l.Print("ChaosNova Queue is now "..(HeroRotationCharDB.Toggles[46]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if A and M.FelRush:IsUsableP()and M.FelRush:CooldownRemains(BypassRecovery)<=0 then if J(M.FelRush,nil,nil,nil)then a2=195072;return"queue FelRush"end elseif(not M.FelRush:IsUsableP()or M.FelRush:CooldownRemains()>0)and A then HeroRotationCharDB.Toggles[48]=not HeroRotationCharDB.Toggles[48]l.Print("Fel Rush Queue is now "..(HeroRotationCharDB.Toggles[48]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if g:FuryDeficit()>=35 and not g:IsChanneling(M.EyeBeam)or not g:AffectingCombat()then a4=true end;if _.TargetIsValid()then if not g:AffectingCombat()and q then local S=aw()if S then return S end end;if not Y and not X then a6=M.FirstBlood:IsAvailable()or V>=3-ad(M.TrailofRuin:IsAvailable())end;if Y then a6=g:BuffDown(M.ChaosTheoryBuff)or M.FirstBlood:IsAvailable()and V>=2-ad(M.TrailofRuin:IsAvailable())or not M.CycleofHatred:IsAvailable()and V>=4-ad(M.TrailofRuin:IsAvailable())end;if X then a6=M.FirstBlood:IsAvailable()or(g:BuffUp(M.MetamorphosisBuff)or M.TrailofRuin:IsAvailable()or h:DebuffUp(M.EssenceBreakDebuff))and V>=3-ad(M.TrailofRuin:IsAvailable())or not M.Demonic:IsAvailable()and V>=4 end;if M.EssenceBreak:IsAvailable()and M.EssenceBreak:CooldownUp()then a6=false end;a5=not M.Demonic:IsAvailable()and(M.Metamorphosis:CooldownRemains()<6 and E)and g:FuryDeficit()>30;a7=a6 and g:Fury()<75-ad(M.FirstBlood:IsAvailable())*20;a8=M.Demonic:IsAvailable()and not M.BlindFury:IsAvailable()and(M.EyeBeam:CooldownRemains()<g:GCD()*2 and F)and g:FuryDeficit()>20;aa=M.Momentum:IsAvailable()and g:BuffDown(M.MomentumBuff)and not t;local S=_.Interrupt(10,M.Disrupt,a0.Commons.OffGCDasOffGCD.Disrupt,a1)if S then return S end;for aB=1,25 do local aC,aD,aD,aE=UnitBuff("target",aB)if aE~=nil and aE=="Magic"then if M.ConsumeMagic:IsCastable()and B and h:IsInRange(30)then if J(M.ConsumeMagic,nil)then a2=278326;return"Consume Magic"end end end end;if N.CruciformVeinripper:IsEquipped()and h:DebuffUp(M.SadisticGleeDebuff)and UnitsWithoutSGCount>0 and a0.Havoc.TargetSwap=="AutoSwap"and not r then a3=999 end;if NecroPetsUpCount>0 and M.ThrowGlaive:IsCastable()and(h:IsInRange(8)or g:HealthPercentage()<=25)then a3=21185123 end;if n()or o and g:AffectingCombat()then local S=ax()if S then return S end end;if M.Blur:IsCastable()and g:HealthPercentage()<=a0.Havoc.BlurHealthThreshold and g:AffectingCombat()then if J(M.Blur,nil)then a2=198589;return"Blur defensives (Danger)"end end;if g:HealthPercentage()<a0.Havoc.PhialHP and N.PhialofSerenity:IsReady()and N.PhialofSerenity:CooldownRemains()<=0 then if l.Cast(N.PhialofSerenity,nil)then a2=55;return"PhialofSerenity HP"end end;if g:HealthPercentage()<a0.Havoc.HealthstoneHP and N.Healthstone:IsReady()and N.Healthstone:CooldownRemains()<=0 then if l.Cast(N.Healthstone,nil)then a2=40;return"Healthstone HP"end end;if g:HealthPercentage()<a0.Havoc.HealPotHP and N.HealPot:IsReady()and N.HealPot:CooldownRemains()<=0 then if l.Cast(N.HealPot,nil)then a2=41;return"HealPot HP"end end;if M.ThrowGlaive:IsCastable()and M.VengefulRetreat:TimeSinceLastCast()>1 and g:AffectingCombat()and(g:BuffStack(M.FelBombardmentBuff)==5 and(g:BuffUp(M.ImmolationAuraBuff)or g:BuffDown(M.MetamorphosisBuff)))then if J(M.ThrowGlaive,nil,nil,not h:IsSpellInRange(M.ThrowGlaive))then a2=185123;return"throw_glaive fel_bombardment"end end;if M.Demonic:IsAvailable()and g:AffectingCombat()then local S=ay()if S then return S end end;if true and g:AffectingCombat()then local S=az()if S then return S end end end end;local function aF()end;function ReturnSpell()if a2==0 then return 0 else return a2 end end;function ReturnSpellMO()if a3==0 then return 0 else return a3 end end;function ShouldOrb()return a4 end;l.SetAPL(577,aA,aF)