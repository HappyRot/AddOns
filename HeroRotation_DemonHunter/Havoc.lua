local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=HeroRotation;local m=l.AoEON;local n=l.CDsON;local o=HeroRotationCharDB.Toggles[4]local p=HeroRotationCharDB.Toggles[5]local q=HeroRotationCharDB.Toggles[6]local r=HeroRotationCharDB.Toggles[12]local s=not HeroRotationCharDB.Toggles[15]local t=HeroRotationCharDB.Toggles[40]local u=HeroRotationCharDB.Toggles[42]local v=HeroRotationCharDB.Toggles[43]local w=HeroRotationCharDB.Toggles[41]local x=HeroRotationCharDB.Toggles[45]local y=HeroRotationCharDB.Toggles[46]local z=HeroRotationCharDB.Toggles[47]local A=HeroRotationCharDB.Toggles[48]local B=HeroRotationCharDB.Toggles[49]local C=HeroRotationCharDB.Toggles[44]local D=false;local E=false;local F=false;local G=false;local H=GetInventoryItemID("player",13)local I=GetInventoryItemID("player",14)local J=0;local K=l.Cast;local L=l.CastSuggested;local M=string.match;local N=j.DemonHunter.Havoc;local O=k.DemonHunter.Havoc;local P={O.CacheofAcquiredTreasures}local Q=g:GetEquipment()local R=k(0)local S=k(0)if Q[13]then R=k(Q[13])end;if Q[14]then S=k(Q[14])end;local T;local U,V;local W,X;local Y=g:HasLegendaryEquipped(20)local Z=g:HasLegendaryEquipped(23)local _=g:HasLegendaryEquipped(25)local a0=g:HasLegendaryEquipped(236)or g:HasUnity()and N.SinfulBrand:IsAvailable()local a1=l.Commons.Everyone;local a2={General=l.GUISettings.General,Commons=l.GUISettings.APL.DemonHunter.Commons,Havoc=l.GUISettings.APL.DemonHunter.Havoc}local a3={{N.FelEruption,"Cast Fel Eruption (Interrupt)",function()return true end},{N.ChaosNova,"Cast Chaos Nova (Interrupt)",function()return true end}}local a4=0;local a5=0;local a6=false;local a7=false;local a8=false;local a9=false;local aa=false;local ab=false;local ac=false;local ad=false;local ae=0;local af=false;local ag=g:CovenantID()d:RegisterForEvent(function()ag=g:CovenantID()end,"COVENANT_CHOSEN")d:RegisterForEvent(function()a7=false;a8=false;a9=false;aa=false;ab=false;ac=false;ad=false end,"PLAYER_REGEN_ENABLED")d:RegisterForEvent(function()Q=g:GetEquipment()R=k(0)S=k(0)if Q[13]then R=k(Q[13])end;if Q[14]then S=k(Q[14])end;Y=g:HasLegendaryEquipped(20)Z=g:HasLegendaryEquipped(23)_=g:HasLegendaryEquipped(25)a0=g:HasLegendaryEquipped(236)or g:HasUnity()and N.SinfulBrand:IsAvailable()end,"PLAYER_EQUIPMENT_CHANGED")local function ah(ai)if ai then return 1 else return 0 end end;local function aj(ai)return ai~=0 end;local function ak(al)local ak=0;if al~=nil then for am in pairs(al)do local an=al[am]if an:NPCID()==169421 or an:NPCID()==169425 or an:NPCID()==168932 or an:NPCID()==169426 or an:NPCID()==169429 or an:NPCID()==169428 or an:NPCID()==169430 then ak=ak+1 end end end;return ak end;local function ao(ap)if N.Felblade:TimeSinceLastCast()<=g:GCD()then return true elseif N.VengefulRetreat:TimeSinceLastCast()<1.0 and N.VengefulRetreat:TimeSinceLastCast()>0.25 or N.FelRush:TimeSinceLastCast()<1.0 then return false end;return ap and h:IsInMeleeRange(ap)or h:IsInMeleeRange(5)end;local function aq()return true end;local function ar(al)local as=0;if al~=nil then for am in pairs(al)do local an=al[am]if an:DebuffDown(N.BurningWoundDebuff)then as=as+1 end end end;return as end;local function at(al)local au=0;if al~=nil then for am in pairs(al)do local an=al[am]if an:DebuffDown(N.SadisticGleeDebuff)then au=au+1 end end end;return au end;local function av(aw)return aw:DebuffRemains(N.BurningWoundDebuff)end;local function ax(aw)if _ and aw:DebuffRemains(N.BurningWoundDebuff)<4 and aw:IsInRange(8)and aw:GUID()==f("mouseover"):GUID()then if N.DemonBlades:IsAvailable()then a5=1111 else a5=111 end;return true elseif _ and aw:DebuffRemains(N.BurningWoundDebuff)<4 and aw:IsInRange(8)and a2.Havoc.TargetSwap=="AutoSwap"and aw:GUID()~=h:GUID()and not r then a5=999;return true elseif _ and aw:DebuffRemains(N.BurningWoundDebuff)<4 and aw:IsInRange(8)and aw:GUID()==h:GUID()and h:IsInRange(8)then a4=162243;return true elseif _ and aw:DebuffRemains(N.BurningWoundDebuff)<4 and aw:IsInRange(8)then return true end end;local function ay(aw)return aw:DebuffRemains(N.BurningWoundDebuff)end;local function az(aw)if _ and aw:DebuffRemains(N.BurningWoundDebuff)<4 and aw:IsInRange(8)and aw:GUID()==f("mouseover"):GUID()then if N.DemonBlades:IsAvailable()then a5=1111 else a5=111 end;return true elseif _ and aw:DebuffRemains(N.BurningWoundDebuff)<4 and aw:IsInRange(8)and a2.Havoc.TargetSwap=="AutoSwap"and aw:GUID()~=h:GUID()and not r then a5=999;return true elseif _ and aw:DebuffRemains(N.BurningWoundDebuff)<4 and aw:IsInRange(8)and aw:GUID()==h:GUID()then a4=162243;return true elseif _ and aw:DebuffRemains(N.BurningWoundDebuff)<4 and aw:IsInRange(8)then return true end end;local function aA()ae=0;if R:TrinketHasStatAnyDps()and(not S:TrinketHasStatAnyDps()or R:Cooldown()>=S:Cooldown())then ae=1 end;if S:TrinketHasStatAnyDps()and(not R:TrinketHasStatAnyDps()or S:Cooldown()>=R:Cooldown())then ae=2 end;af=N.BlindFury:IsAvailable()and(Y or N.DemonBlades:IsAvailable()and not a0)if not h:IsInMeleeRange(5)and N.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and h:IsInRange(15)and N.FelRush:IsCastable()and D then if K(N.FelRush,nil,nil,not h:IsInRange(15))then a4=195072;return"fel_rush precombat 2"end end;if h:IsInMeleeRange(5)and(N.DemonsBite:IsCastable()or N.DemonBlades:IsAvailable())then if N.DemonBlades:IsAvailable()and IsCurrentSpell(6603)~=true then if K(N.DemonsBite,nil,nil,not h:IsInMeleeRange(5))then a4=1162243;return"demons_bite or demon_blades precombat 4"end else if K(N.DemonsBite,nil,nil,not h:IsInMeleeRange(5))then a4=162243;return"demons_bite or demon_blades precombat 4"end end end end;local function aB()if N.Metamorphosis:IsCastable()and F and h:IsInRange(8)and(N.Demonic:IsAvailable()and ag==2 and a0 and h:DebuffRemains(N.SinfulBrandDebuff)>8 and W<2 and(N.EyeBeam:CooldownRemains()>20 and not a8 or N.BladeDance:CooldownRemains()>g:GCD()or FightRemains<25))then if K(N.Metamorphosis,nil,nil,not h:IsInRange(40))then a4=191427;return"metamorphosis cooldown 4"end end;if N.Metamorphosis:IsCastable()and F and h:IsInRange(8)and(not N.Demonic:IsAvailable()and((N.EyeBeam:CooldownRemains()>20 or not G)and(ag~=2 or h:DebuffRemains(N.SinfulBrandDebuff)<=8 or W>1)or FightRemains<25))then if K(N.Metamorphosis,nil,nil,not h:IsInRange(40))then a4=191427;return"metamorphosis cooldown 2"end end;if N.Metamorphosis:IsCastable()and F and h:IsInRange(8)and(N.Demonic:IsAvailable()and((N.EyeBeam:CooldownRemains()>20 or not G)and(not a8 or N.BladeDance:CooldownRemains()>g:GCD())and(ag~=2 or h:DebuffRemains(N.SinfulBrandDebuff)<=8 or W>1)or FightRemains<25))then if K(N.Metamorphosis,nil,nil,not h:IsInRange(40))then a4=191427;return"metamorphosis cooldown 4"end end;if(O.PotionofPhantomFire:IsReady()or O.PotionofSpectralAgility:IsReady())and h:IsInMeleeRange(8)and l.CDsON()and s and a2.Commons.Enabled.Potions and(g:BuffRemains(N.MetamorphosisBuff)>25 or FightRemains<60)then if K(O.PotionofPhantomFire,nil,nil)then a4=4;return"potion cooldown 6"end end;local aC=g:GetUseableTrinkets(P)if O.CacheofAcquiredTreasures:IsEquippedAndReady()and l.CDsON()and(g:BuffUp(N.AcquiredAxeBuff)and(W>=1 or FightRemains<25))then if K(O.CacheofAcquiredTreasures,nil,nil)then if O.CacheofAcquiredTreasures:ID()==GetInventoryItemID("player",13)and a2.Commons.Enabled.TopTrinket then a4=20;return"cache_of_acquired_treasures cooldown 7"elseif O.CacheofAcquiredTreasures:ID()==GetInventoryItemID("player",14)and a2.Commons.Enabled.BottomTrinket then a4=25;return"cache_of_acquired_treasures cooldown 7"end end end;if R:IsReady()and R:ID()~=O.CacheofAcquiredTreasures:ID()and h:IsInRange(10)and a2.Commons.Enabled.TopTrinket and l.CDsON()and(ae==1 and(g:BuffUp(N.MetamorphosisBuff)or not N.Demonic:IsAvailable()and N.Metamorphosis:CooldownRemains()>(FightRemains>R:Cooldown()/2 and FightRemains or R:Cooldown()/2)or FightRemains<=20)or ae==2 and not S:IsReady()or ae==0)then if aC then if K(R,nil,nil)then if R:ID()==GetInventoryItemID("player",13)and a2.Commons.Enabled.TopTrinket then a4=20;return"top trinket 1"elseif R:ID()==GetInventoryItemID("player",14)and a2.Commons.Enabled.BottomTrinket then a4=25;return"bot trinket 1"end end end end;if S:IsReady()and S:ID()~=O.CacheofAcquiredTreasures:ID()and h:IsInRange(10)and a2.Commons.Enabled.BottomTrinket and l.CDsON()and(ae==2 and(g:BuffUp(N.MetamorphosisBuff)or not N.Demonic:IsAvailable()and N.Metamorphosis:CooldownRemains()>(FightRemains>S:Cooldown()/2 and FightRemains or S:Cooldown()/2)or FightRemains<=20)or ae==1 and not R:IsReady()or ae==0)then if aC then if K(S,nil,nil)then if S:ID()==GetInventoryItemID("player",13)and a2.Commons.Enabled.TopTrinket then a4=20;return"top trinket 1"elseif S:ID()==GetInventoryItemID("player",14)and a2.Commons.Enabled.BottomTrinket then a4=25;return"bot trinket 1"end end end end;if N.SinfulBrand:IsCastable()and h:IsInMeleeRange(30)and o and(h:DebuffDown(N.SinfulBrandDebuff)and(not a0 or N.EyeBeam:CooldownRemains()<=g:GCD()and g:Fury()>=30)and(N.Metamorphosis:CooldownDown()or W==1))then if K(N.SinfulBrand,nil,nil,not h:IsSpellInRange(N.SinfulBrand))then a4=317009;return"sinful_brand cooldown 12"end end;if N.TheHunt:IsCastable()and not g:IsMoving()and(J==0 or J>N.TheHunt:CastTime())and h:IsInRange(40)and o and(not N.Demonic:IsAvailable()and not ac and not a7 or g:BuffUp(N.FuriousGazeBuff))then if K(N.TheHunt,nil,nil,not h:IsSpellInRange(N.TheHunt))then a4=323639;return"the_hunt cooldown 14"end end;if N.ElysianDecree:IsCastable()and h:IsInRange(30)and o and W>0 then if K(N.ElysianDecree,nil,nil,not h:IsInRange(30))then a4=306830;return"elysian_decree cooldown 16"end end end;local function aD()if N.EyeBeam:IsReady()and not g:IsMoving()and(J==0 or J>N.EyeBeam:ExecuteTime())and G and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and N.VengefulRetreat:TimeSinceLastCast()>=1 and(a0 and W>1 and h:DebuffUp(N.SinfulBrandDebuff)and h:DebuffRemains(N.SinfulBrandDebuff)<=g:GCD())then if K(N.EyeBeam,nil,nil,not h:IsInRange(20))then a4=198013;return"eye_beam demonic 1"end end;if N.FelRush:IsCastable()and h:IsInRange(15)and N.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(N.UnboundChaos:IsAvailable()and g:BuffUp(N.UnboundChaosBuff)and N.FelRush:Charges()==2)and D then if K(N.FelRush,nil,nil)then a4=195072;return"fel_rush demonic 2"end end;if N.DeathSweep:IsReady()and N.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a8 then if K(N.DeathSweep,nil,nil,not ao(8))then a4=210152;return"death_sweep demonic 4"end end;if N.GlaiveTempest:IsReady()and h:IsInMeleeRange(8)and W>0 then if K(N.GlaiveTempest,nil,nil,not h:IsInMeleeRange(8))then a4=342817;return"glaive_tempest demonic 6"end end;if N.ThrowGlaive:IsCastable()and h:IsInMeleeRange(a2.Commons.ThrowGlaiveRange)and N.VengefulRetreat:TimeSinceLastCast()>1 and(N.SerratedGlaive:ConduitEnabled()and N.EyeBeam:CooldownRemains()<6 and g:BuffDown(N.MetamorphosisBuff)and h:DebuffDown(N.ExposedWoundDebuff))then if K(N.ThrowGlaive,nil,nil,not h:IsSpellInRange(N.ThrowGlaive))then a4=185123;return"throw_glaive demonic 8"end end;if N.EyeBeam:IsReady()and not g:IsMoving()and(J==0 or J>N.EyeBeam:ExecuteTime())and G and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and N.VengefulRetreat:TimeSinceLastCast()>=1 and(W>0 and(not af or W>1 or g:Fury()<70)and not ad)then if K(N.EyeBeam,nil,nil,not h:IsInRange(20))then a4=198013;return"eye_beam demonic 10"end end;if N.BladeDance:IsReady()and N.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and(a8 and not N.Metamorphosis:CooldownUp()and(N.EyeBeam:CooldownRemains()>5 or not G))then if K(N.BladeDance,nil,nil,not ao(8))then a4=188499;return"blade_dance demonic 12"end end;if N.ImmolationAura:IsCastable()and not u and N.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and g:BuffDown(N.ImmolationAuraBuff)then if K(N.ImmolationAura,nil,nil,not ao(8))then a4=258920;return"immolation_aura demonic 14"end end;if N.Annihilation:IsReady()and h:IsInRange(8)and h:IsInMeleeRange(8)and not a9 then if K(N.Annihilation,nil,nil,not h:IsSpellInRange(N.Annihilation))then a4=201427;return"annihilation demonic 16"end end;if N.Felblade:IsCastable()and not g:IsMoving()and not v and h:IsInRange(a2.Commons.FelBladeRange)and(h:IsInRange(8)or not t)and g:FuryDeficit()>=40 and(not ao()or N.VengefulRetreat:TimeSinceLastCast()>=1.0)then if K(N.Felblade,nil,nil,not h:IsSpellInRange(N.Felblade))then a4=183226;return"felblade demonic 18"end end;if N.EssenceBreak:IsCastable()and h:IsInMeleeRange(10)and N.VengefulRetreat:TimeSinceLastCast()>1 then if K(N.EssenceBreak,nil,nil,not ao(10))then a4=258860;return"essence_break demonic 20"end end;if N.ChaosStrike:IsReady()and h:IsInMeleeRange(8)and(not a9 and not aa)then if K(N.ChaosStrike,nil,nil,not h:IsSpellInRange(N.ChaosStrike))then a4=162794;return"chaos_strike demonic 22"end end;if N.FelRush:IsCastable()and h:IsInRange(15)and N.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(N.DemonBlades:IsAvailable()and not N.EyeBeam:CooldownUp()and aq())and D then if K(N.FelRush,nil,nil)then a4=195072;return"fel_rush demonic 24"end end;if N.DemonsBite:IsCastable()or N.DemonBlades:IsAvailable()then if _ and not N.DemonBlades:IsAvailable()and(h:DebuffRemains(N.BurningWoundDebuff)<4 or(UnitsWithoutBWCount==0 or not m()))then if K(N.DemonsBite,nil,nil,not h:IsSpellInRange(N.DemonsBite))then a4=162243;return"demons_bite 26T"end end;if a1.CastTargetIf(N.DemonsBite,U,"min",ay,az)then return"demons_bite demonic 26"end end;if N.FelRush:IsCastable()and h:IsInRange(15)and N.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not N.DemonBlades:IsAvailable()and W>1 and N.FelRush:Charges()==2)and D then if K(N.FelRush,nil,nil)then a4=195072;return"fel_rush demonic 28"end end;if N.DemonsBite:IsCastable()and not N.DemonBlades:IsAvailable()and h:IsInMeleeRange(8)and not _ then if K(N.DemonsBite,nil,nil,not h:IsSpellInRange(N.DemonsBite))then a4=162243;return"demons_bite demonic 30"end end;if N.ThrowGlaive:IsCastable()and h:IsInRange(a2.Commons.ThrowGlaiveRange)and not ao()then if K(N.ThrowGlaive,nil,nil,not h:IsSpellInRange(N.ThrowGlaive))then a4=185123;return"throw_glaive demonic 32"end end;if N.FelRush:IsCastable()and h:IsInRange(15)and N.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not ao()and aq())and D then if K(N.FelRush,nil,nil)then a4=195072;return"fel_rush demonic 34"end end;if N.VengefulRetreat:IsCastable()and N.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and E and not t and not ao()then if K(N.VengefulRetreat,nil)then a4=198793;return"vengeful_retreat demonic 36"end end;if N.ThrowGlaive:IsCastable()and h:IsInRange(a2.Commons.ThrowGlaiveRange)and N.DemonBlades:IsAvailable()then if K(N.ThrowGlaive,nil,nil,not h:IsSpellInRange(N.ThrowGlaive))then a4=185123;return"throw_glaive demonic 38"end end end;local function aE()if N.EyeBeam:IsReady()and not g:IsMoving()and(J==0 or J>N.EyeBeam:ExecuteTime())and G and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and N.VengefulRetreat:TimeSinceLastCast()>=1 and(a0 and W>1 and h:DebuffUp(N.SinfulBrandDebuff)and h:DebuffRemains(N.SinfulBrandDebuff)<=g:GCD())then if K(N.EyeBeam,nil,nil,not h:IsInRange(20))then a4=198013;return"eye_beam normal 1"end end;if N.VengefulRetreat:IsCastable()and N.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and E and not t and(N.Momentum:IsAvailable()and g:BuffDown(N.PreparedBuff)and d.CombatTime()>1)then if K(N.VengefulRetreat,nil)then a4=198793;return"vengeful_retreat normal 2"end end;if N.FelRush:IsCastable()and h:IsInRange(15)and N.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and((g:BuffUp(N.UnboundChaosBuff)or ac and(not N.UnboundChaos:IsAvailable()or not N.ImmolationAura:CooldownUp()))and aq())and D then if K(N.FelRush,nil,nil)then a4=195072;return"fel_rush demonic 34"end end;if N.FelBarrage:IsCastable()and N.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and W>1 then if K(N.FelBarrage,nil,nil,not ao(8))then a4=211053;return"fel_barrage normal 6"end end;if N.DeathSweep:IsReady()and N.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a8 then if K(N.DeathSweep,nil,nil,not ao(8))then a4=210152;return"death_sweep normal 8"end end;if N.ImmolationAura:IsCastable()and not u and N.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and g:BuffDown(N.ImmolationAuraBuff)then if K(N.ImmolationAura,nil,nil,not ao(8))then a4=258920;return"immolation_aura normal 10"end end;if N.GlaiveTempest:IsReady()and N.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and(not ac and W>0)then if K(N.GlaiveTempest,nil)then a4=342817;return"glaive_tempest normal 12"end end;if N.ThrowGlaive:IsCastable()and N.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInRange(a2.Commons.ThrowGlaiveRange)and(N.SerratedGlaive:ConduitEnabled()and N.EyeBeam:CooldownRemains()<6 and g:BuffDown(N.MetamorphosisBuff)and h:DebuffDown(N.ExposedWoundDebuff))then if K(N.ThrowGlaive,nil,nil,not h:IsSpellInRange(N.ThrowGlaive))then a4=185123;return"throw_glaive normal 14"end end;if N.EyeBeam:IsReady()and not g:IsMoving()and(J==0 or J>N.EyeBeam:ExecuteTime())and G and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and N.VengefulRetreat:TimeSinceLastCast()>=1 and(not ac and(X>0 and(not af or W>1 or g:Fury()<70)and not ad))then if K(N.EyeBeam,nil,nil,not ao(20))then a4=198013;return"eye_beam normal 16"end end;if N.BladeDance:IsReady()and N.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a8 then if K(N.BladeDance,nil,nil,not ao(8))then a4=188499;return"blade_dance normal 18"end end;if N.Felblade:IsCastable()and not g:IsMoving()and not v and h:IsInRange(a2.Commons.FelBladeRange)and(h:IsInRange(8)or not t)and g:FuryDeficit()>=40 and(not ao()or N.VengefulRetreat:TimeSinceLastCast()>=1.0)then if K(N.Felblade,nil,nil,not h:IsSpellInRange(N.Felblade))then a4=183226;return"felblade normal 20"end end;if N.EssenceBreak:IsCastable()and h:IsInMeleeRange(10)and N.VengefulRetreat:TimeSinceLastCast()>1 then if K(N.EssenceBreak,nil,nil,not ao(10))then a4=258860;return"essence_break normal 22"end end;if N.Annihilation:IsReady()and N.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and((N.DemonBlades:IsAvailable()or not ac or g:FuryDeficit()<30 or g:BuffRemains(N.MetamorphosisBuff)<5)and not a9)then if K(N.Annihilation,nil,nil,not h:IsSpellInRange(N.Annihilation))then a4=201427;return"annihilation normal 24"end end;if N.ChaosStrike:IsReady()and N.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and((N.DemonBlades:IsAvailable()or not ac or g:FuryDeficit()<30)and not a7 and not a9)then if K(N.ChaosStrike,nil,nil,not h:IsSpellInRange(N.ChaosStrike))then a4=162794;return"chaos_strike normal 26"end end;if N.EyeBeam:IsReady()and not g:IsMoving()and(J==0 or J>N.EyeBeam:ExecuteTime())and G and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and(N.BlindFury:IsAvailable()and not ad)then if K(N.EyeBeam,nil,nil,not h:IsInRange(20))then a4=198013;return"eye_beam normal 28"end end;if(N.DemonsBite:IsCastable()or N.DemonBlades:IsAvailable())and N.VengefulRetreat:TimeSinceLastCast()>1 then if _ and not N.DemonBlades:IsAvailable()and(h:DebuffRemains(N.BurningWoundDebuff)<4 or(UnitsWithoutBWCount==0 or not m()))then if K(N.DemonsBite,nil,nil,not h:IsSpellInRange(N.DemonsBite))then a4=162243;return"demons_bite 26T"end end;if a1.CastTargetIf(N.DemonsBite,U,"min",av,ax)then return"demons_bite normal 28"end end;if N.DemonsBite:IsCastable()and not N.DemonBlades:IsAvailable()and N.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and not _ then if K(N.DemonsBite,nil,nil,not h:IsSpellInRange(N.DemonsBite))then a4=162243;return"demons_bite normal 30"end end;if N.FelRush:IsCastable()and h:IsInRange(15)and N.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not N.Momentum:IsAvailable()and N.DemonBlades:IsAvailable()and aq())and D then if K(N.FelRush,nil,nil)then a4=195072;return"fel_rush demonic 34"end end;if N.Felblade:IsCastable()and not g:IsMoving()and not v and h:IsInRange(a2.Commons.FelBladeRange)and(not ao()and not t)then if K(N.Felblade,nil,nil,not h:IsSpellInRange(N.Felblade))then a4=183226;return"felblade normal 34"end end;if N.FelRush:IsCastable()and h:IsInRange(15)and N.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not ao()and not N.Momentum:IsAvailable()and aq())and D then if K(N.FelRush,nil,nil)then a4=195072;return"fel_rush demonic 34"end end;if N.VengefulRetreat:IsCastable()and N.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and E and not t and not ao()then if K(N.VengefulRetreat,nil)then a4=198793;return"vengeful_retreat normal 38"end end;if N.ThrowGlaive:IsCastable()and N.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInRange(a2.Commons.ThrowGlaiveRange)and N.DemonBlades:IsAvailable()then if K(N.ThrowGlaive,nil,nil,not h:IsSpellInRange(N.ThrowGlaive))then a4=185123;return"throw_glaive normal 40"end end end;local function aF()if m()then U=g:GetEnemiesInMeleeRange(8)V=g:GetEnemiesInMeleeRange(20)W=#U;X=#V else W=1;X=1 end;if N.Detainment:IsAvailable()then Imprison=N.Imprison2 else Imprison=N.Imprison end;UnitsWithoutBWCount=ar(U)UnitsWithoutSGCount=at(U)q=HeroRotationCharDB.Toggles[6]o=HeroRotationCharDB.Toggles[4]p=HeroRotationCharDB.Toggles[5]r=HeroRotationCharDB.Toggles[12]s=not HeroRotationCharDB.Toggles[15]t=HeroRotationCharDB.Toggles[40]w=HeroRotationCharDB.Toggles[41]u=HeroRotationCharDB.Toggles[42]v=HeroRotationCharDB.Toggles[43]C=HeroRotationCharDB.Toggles[44]x=HeroRotationCharDB.Toggles[45]y=HeroRotationCharDB.Toggles[46]z=HeroRotationCharDB.Toggles[47]A=HeroRotationCharDB.Toggles[48]B=HeroRotationCharDB.Toggles[49]D=a2.Havoc.FelRushMode=="All In"or a2.Havoc.FelRushMode=="Safe"and N.Felblade:CooldownRemains(BypassRecovery)<=0 or a2.Havoc.FelRushMode=="w/ Gap Closer"and(N.Felblade:CooldownRemains(BypassRecovery)<=0 or N.Metamorphosis:CooldownRemains(BypassRecovery)<=0 and F or N.FelRush:Charges()==2 or N.TheHunt:CooldownRemains(BypassRecovery)<=0 and o)E=a2.Havoc.VengefulRetreatMode=="All In"or a2.Havoc.VengefulRetreatMode=="Safe"and N.Felblade:CooldownRemains(BypassRecovery)<=0 or a2.Havoc.VengefulRetreatMode=="w/ Gap Closer"and(N.Felblade:CooldownRemains(BypassRecovery)<=0 or N.Metamorphosis:CooldownRemains(BypassRecovery)<=0 and F or N.FelRush:CooldownRemains(BypassRecovery)<=0 or N.TheHunt:CooldownRemains(BypassRecovery)<=0 and o)F=false;G=false;if a2.Havoc.IncludedCooldowns.Metamorphosis and l.CDsON()or a2.Havoc.IncludedSmallCooldowns.Metamorphosis and(l.CDsON()or p)or not a2.Havoc.IncludedSmallCooldowns.Metamorphosis and not a2.Havoc.IncludedCooldowns.Metamorphosis then F=true end;if a2.Havoc.IncludedCooldowns.EyeBeam and l.CDsON()and not z or a2.Havoc.IncludedSmallCooldowns.EyeBeam and(l.CDsON()or p)and not z or not a2.Havoc.IncludedSmallCooldowns.EyeBeam and not a2.Havoc.IncludedCooldowns.EyeBeam and not z then G=true end;J=0;for aG=1,20 do if select(10,UnitDebuff("player",aG))==240447 then if select(6,UnitDebuff("player",aG))~=nil then J=select(6,UnitDebuff("player",aG))-GetTime()end end end;FightRemains=d.FightRemains(U,false)if not BotOn then a5=0;a4=0 end;if a5>0 then a5=0 end;if a4>0 then a4=0 end;a6=false;NecroPetsUpCount=ak(U)if g:IsChanneling(N.EyeBeam)then if K(N.Pool)then a4=9999;return"casting EB"end end;if w and Imprison:IsUsableP()and Imprison:CooldownRemains()<=0 and f("mouseover"):GUID()~=nil then if K(Imprison,nil,nil,nil)then a5=231;return"queue Imprison MO"end elseif w and Imprison:IsUsableP()and Imprison:CooldownRemains()<=0 and a1.TargetIsValid()then if K(Imprison,nil,nil,nil)then a4=217832;return"queue Imprison"end elseif(not Imprison:IsUsableP()or Imprison:CooldownRemains()>0)and w then HeroRotationCharDB.Toggles[41]=not HeroRotationCharDB.Toggles[41]l.Print("Imprison Queue is now "..(HeroRotationCharDB.Toggles[41]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if x and N.FelEruption:IsUsableP()and N.FelEruption:CooldownRemains(BypassRecovery)<=0 and N.FelEruption:IsAvailable()and f("mouseover"):GUID()~=nil then if K(N.FelEruption,nil,nil,nil)then a5=1211881;return"queue Fel Eruption"end elseif x and N.FelEruption:IsUsableP()and N.FelEruption:CooldownRemains(BypassRecovery)<=0 and N.FelEruption:IsAvailable()and a1.TargetIsValid()then if K(N.FelEruption,nil,nil,nil)then a4=211881;return"queue Fel Eruption"end elseif(not N.FelEruption:IsUsableP()and g:Fury()>10 or N.FelEruption:CooldownRemains()>0 or not N.FelEruption:IsAvailable())and x then HeroRotationCharDB.Toggles[45]=not HeroRotationCharDB.Toggles[45]l.Print("Fel Eruption Queue is now "..(HeroRotationCharDB.Toggles[45]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if y and N.ChaosNova:IsUsableP()and N.ChaosNova:CooldownRemains(BypassRecovery)<=0 then if K(N.ChaosNova,nil,nil,nil)then a4=179057;return"queue Chaos Nova MO"end elseif(not N.ChaosNova:IsUsableP()and g:Fury()>30 or N.ChaosNova:CooldownRemains()>0 or not a1.TargetIsValid())and y then HeroRotationCharDB.Toggles[46]=not HeroRotationCharDB.Toggles[46]l.Print("ChaosNova Queue is now "..(HeroRotationCharDB.Toggles[46]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if A and N.FelRush:IsUsableP()and N.FelRush:CooldownRemains(BypassRecovery)<=0 then if K(N.FelRush,nil,nil,nil)then a4=195072;return"queue FelRush"end elseif(not N.FelRush:IsUsableP()or N.FelRush:CooldownRemains()>0)and A then HeroRotationCharDB.Toggles[48]=not HeroRotationCharDB.Toggles[48]l.Print("Fel Rush Queue is now "..(HeroRotationCharDB.Toggles[48]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if B and N.Darkness:IsUsableP()and N.Darkness:CooldownRemains(BypassRecovery)<=0 then if K(N.Darkness,nil,nil,nil)then a4=196718;return"queue FelRush"end elseif(not N.Darkness:IsUsableP()or N.Darkness:CooldownRemains()>0)and B then HeroRotationCharDB.Toggles[49]=not HeroRotationCharDB.Toggles[49]l.Print("Darkness Queue is now "..(HeroRotationCharDB.Toggles[49]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if g:FuryDeficit()>=35 and not g:IsChanneling(N.EyeBeam)or not g:AffectingCombat()then a6=true end;if a1.TargetIsValid()then if not g:AffectingCombat()and q then local T=aA()if T then return T end end;if not Z and not Y then a8=N.FirstBlood:IsAvailable()or W>=3-ah(N.TrailofRuin:IsAvailable())end;if Z then a8=g:BuffDown(N.ChaosTheoryBuff)or N.FirstBlood:IsAvailable()and W>=2-ah(N.TrailofRuin:IsAvailable())or not N.CycleofHatred:IsAvailable()and W>=4-ah(N.TrailofRuin:IsAvailable())end;if Y then a8=N.FirstBlood:IsAvailable()or(g:BuffUp(N.MetamorphosisBuff)or N.TrailofRuin:IsAvailable()or h:DebuffUp(N.EssenceBreakDebuff))and W>=3-ah(N.TrailofRuin:IsAvailable())or not N.Demonic:IsAvailable()and W>=4 end;if N.EssenceBreak:IsAvailable()and N.EssenceBreak:CooldownUp()then a8=false end;if a0 and N.CycleofHatred:IsAvailable()then a8=a8 and N.SinfulBrandDebuff:AuraActiveCount()<2 end;a7=not N.Demonic:IsAvailable()and N.Metamorphosis:CooldownRemains()<6 and g:FuryDeficit()>30;a9=a8 and g:Fury()<75-ah(N.FirstBlood:IsAvailable())*20;aa=N.Demonic:IsAvailable()and not N.BlindFury:IsAvailable()and N.EyeBeam:CooldownRemains()<g:GCD()*2 and g:FuryDeficit()>20;ac=N.Momentum:IsAvailable()and g:BuffDown(N.MomentumBuff)if a0 then ad=h:DebuffDown(N.SinfulBrandDebuff)and N.SinfulBrand:CooldownRemains()<g:GCD()*4 and(N.Metamorphosis:CooldownDown()or W==1)and X<=3 end;local T=a1.Interrupt(10,N.Disrupt,a2.Commons.OffGCDasOffGCD.Disrupt,a3)if T then return T end;for aG=1,25 do local aH,aI,aI,aJ=UnitBuff("target",aG)if aJ~=nil and aJ=="Magic"then if N.ConsumeMagic:IsCastable()and C and h:IsInRange(30)then if K(N.ConsumeMagic,nil)then a4=278326;return"Consume Magic"end end end end;if O.CruciformVeinripper:IsEquipped()and h:DebuffUp(N.SadisticGleeDebuff)and UnitsWithoutSGCount>0 and a2.Havoc.TargetSwap=="AutoSwap"and not r then a5=999 end;if NecroPetsUpCount>0 and N.ThrowGlaive:IsCastable()and(h:IsInRange(8)or g:HealthPercentage()<=25)then a5=21185123 end;if n()or o and g:AffectingCombat()then local T=aB()if T then return T end end;if N.Blur:IsCastable()and g:HealthPercentage()<=a2.Havoc.BlurHealthThreshold and g:AffectingCombat()then if K(N.Blur,nil)then a4=198589;return"Blur defensives (Danger)"end end;if g:HealthPercentage()<a2.Havoc.PhialHP and O.PhialofSerenity:IsReady()and O.PhialofSerenity:CooldownRemains()<=0 then if l.Cast(O.PhialofSerenity,nil)then a4=55;return"PhialofSerenity HP"end end;if g:HealthPercentage()<a2.Havoc.HealthstoneHP and O.Healthstone:IsReady()and O.Healthstone:CooldownRemains()<=0 then if l.Cast(O.Healthstone,nil)then a4=40;return"Healthstone HP"end end;if g:HealthPercentage()<a2.Havoc.HealPotHP and O.HealPot:IsReady()and O.HealPot:CooldownRemains()<=0 then if l.Cast(O.HealPot,nil)then a4=41;return"HealPot HP"end end;if N.ThrowGlaive:IsCastable()and h:IsInMeleeRange(a2.Commons.ThrowGlaiveRange)and N.VengefulRetreat:TimeSinceLastCast()>1 and g:AffectingCombat()and(g:BuffStack(N.FelBombardmentBuff)==5 and(g:BuffUp(N.ImmolationAuraBuff)or g:BuffDown(N.MetamorphosisBuff)))then if K(N.ThrowGlaive,nil,nil,not h:IsSpellInRange(N.ThrowGlaive))then a4=185123;return"throw_glaive fel_bombardment"end end;if N.Demonic:IsAvailable()and g:AffectingCombat()then local T=aD()if T then return T end end;if true and not N.Demonic:IsAvailable()then local T=aE()if T then return T end end end end;local function aK()N.SinfulBrandDebuff:RegisterAuraTracking()end;function ReturnSpell()if a4==0 then return 0 else return a4 end end;function ReturnSpellMO()if a5==0 then return 0 else return a5 end end;function ShouldOrb()return a6 end;l.SetAPL(577,aF,aK)