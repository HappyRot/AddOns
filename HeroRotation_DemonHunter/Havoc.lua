local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=HeroRotation;local m=l.AoEON;local n=l.CDsON;local o=HeroRotationCharDB.Toggles[4]local p=HeroRotationCharDB.Toggles[5]local q=HeroRotationCharDB.Toggles[6]local r=HeroRotationCharDB.Toggles[12]local s=HeroRotationCharDB.Toggles[15]local t=HeroRotationCharDB.Toggles[40]local u=HeroRotationCharDB.Toggles[41]local v=false;local w=false;local x=false;local y=false;local z=l.Cast;local A=l.CastSuggested;local B=string.match;local C=j.DemonHunter.Havoc;local D=k.DemonHunter.Havoc;local E={}local F=g:GetEquipment()local G=k(0)local H=k(0)local I,J=GetInventoryItemID("player",13)local K,J=GetInventoryItemID("player",14)if F[13]then G=k(F[13])end;if F[14]then H=k(F[14])end;local L;local M,N;local O,P;local Q=g:HasLegendaryEquipped(20)local R=g:HasLegendaryEquipped(23)local S=g:HasLegendaryEquipped(25)local T=l.Commons.Everyone;local U={General=l.GUISettings.General,Commons=l.GUISettings.APL.DemonHunter.Commons,Havoc=l.GUISettings.APL.DemonHunter.Havoc}local V={{C.FelEruption,"Cast Fel Eruption (Interrupt)",function()return true end},{C.ChaosNova,"Cast Chaos Nova (Interrupt)",function()return true end}}local W=0;local X=0;local Y=false;local Z=false;local _=false;local a0=false;local a1=false;local a2=false;local a3=false;local a4=0;local a5=false;d:RegisterForEvent(function()Z=false;_=false;a0=false;a1=false;a2=false;a3=false end,"PLAYER_REGEN_ENABLED")d:RegisterForEvent(function()F=g:GetEquipment()G=k(0)H=k(0)if F[13]then G=k(F[13])end;if F[14]then H=k(F[14])end;Q=g:HasLegendaryEquipped(20)R=g:HasLegendaryEquipped(23)S=g:HasLegendaryEquipped(25)end,"PLAYER_EQUIPMENT_CHANGED")local function a6(a7)if a7 then return 1 else return 0 end end;local function a8(a7)return a7~=0 end;local function a9(aa)if C.Felblade:TimeSinceLastCast()<=g:GCD()then return true elseif C.VengefulRetreat:TimeSinceLastCast()<1.0 and C.VengefulRetreat:TimeSinceLastCast()>0.25 or C.FelRush:TimeSinceLastCast()<1.0 then return false end;return aa and h:IsInMeleeRange(aa)or h:IsInMeleeRange(5)end;local function ab()return true end;local function ac(ad)return ad:DebuffRemains(C.BurningWoundDebuff)end;local function ae(ad)if S and ad:DebuffRemains(C.BurningWoundDebuff)<4 and ad:IsInRange(8)and ad:GUID()==f("mouseover"):GUID()and U.Unholy.TargetSwap=="Mouseover"then X=111;return true elseif S and ad:DebuffRemains(C.BurningWoundDebuff)<4 and ad:IsInRange(8)and U.Havoc.TargetSwap=="AutoSwap"and ad:GUID()~=h:GUID()and not r then X=999;return true elseif S and ad:DebuffRemains(C.BurningWoundDebuff)<4 and ad:GUID()==h:GUID()and h:IsInRange(8)then W=1;return true elseif S and ad:DebuffRemains(C.BurningWoundDebuff)<4 then return true end end;local function af(ad)return ad:DebuffRemains(C.BurningWoundDebuff)end;local function ag(ad)if S and ad:DebuffRemains(C.BurningWoundDebuff)<4 and ad:IsInRange(8)and ad:GUID()==f("mouseover"):GUID()and U.Unholy.TargetSwap=="Mouseover"then X=111;return true elseif S and ad:DebuffRemains(C.BurningWoundDebuff)<4 and ad:IsInRange(8)and U.Havoc.TargetSwap=="AutoSwap"and ad:GUID()~=h:GUID()and not r then X=999;return true elseif S and ad:DebuffRemains(C.BurningWoundDebuff)<4 and ad:IsInRange(8)and ad:GUID()==h:GUID()then W=1;return true elseif S and ad:DebuffRemains(C.BurningWoundDebuff)<4 then return true end end;local function ah()if G:TrinketHasStatAnyDps()and not H:TrinketHasStatAnyDps()then a4=1 end;if H:TrinketHasStatAnyDps()and not G:TrinketHasStatAnyDps()then a4=2 end;if G:TrinketHasStatAnyDps()and H:TrinketHasStatAnyDps()or not(G:TrinketHasStatAnyDps()and H:TrinketHasStatAnyDps())then a4=0 end;a5=C.BlindFury:IsAvailable()and(Q or C.DemonBlades:IsAvailable())if not h:IsInMeleeRange(5)and C.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and h:IsInRange(15)and C.FelRush:IsCastable()and v then if z(C.FelRush,nil,nil,not h:IsInRange(15))then W=195072;return"fel_rush precombat 2"end end;if h:IsInMeleeRange(5)and(C.DemonsBite:IsCastable()or C.DemonBlades:IsAvailable())then if z(C.DemonsBite,nil,nil,not h:IsInMeleeRange(5))then W=162243;return"demons_bite or demon_blades precombat 4"end end end;local function ai()if C.Metamorphosis:IsCastable()and x and h:IsInRange(8)and(not C.Demonic:IsAvailable()and(C.EyeBeam:CooldownRemains()>20 or not y)and(not C.SinfulBrand:IsAvailable()or h:DebuffDown(C.SinfulBrandDebuff))or d.BossFilteredFightRemains("<",25))then if z(C.Metamorphosis,nil,nil,not h:IsInRange(40))then W=191427;return"metamorphosis cooldown 2"end end;if C.Metamorphosis:IsCastable()and x and h:IsInRange(8)and(C.Demonic:IsAvailable()and((C.EyeBeam:CooldownRemains()>20 or not y)and(not _ or C.BladeDance:CooldownRemains()>g:GCD()))and(not C.SinfulBrand:IsAvailable()or h:DebuffDown(C.SinfulBrandDebuff))or d.BossFilteredFightRemains("<",25))then if z(C.Metamorphosis,nil,nil,not h:IsInRange(40))then W=191427;return"metamorphosis cooldown 4"end end;if(D.PotionofPhantomFire:IsReady()or D.PotionofSpectralAgility:IsReady())and h:IsInMeleeRange(8)and l.CDsON()and s and U.Commons.Enabled.Potions and(g:BuffRemains(C.MetamorphosisBuff)>25 or d.BossFilteredFightRemains("<",60))then if z(D.PotionofPhantomFire,nil,nil)then W=4;return"potion cooldown 6"end end;if G:IsReady()and h:IsInRange(10)and U.Commons.Enabled.TopTrinket and l.CDsON()and(a4==1 and(g:BuffUp(C.MetamorphosisBuff)or not C.Demonic:IsAvailable()and(C.Metamorphosis:CooldownRemains()>d.FightRemains(N)or not x)or d.BossFilteredFightRemains("<=",20))or a4==2 and not H:IsReady()or a4==0)then if z(G,nil,nil)then if G:ID()==I then W=20;return"top trinket 1"elseif G:ID()==K then W=25;return"bot trinket 1"end end end;if H:IsReady()and h:IsInRange(10)and U.Commons.Enabled.BottomTrinket and l.CDsON()and(a4==2 and(g:BuffUp(C.MetamorphosisBuff)or not C.Demonic:IsAvailable()and(C.Metamorphosis:CooldownRemains()>d.FightRemains(N)or not x)or d.BossFilteredFightRemains("<=",20))or a4==1 and not G:IsReady()or a4==0)then if z(H,nil,nil)then if H:ID()==I then W=20;return"top trinket 1"elseif H:ID()==K then W=25;return"bot trinket 1"end end end;if C.SinfulBrand:IsCastable()and h:IsInMeleeRange(30)and o and h:DebuffDown(C.SinfulBrandDebuff)then if z(C.SinfulBrand,nil,nil,not h:IsSpellInRange(C.SinfulBrand))then W=317009;return"sinful_brand cooldown 12"end end;if C.TheHunt:IsCastable()and h:IsInRange(40)and o and(not C.Demonic:IsAvailable()and not a3 and not Z or g:BuffUp(C.FuriousGazeBuff))then if z(C.TheHunt,nil,nil,not h:IsSpellInRange(C.TheHunt))then W=323639;return"the_hunt cooldown 14"end end;if C.ElysianDecree:IsCastable()and h:IsInRange(30)and o and O>0 then if z(C.ElysianDecree,nil,nil,not h:IsInRange(30))then W=306830;return"elysian_decree cooldown 16"end end end;local function aj()if C.FelRush:IsCastable()and h:IsInRange(15)and C.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(C.UnboundChaos:IsAvailable()and g:BuffUp(C.UnboundChaosBuff)and C.FelRush:Charges()==2)and v then if z(C.FelRush,nil,nil)then W=195072;return"fel_rush demonic 2"end end;if C.DeathSweep:IsReady()and C.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and _ then if z(C.DeathSweep,nil,nil,not a9(8))then W=210152;return"death_sweep demonic 4"end end;if C.GlaiveTempest:IsReady()and h:IsInMeleeRange(8)and O>0 then if z(C.GlaiveTempest,nil,nil,not h:IsInMeleeRange(8))then W=342817;return"glaive_tempest demonic 6"end end;if C.ThrowGlaive:IsCastable()and h:IsInMeleeRange(30)and C.VengefulRetreat:TimeSinceLastCast()>1 and(C.SerratedGlaive:ConduitEnabled()and(C.EyeBeam:CooldownRemains()<6 and y)and g:BuffDown(C.MetamorphosisBuff)and h:DebuffDown(C.ExposedWoundDebuff))then if z(C.ThrowGlaive,nil,nil,not h:IsSpellInRange(C.ThrowGlaive))then W=185123;return"throw_glaive demonic 8"end end;if C.EyeBeam:IsReady()and y and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and C.VengefulRetreat:TimeSinceLastCast()>=1 and(O>0 and(not a5 or O>1 or g:Fury()<70))then if z(C.EyeBeam,nil,nil,not h:IsInRange(20))then W=198013;return"eye_beam demonic 10"end end;if C.BladeDance:IsReady()and C.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and(_ and not C.Metamorphosis:CooldownUp()and(C.EyeBeam:CooldownRemains()>5 or not y))then if z(C.BladeDance,nil,nil,not a9(8))then W=188499;return"blade_dance demonic 12"end end;if C.ImmolationAura:IsCastable()and C.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and g:BuffDown(C.ImmolationAuraBuff)then if z(C.ImmolationAura,nil,nil,not a9(8))then W=258920;return"immolation_aura demonic 14"end end;if C.Annihilation:IsReady()and h:IsInRange(8)and h:IsInMeleeRange(8)and not a0 then if z(C.Annihilation,nil,nil,not h:IsSpellInRange(C.Annihilation))then W=201427;return"annihilation demonic 16"end end;if C.Felblade:IsCastable()and h:IsInRange(15)and g:FuryDeficit()>=40 and(not a9()or C.VengefulRetreat:TimeSinceLastCast()>=1.0)then if z(C.Felblade,nil,nil,not h:IsSpellInRange(C.Felblade))then W=183226;return"felblade demonic 18"end end;if C.EssenceBreak:IsCastable()and h:IsInMeleeRange(10)and C.VengefulRetreat:TimeSinceLastCast()>1 then if z(C.EssenceBreak,nil,nil,not a9(10))then W=258860;return"essence_break demonic 20"end end;if C.ChaosStrike:IsReady()and h:IsInMeleeRange(8)and(not a0 and not a1)then if z(C.ChaosStrike,nil,nil,not h:IsSpellInRange(C.ChaosStrike))then W=162794;return"chaos_strike demonic 22"end end;if C.FelRush:IsCastable()and h:IsInRange(15)and C.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(C.DemonBlades:IsAvailable()and not C.EyeBeam:CooldownUp()and ab())and v then if z(C.FelRush,nil,nil)then W=195072;return"fel_rush demonic 24"end end;if C.DemonsBite:IsCastable()then if T.CastTargetIf(C.DemonsBite,M,"min",af,ag,not h:IsSpellInRange(C.DemonsBite))then return"demons_bite demonic 26"end end;if C.FelRush:IsCastable()and h:IsInRange(15)and C.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not C.DemonBlades:IsAvailable()and O>1 and C.FelRush:Charges()==2)and v then if z(C.FelRush,nil,nil)then W=195072;return"fel_rush demonic 28"end end;if C.DemonsBite:IsCastable()and h:IsInMeleeRange(8)then if z(C.DemonsBite,nil,nil,not h:IsSpellInRange(C.DemonsBite))then W=162243;return"demons_bite demonic 30"end end;if C.ThrowGlaive:IsCastable()and h:IsInRange(30)and not a9()then if z(C.ThrowGlaive,nil,nil,not h:IsSpellInRange(C.ThrowGlaive))then W=185123;return"throw_glaive demonic 32"end end;if C.FelRush:IsCastable()and h:IsInRange(15)and C.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not a9()and ab())and v then if z(C.FelRush,nil,nil)then W=195072;return"fel_rush demonic 34"end end;if C.VengefulRetreat:IsCastable()and C.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and w and not t and not a9()then if z(C.VengefulRetreat,nil)then W=198793;return"vengeful_retreat demonic 36"end end;if C.ThrowGlaive:IsCastable()and h:IsInRange(30)and C.DemonBlades:IsAvailable()then if z(C.ThrowGlaive,nil,nil,not h:IsSpellInRange(C.ThrowGlaive))then W=185123;return"throw_glaive demonic 38"end end end;local function ak()if C.VengefulRetreat:IsCastable()and C.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and w and not t and(C.Momentum:IsAvailable()and g:BuffDown(C.PreparedBuff)and d.CombatTime()>1)then if z(C.VengefulRetreat,nil)then W=198793;return"vengeful_retreat normal 2"end end;if C.FelRush:IsCastable()and h:IsInRange(15)and C.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and((g:BuffUp(C.UnboundChaosBuff)or a3 and(not C.UnboundChaos:IsAvailable()or not C.ImmolationAura:CooldownUp()))and ab())and v then if z(C.FelRush,nil,nil)then W=195072;return"fel_rush demonic 34"end end;if C.FelBarrage:IsCastable()and C.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and O>1 then if z(C.FelBarrage,nil,nil,not a9(8))then W=211053;return"fel_barrage normal 6"end end;if C.DeathSweep:IsReady()and C.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and _ then if z(C.DeathSweep,nil,nil,not a9(8))then W=210152;return"death_sweep normal 8"end end;if C.ImmolationAura:IsCastable()and C.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and g:BuffDown(C.ImmolationAuraBuff)then if z(C.ImmolationAura,nil,nil,not a9(8))then W=258920;return"immolation_aura normal 10"end end;if C.GlaiveTempest:IsReady()and C.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and(not a3 and O>0)then if z(C.GlaiveTempest,nil)then W=342817;return"glaive_tempest normal 12"end end;if C.ThrowGlaive:IsCastable()and C.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInRange(30)and(C.SerratedGlaive:ConduitEnabled()and(C.EyeBeam:CooldownRemains()<6 and y)and g:BuffDown(C.MetamorphosisBuff)and h:DebuffDown(C.ExposedWoundDebuff))then if z(C.ThrowGlaive,nil,nil,not h:IsSpellInRange(C.ThrowGlaive))then W=185123;return"throw_glaive normal 14"end end;if C.EyeBeam:IsReady()and y and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and C.VengefulRetreat:TimeSinceLastCast()>=1 and(not a3 and(P>0 and(not a5 or O>1 or g:Fury()<70)))then if z(C.EyeBeam,nil,nil,not a9(20))then W=198013;return"eye_beam normal 16"end end;if C.BladeDance:IsReady()and C.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and _ then if z(C.BladeDance,nil,nil,not a9(8))then W=188499;return"blade_dance normal 18"end end;if C.Felblade:IsCastable()and h:IsInMeleeRange(15)and g:FuryDeficit()>=40 and(not a9()or C.VengefulRetreat:TimeSinceLastCast()>=1.0)then if z(C.Felblade,nil,nil,not h:IsSpellInRange(C.Felblade))then W=183226;return"felblade normal 20"end end;if C.EssenceBreak:IsCastable()and h:IsInMeleeRange(10)and C.VengefulRetreat:TimeSinceLastCast()>1 then if z(C.EssenceBreak,nil,nil,not a9(10))then W=258860;return"essence_break normal 22"end end;if C.Annihilation:IsReady()and C.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and((C.DemonBlades:IsAvailable()or not a3 or g:FuryDeficit()<30 or g:BuffRemains(C.MetamorphosisBuff)<5)and not a0)then if z(C.Annihilation,nil,nil,not h:IsSpellInRange(C.Annihilation))then W=201427;return"annihilation normal 24"end end;if C.ChaosStrike:IsReady()and C.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and((C.DemonBlades:IsAvailable()or not a3 or g:FuryDeficit()<30)and not Z and not a0)then if z(C.ChaosStrike,nil,nil,not h:IsSpellInRange(C.ChaosStrike))then W=162794;return"chaos_strike normal 26"end end;if C.EyeBeam:IsReady()and y and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and C.VengefulRetreat:TimeSinceLastCast()>=1 and C.BlindFury:IsAvailable()then if z(C.EyeBeam,nil,nil,not h:IsInRange(20))then W=198013;return"eye_beam normal 28"end end;if C.DemonsBite:IsCastable()and C.VengefulRetreat:TimeSinceLastCast()>1 then if T.CastTargetIf(C.DemonsBite,M,"min",ac,ae,not h:IsSpellInRange(C.DemonsBite))then return"demons_bite normal 28"end end;if C.DemonsBite:IsCastable()and C.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)then if z(C.DemonsBite,nil,nil,not h:IsSpellInRange(C.DemonsBite))then W=162243;return"demons_bite normal 30"end end;if C.FelRush:IsCastable()and h:IsInRange(15)and C.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not C.Momentum:IsAvailable()and C.DemonBlades:IsAvailable()and ab())and v then if z(C.FelRush,nil,nil)then W=195072;return"fel_rush demonic 34"end end;if C.Felblade:IsCastable()and h:IsInRange(15)and not a9()then if z(C.Felblade,nil,nil,not h:IsSpellInRange(C.Felblade))then W=183226;return"felblade normal 34"end end;if C.FelRush:IsCastable()and h:IsInRange(15)and C.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not a9()and not C.Momentum:IsAvailable()and ab())and v then if z(C.FelRush,nil,nil)then W=195072;return"fel_rush demonic 34"end end;if C.VengefulRetreat:IsCastable()and C.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and w and not t and not a9()then if z(C.VengefulRetreat,nil)then W=198793;return"vengeful_retreat normal 38"end end;if C.ThrowGlaive:IsCastable()and C.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInRange(30)and C.DemonBlades:IsAvailable()then if z(C.ThrowGlaive,nil,nil,not h:IsSpellInRange(C.ThrowGlaive))then W=185123;return"throw_glaive normal 40"end end end;local function al()if m()then M=g:GetEnemiesInMeleeRange(8)N=g:GetEnemiesInMeleeRange(20)O=#M;P=#N else O=1;P=1 end;q=HeroRotationCharDB.Toggles[6]o=HeroRotationCharDB.Toggles[4]p=HeroRotationCharDB.Toggles[5]r=HeroRotationCharDB.Toggles[12]s=HeroRotationCharDB.Toggles[15]t=HeroRotationCharDB.Toggles[40]u=HeroRotationCharDB.Toggles[41]v=U.Havoc.FelRushMode=="All In"or U.Havoc.FelRushMode=="Safe"and C.Felblade:CooldownRemains(BypassRecovery)<=0 or U.Havoc.FelRushMode=="w/ Gap Closer"and(C.Felblade:CooldownRemains(BypassRecovery)<=0 or C.Metamorphosis:CooldownRemains(BypassRecovery)<=0 and x or C.FelRush:Charges()==2 or C.TheHunt:CooldownRemains(BypassRecovery)<=0 and o)w=U.Havoc.VengefulRetreatMode=="All In"or U.Havoc.VengefulRetreatMode=="Safe"and C.Felblade:CooldownRemains(BypassRecovery)<=0 or U.Havoc.VengefulRetreatMode=="w/ Gap Closer"and(C.Felblade:CooldownRemains(BypassRecovery)<=0 or C.Metamorphosis:CooldownRemains(BypassRecovery)<=0 and x or C.FelRush:CooldownRemains(BypassRecovery)<=0 or C.TheHunt:CooldownRemains(BypassRecovery)<=0 and o)x=false;y=false;if U.Havoc.IncludedCooldowns.Metamorphosis and l.CDsON()or U.Havoc.IncludedSmallCooldowns.Metamorphosis and(l.CDsON()or p)or not U.Havoc.IncludedSmallCooldowns.Metamorphosis and not U.Havoc.IncludedCooldowns.Metamorphosis then x=true end;if U.Havoc.IncludedCooldowns.EyeBeam and l.CDsON()or U.Havoc.IncludedSmallCooldowns.EyeBeam and(l.CDsON()or p)or not U.Havoc.IncludedSmallCooldowns.EyeBeam and not U.Havoc.IncludedCooldowns.EyeBeam then y=true end;if not BotOn then X=0;W=0 end;if X>0 then X=0 end;if W>0 then W=0 end;Y=false;if g:IsChanneling(C.EyeBeam)then if z(C.Pool)then W=9999;return"casting EB"end end;if u and C.Imprison:IsUsableP()and C.Imprison:CooldownRemains(BypassRecovery)<=0 and f("mouseover"):GUID()~=nil then if z(C.Imprison,nil,nil,nil)then X=231;return"queue Imprison MO"end elseif u and C.Imprison:IsUsableP()and C.Imprison:CooldownRemains(BypassRecovery)<=0 and T.TargetIsValid()then if z(C.Imprison,nil,nil,nil)then W=217832;return"queue Imprison"end elseif(not C.Imprison:IsUsableP()or C.Imprison:CooldownRemains()>0 or not T.TargetIsValid())and u then HeroRotationCharDB.Toggles[41]=not HeroRotationCharDB.Toggles[41]l.Print("Imprison Queue is now "..(HeroRotationCharDB.Toggles[41]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if g:FuryDeficit()>=35 and not g:IsChanneling(C.EyeBeam)or not g:AffectingCombat()then Y=true end;if T.TargetIsValid()then if not g:AffectingCombat()and q then local L=ah()if L then return L end end;if not R and not Q then _=C.FirstBlood:IsAvailable()or O>=3-a6(C.TrailofRuin:IsAvailable())end;if R then _=g:BuffDown(C.ChaosTheoryBuff)or C.FirstBlood:IsAvailable()and O>=2-a6(C.TrailofRuin:IsAvailable())or not C.CycleofHatred:IsAvailable()and O>=4-a6(C.TrailofRuin:IsAvailable())end;if Q then _=C.FirstBlood:IsAvailable()or(g:BuffUp(C.MetamorphosisBuff)or C.TrailofRuin:IsAvailable()or h:DebuffUp(C.EssenceBreakDebuff))and O>=3-a6(C.TrailofRuin:IsAvailable())or not C.Demonic:IsAvailable()and O>=4 end;if C.EssenceBreak:IsAvailable()and C.EssenceBreak:CooldownUp()then _=false end;Z=not C.Demonic:IsAvailable()and(C.Metamorphosis:CooldownRemains()<6 and x)and g:FuryDeficit()>30;a0=_ and g:Fury()<75-a6(C.FirstBlood:IsAvailable())*20;a1=C.Demonic:IsAvailable()and not C.BlindFury:IsAvailable()and(C.EyeBeam:CooldownRemains()<g:GCD()*2 and y)and g:FuryDeficit()>20;a3=C.Momentum:IsAvailable()and g:BuffDown(C.MomentumBuff)and not t;local L=T.Interrupt(10,C.Disrupt,U.Commons.OffGCDasOffGCD.Disrupt,V)if L then return L end;if n()or o and g:AffectingCombat()then local L=ai()if L then return L end end;if C.Blur:IsCastable()and g:HealthPercentage()<=U.Havoc.BlurHealthThreshold and g:AffectingCombat()then if z(C.Blur,nil)then W=198589;return"Blur defensives (Danger)"end end;if C.ThrowGlaive:IsCastable()and C.VengefulRetreat:TimeSinceLastCast()>1 and g:AffectingCombat()and(g:BuffStack(C.FelBombardmentBuff)==5 and(g:BuffUp(C.ImmolationAuraBuff)or g:BuffDown(C.MetamorphosisBuff)))then if z(C.ThrowGlaive,nil,nil,not h:IsSpellInRange(C.ThrowGlaive))then W=185123;return"throw_glaive fel_bombardment"end end;if C.Demonic:IsAvailable()and g:AffectingCombat()then local L=aj()if L then return L end end;if true and g:AffectingCombat()then local L=ak()if L then return L end end end end;local function am()end;function ReturnSpell()if W==0 then return 0 else return W end end;function ReturnSpellMO()if X==0 then return 0 else return X end end;function ShouldOrb()return Y end;l.SetAPL(577,al,am)