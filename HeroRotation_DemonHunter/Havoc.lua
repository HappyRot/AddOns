local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=HeroRotation;local m=l.AoEON;local n=l.CDsON;local o=HeroRotationCharDB.Toggles[4]local p=HeroRotationCharDB.Toggles[5]local q=HeroRotationCharDB.Toggles[6]local r=HeroRotationCharDB.Toggles[12]local s=not HeroRotationCharDB.Toggles[15]local t=HeroRotationCharDB.Toggles[40]local u=HeroRotationCharDB.Toggles[42]local v=HeroRotationCharDB.Toggles[43]local w=HeroRotationCharDB.Toggles[41]local x=HeroRotationCharDB.Toggles[45]local y=HeroRotationCharDB.Toggles[46]local z=HeroRotationCharDB.Toggles[44]local A=false;local B=false;local C=false;local D=false;local E=GetInventoryItemID("player",13)local F=GetInventoryItemID("player",14)local G=l.Cast;local H=l.CastSuggested;local I=string.match;local J=j.DemonHunter.Havoc;local K=k.DemonHunter.Havoc;local L={}local M=g:GetEquipment()local N=k(0)local O=k(0)if M[13]then N=k(M[13])end;if M[14]then O=k(M[14])end;local P;local Q,R;local S,T;local U=g:HasLegendaryEquipped(20)local V=g:HasLegendaryEquipped(23)local W=g:HasLegendaryEquipped(25)local X=l.Commons.Everyone;local Y={General=l.GUISettings.General,Commons=l.GUISettings.APL.DemonHunter.Commons,Havoc=l.GUISettings.APL.DemonHunter.Havoc}local Z={{J.FelEruption,"Cast Fel Eruption (Interrupt)",function()return true end},{J.ChaosNova,"Cast Chaos Nova (Interrupt)",function()return true end}}local _=0;local a0=0;local a1=false;local a2=false;local a3=false;local a4=false;local a5=false;local a6=false;local a7=false;local a8=0;local a9=false;d:RegisterForEvent(function()a2=false;a3=false;a4=false;a5=false;a6=false;a7=false end,"PLAYER_REGEN_ENABLED")d:RegisterForEvent(function()M=g:GetEquipment()N=k(0)O=k(0)if M[13]then N=k(M[13])end;if M[14]then O=k(M[14])end;U=g:HasLegendaryEquipped(20)V=g:HasLegendaryEquipped(23)W=g:HasLegendaryEquipped(25)end,"PLAYER_EQUIPMENT_CHANGED")local function aa(ab)if ab then return 1 else return 0 end end;local function ac(ab)return ab~=0 end;local function ad(ae)local ad=0;for af in pairs(ae)do local ag=ae[af]if ag:NPCID()==169421 or ag:NPCID()==169425 or ag:NPCID()==168932 or ag:NPCID()==169426 or ag:NPCID()==169429 or ag:NPCID()==169428 or ag:NPCID()==169430 then ad=ad+1 end end;return ad end;local function ah(ai)if J.Felblade:TimeSinceLastCast()<=g:GCD()then return true elseif J.VengefulRetreat:TimeSinceLastCast()<1.0 and J.VengefulRetreat:TimeSinceLastCast()>0.25 or J.FelRush:TimeSinceLastCast()<1.0 then return false end;return ai and h:IsInMeleeRange(ai)or h:IsInMeleeRange(5)end;local function aj()return true end;local function ak(ae)local al=0;for af in pairs(ae)do local ag=ae[af]if ag:DebuffDown(J.BurningWoundDebuff)then al=al+1 end end;return al end;local function am(ae)local an=0;for af in pairs(ae)do local ag=ae[af]if ag:DebuffDown(J.SadisticGleeDebuff)then an=an+1 end end;return an end;local function ao(ap)return ap:DebuffRemains(J.BurningWoundDebuff)end;local function aq(ap)if W and ap:DebuffRemains(J.BurningWoundDebuff)<4 and ap:IsInRange(8)and ap:GUID()==f("mouseover"):GUID()and Y.Havoc.TargetSwap=="Mouseover"then if J.DemonBlades:IsAvailable()then a0=1111 else a0=111 end;return true elseif W and ap:DebuffRemains(J.BurningWoundDebuff)<4 and ap:IsInRange(8)and Y.Havoc.TargetSwap=="AutoSwap"and ap:GUID()~=h:GUID()and not r then a0=999;return true elseif W and ap:DebuffRemains(J.BurningWoundDebuff)<4 and ap:IsInRange(8)and ap:GUID()==h:GUID()and h:IsInRange(8)then _=162243;return true elseif W and ap:DebuffRemains(J.BurningWoundDebuff)<4 and ap:IsInRange(8)then return true end end;local function ar(ap)return ap:DebuffRemains(J.BurningWoundDebuff)end;local function as(ap)if W and ap:DebuffRemains(J.BurningWoundDebuff)<4 and ap:IsInRange(8)and ap:GUID()==f("mouseover"):GUID()and Y.Havoc.TargetSwap=="Mouseover"then if J.DemonBlades:IsAvailable()then a0=1111 else a0=111 end;return true elseif W and ap:DebuffRemains(J.BurningWoundDebuff)<4 and ap:IsInRange(8)and Y.Havoc.TargetSwap=="AutoSwap"and ap:GUID()~=h:GUID()and not r then a0=999;return true elseif W and ap:DebuffRemains(J.BurningWoundDebuff)<4 and ap:IsInRange(8)and ap:GUID()==h:GUID()then _=162243;return true elseif W and ap:DebuffRemains(J.BurningWoundDebuff)<4 and ap:IsInRange(8)then return true end end;local function at()if N:TrinketHasStatAnyDps()and not O:TrinketHasStatAnyDps()then a8=1 end;if O:TrinketHasStatAnyDps()and not N:TrinketHasStatAnyDps()then a8=2 end;if N:TrinketHasStatAnyDps()and O:TrinketHasStatAnyDps()or not(N:TrinketHasStatAnyDps()and O:TrinketHasStatAnyDps())then a8=0 end;a9=J.BlindFury:IsAvailable()and(U or J.DemonBlades:IsAvailable())if not h:IsInMeleeRange(5)and J.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and h:IsInRange(15)and J.FelRush:IsCastable()and A then if G(J.FelRush,nil,nil,not h:IsInRange(15))then _=195072;return"fel_rush precombat 2"end end;if h:IsInMeleeRange(5)and(J.DemonsBite:IsCastable()or J.DemonBlades:IsAvailable())then if J.DemonBlades:IsAvailable()and IsCurrentSpell(6603)~=true then if G(J.DemonsBite,nil,nil,not h:IsInMeleeRange(5))then _=1162243;return"demons_bite or demon_blades precombat 4"end else if G(J.DemonsBite,nil,nil,not h:IsInMeleeRange(5))then _=162243;return"demons_bite or demon_blades precombat 4"end end end end;local function au()if J.Metamorphosis:IsCastable()and C and h:IsInRange(8)and(not J.Demonic:IsAvailable()and(J.EyeBeam:CooldownRemains()>20 or not D)and(not J.SinfulBrand:IsAvailable()or h:DebuffDown(J.SinfulBrandDebuff))or d.BossFilteredFightRemains("<",25))then if G(J.Metamorphosis,nil,nil,not h:IsInRange(40))then _=191427;return"metamorphosis cooldown 2"end end;if J.Metamorphosis:IsCastable()and C and h:IsInRange(8)and(J.Demonic:IsAvailable()and((J.EyeBeam:CooldownRemains()>20 or not D)and(not a3 or J.BladeDance:CooldownRemains()>g:GCD()))and(not J.SinfulBrand:IsAvailable()or h:DebuffDown(J.SinfulBrandDebuff))or d.BossFilteredFightRemains("<",25))then if G(J.Metamorphosis,nil,nil,not h:IsInRange(40))then _=191427;return"metamorphosis cooldown 4"end end;if(K.PotionofPhantomFire:IsReady()or K.PotionofSpectralAgility:IsReady())and h:IsInMeleeRange(8)and l.CDsON()and s and Y.Commons.Enabled.Potions and(g:BuffRemains(J.MetamorphosisBuff)>25 or d.BossFilteredFightRemains("<",60))then if G(K.PotionofPhantomFire,nil,nil)then _=4;return"potion cooldown 6"end end;if N:IsReady()and h:IsInRange(10)and Y.Commons.Enabled.TopTrinket and l.CDsON()and(a8==1 and(g:BuffUp(J.MetamorphosisBuff)or not J.Demonic:IsAvailable()and(J.Metamorphosis:CooldownRemains()>d.FightRemains(R)or not C)or d.BossFilteredFightRemains("<=",20))or a8==2 and not O:IsReady()or a8==0)then if G(N,nil,nil)then if N:ID()==GetInventoryItemID("player",13)and Y.Commons.Enabled.TopTrinket then _=20;return"top trinket 1"elseif N:ID()==GetInventoryItemID("player",14)and Y.Commons.Enabled.BottomTrinket then _=25;return"bot trinket 1"end end end;if O:IsReady()and h:IsInRange(10)and Y.Commons.Enabled.BottomTrinket and l.CDsON()and(a8==2 and(g:BuffUp(J.MetamorphosisBuff)or not J.Demonic:IsAvailable()and(J.Metamorphosis:CooldownRemains()>d.FightRemains(R)or not C)or d.BossFilteredFightRemains("<=",20))or a8==1 and not N:IsReady()or a8==0)then if G(O,nil,nil)then if O:ID()==GetInventoryItemID("player",13)and Y.Commons.Enabled.TopTrinket then _=20;return"top trinket 1"elseif O:ID()==GetInventoryItemID("player",14)and Y.Commons.Enabled.BottomTrinket then _=25;return"bot trinket 1"end end end;if J.SinfulBrand:IsCastable()and h:IsInMeleeRange(30)and o and h:DebuffDown(J.SinfulBrandDebuff)then if G(J.SinfulBrand,nil,nil,not h:IsSpellInRange(J.SinfulBrand))then _=317009;return"sinful_brand cooldown 12"end end;if J.TheHunt:IsCastable()and h:IsInRange(40)and o and(not J.Demonic:IsAvailable()and not a7 and not a2 or g:BuffUp(J.FuriousGazeBuff)or J.Demonic:IsAvailable())then if G(J.TheHunt,nil,nil,not h:IsSpellInRange(J.TheHunt))then _=323639;return"the_hunt cooldown 14"end end;if J.ElysianDecree:IsCastable()and h:IsInRange(30)and o and S>0 then if G(J.ElysianDecree,nil,nil,not h:IsInRange(30))then _=306830;return"elysian_decree cooldown 16"end end end;local function av()if J.FelRush:IsCastable()and h:IsInRange(15)and J.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(J.UnboundChaos:IsAvailable()and g:BuffUp(J.UnboundChaosBuff)and J.FelRush:Charges()==2)and A then if G(J.FelRush,nil,nil)then _=195072;return"fel_rush demonic 2"end end;if J.DeathSweep:IsReady()and J.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a3 then if G(J.DeathSweep,nil,nil,not ah(8))then _=210152;return"death_sweep demonic 4"end end;if J.GlaiveTempest:IsReady()and h:IsInMeleeRange(8)and S>0 then if G(J.GlaiveTempest,nil,nil,not h:IsInMeleeRange(8))then _=342817;return"glaive_tempest demonic 6"end end;if J.ThrowGlaive:IsCastable()and h:IsInMeleeRange(30)and J.VengefulRetreat:TimeSinceLastCast()>1 and(J.SerratedGlaive:ConduitEnabled()and(J.EyeBeam:CooldownRemains()<6 and D)and g:BuffDown(J.MetamorphosisBuff)and h:DebuffDown(J.ExposedWoundDebuff))then if G(J.ThrowGlaive,nil,nil,not h:IsSpellInRange(J.ThrowGlaive))then _=185123;return"throw_glaive demonic 8"end end;if J.EyeBeam:IsReady()and D and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and J.VengefulRetreat:TimeSinceLastCast()>=1 and(S>0 and(not a9 or S>1 or g:Fury()<70))then if G(J.EyeBeam,nil,nil,not h:IsInRange(20))then _=198013;return"eye_beam demonic 10"end end;if J.BladeDance:IsReady()and J.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and(a3 and not J.Metamorphosis:CooldownUp()and(J.EyeBeam:CooldownRemains()>5 or not D))then if G(J.BladeDance,nil,nil,not ah(8))then _=188499;return"blade_dance demonic 12"end end;if J.ImmolationAura:IsCastable()and not u and J.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and g:BuffDown(J.ImmolationAuraBuff)then if G(J.ImmolationAura,nil,nil,not ah(8))then _=258920;return"immolation_aura demonic 14"end end;if J.Annihilation:IsReady()and h:IsInRange(8)and h:IsInMeleeRange(8)and not a4 then if G(J.Annihilation,nil,nil,not h:IsSpellInRange(J.Annihilation))then _=201427;return"annihilation demonic 16"end end;if J.Felblade:IsCastable()and not v and h:IsInRange(15)and(h:IsInRange(8)or not t)and g:FuryDeficit()>=40 and(not ah()or J.VengefulRetreat:TimeSinceLastCast()>=1.0)then if G(J.Felblade,nil,nil,not h:IsSpellInRange(J.Felblade))then _=183226;return"felblade demonic 18"end end;if J.EssenceBreak:IsCastable()and h:IsInMeleeRange(10)and J.VengefulRetreat:TimeSinceLastCast()>1 then if G(J.EssenceBreak,nil,nil,not ah(10))then _=258860;return"essence_break demonic 20"end end;if J.ChaosStrike:IsReady()and h:IsInMeleeRange(8)and(not a4 and not a5)then if G(J.ChaosStrike,nil,nil,not h:IsSpellInRange(J.ChaosStrike))then _=162794;return"chaos_strike demonic 22"end end;if J.FelRush:IsCastable()and h:IsInRange(15)and J.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(J.DemonBlades:IsAvailable()and not J.EyeBeam:CooldownUp()and aj())and A then if G(J.FelRush,nil,nil)then _=195072;return"fel_rush demonic 24"end end;if J.DemonsBite:IsCastable()or J.DemonBlades:IsAvailable()then if W and not J.DemonBlades:IsAvailable()and(h:DebuffRemains(J.BurningWoundDebuff)<4 or(UnitsWithoutBWCount==0 or not m()))then if G(J.DemonsBite,nil,nil,not h:IsSpellInRange(J.DemonsBite))then _=162243;return"demons_bite 26T"end end;if X.CastTargetIf(J.DemonsBite,Q,"min",ar,as)then return"demons_bite demonic 26"end end;if J.FelRush:IsCastable()and h:IsInRange(15)and J.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not J.DemonBlades:IsAvailable()and S>1 and J.FelRush:Charges()==2)and A then if G(J.FelRush,nil,nil)then _=195072;return"fel_rush demonic 28"end end;if J.DemonsBite:IsCastable()and not J.DemonBlades:IsAvailable()and h:IsInMeleeRange(8)and not W then if G(J.DemonsBite,nil,nil,not h:IsSpellInRange(J.DemonsBite))then _=162243;return"demons_bite demonic 30"end end;if J.ThrowGlaive:IsCastable()and h:IsInRange(30)and not ah()then if G(J.ThrowGlaive,nil,nil,not h:IsSpellInRange(J.ThrowGlaive))then _=185123;return"throw_glaive demonic 32"end end;if J.FelRush:IsCastable()and h:IsInRange(15)and J.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not ah()and aj())and A then if G(J.FelRush,nil,nil)then _=195072;return"fel_rush demonic 34"end end;if J.VengefulRetreat:IsCastable()and J.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and B and not t and not ah()then if G(J.VengefulRetreat,nil)then _=198793;return"vengeful_retreat demonic 36"end end;if J.ThrowGlaive:IsCastable()and h:IsInRange(30)and J.DemonBlades:IsAvailable()then if G(J.ThrowGlaive,nil,nil,not h:IsSpellInRange(J.ThrowGlaive))then _=185123;return"throw_glaive demonic 38"end end end;local function aw()if J.VengefulRetreat:IsCastable()and J.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and B and not t and(J.Momentum:IsAvailable()and g:BuffDown(J.PreparedBuff)and d.CombatTime()>1)then if G(J.VengefulRetreat,nil)then _=198793;return"vengeful_retreat normal 2"end end;if J.FelRush:IsCastable()and h:IsInRange(15)and J.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and((g:BuffUp(J.UnboundChaosBuff)or a7 and(not J.UnboundChaos:IsAvailable()or not J.ImmolationAura:CooldownUp()))and aj())and A then if G(J.FelRush,nil,nil)then _=195072;return"fel_rush demonic 34"end end;if J.FelBarrage:IsCastable()and J.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and S>1 then if G(J.FelBarrage,nil,nil,not ah(8))then _=211053;return"fel_barrage normal 6"end end;if J.DeathSweep:IsReady()and J.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a3 then if G(J.DeathSweep,nil,nil,not ah(8))then _=210152;return"death_sweep normal 8"end end;if J.ImmolationAura:IsCastable()and not u and J.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and g:BuffDown(J.ImmolationAuraBuff)then if G(J.ImmolationAura,nil,nil,not ah(8))then _=258920;return"immolation_aura normal 10"end end;if J.GlaiveTempest:IsReady()and J.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and(not a7 and S>0)then if G(J.GlaiveTempest,nil)then _=342817;return"glaive_tempest normal 12"end end;if J.ThrowGlaive:IsCastable()and J.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInRange(30)and(J.SerratedGlaive:ConduitEnabled()and(J.EyeBeam:CooldownRemains()<6 and D)and g:BuffDown(J.MetamorphosisBuff)and h:DebuffDown(J.ExposedWoundDebuff))then if G(J.ThrowGlaive,nil,nil,not h:IsSpellInRange(J.ThrowGlaive))then _=185123;return"throw_glaive normal 14"end end;if J.EyeBeam:IsReady()and D and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and J.VengefulRetreat:TimeSinceLastCast()>=1 and(not a7 and(T>0 and(not a9 or S>1 or g:Fury()<70)))then if G(J.EyeBeam,nil,nil,not ah(20))then _=198013;return"eye_beam normal 16"end end;if J.BladeDance:IsReady()and J.VengefulRetreat:TimeSinceLastCast()>=1 and h:IsInMeleeRange(8)and a3 then if G(J.BladeDance,nil,nil,not ah(8))then _=188499;return"blade_dance normal 18"end end;if J.Felblade:IsCastable()and not v and h:IsInMeleeRange(15)and(h:IsInRange(8)or not t)and g:FuryDeficit()>=40 and(not ah()or J.VengefulRetreat:TimeSinceLastCast()>=1.0)then if G(J.Felblade,nil,nil,not h:IsSpellInRange(J.Felblade))then _=183226;return"felblade normal 20"end end;if J.EssenceBreak:IsCastable()and h:IsInMeleeRange(10)and J.VengefulRetreat:TimeSinceLastCast()>1 then if G(J.EssenceBreak,nil,nil,not ah(10))then _=258860;return"essence_break normal 22"end end;if J.Annihilation:IsReady()and J.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and((J.DemonBlades:IsAvailable()or not a7 or g:FuryDeficit()<30 or g:BuffRemains(J.MetamorphosisBuff)<5)and not a4)then if G(J.Annihilation,nil,nil,not h:IsSpellInRange(J.Annihilation))then _=201427;return"annihilation normal 24"end end;if J.ChaosStrike:IsReady()and J.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and((J.DemonBlades:IsAvailable()or not a7 or g:FuryDeficit()<30)and not a2 and not a4)then if G(J.ChaosStrike,nil,nil,not h:IsSpellInRange(J.ChaosStrike))then _=162794;return"chaos_strike normal 26"end end;if J.EyeBeam:IsReady()and D and not h:IsCasting(j(355806))and h:IsInMeleeRange(10)and J.VengefulRetreat:TimeSinceLastCast()>=1 and J.BlindFury:IsAvailable()then if G(J.EyeBeam,nil,nil,not h:IsInRange(20))then _=198013;return"eye_beam normal 28"end end;if(J.DemonsBite:IsCastable()or J.DemonBlades:IsAvailable())and J.VengefulRetreat:TimeSinceLastCast()>1 then if W and not J.DemonBlades:IsAvailable()and(h:DebuffRemains(J.BurningWoundDebuff)<4 or(UnitsWithoutBWCount==0 or not m()))then if G(J.DemonsBite,nil,nil,not h:IsSpellInRange(J.DemonsBite))then _=162243;return"demons_bite 26T"end end;if X.CastTargetIf(J.DemonsBite,Q,"min",ao,aq)then return"demons_bite normal 28"end end;if J.DemonsBite:IsCastable()and not J.DemonBlades:IsAvailable()and J.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInMeleeRange(8)and not W then if G(J.DemonsBite,nil,nil,not h:IsSpellInRange(J.DemonsBite))then _=162243;return"demons_bite normal 30"end end;if J.FelRush:IsCastable()and h:IsInRange(15)and J.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not J.Momentum:IsAvailable()and J.DemonBlades:IsAvailable()and aj())and A then if G(J.FelRush,nil,nil)then _=195072;return"fel_rush demonic 34"end end;if J.Felblade:IsCastable()and not v and h:IsInRange(15)and(not ah()and not t)then if G(J.Felblade,nil,nil,not h:IsSpellInRange(J.Felblade))then _=183226;return"felblade normal 34"end end;if J.FelRush:IsCastable()and h:IsInRange(15)and J.VengefulRetreat:TimeSinceLastCast()>0.75 and not t and(not ah()and not J.Momentum:IsAvailable()and aj())and A then if G(J.FelRush,nil,nil)then _=195072;return"fel_rush demonic 34"end end;if J.VengefulRetreat:IsCastable()and J.EyeBeam:TimeSinceLastCast()>1 and h:IsInRange(5)and B and not t and not ah()then if G(J.VengefulRetreat,nil)then _=198793;return"vengeful_retreat normal 38"end end;if J.ThrowGlaive:IsCastable()and J.VengefulRetreat:TimeSinceLastCast()>1 and h:IsInRange(30)and J.DemonBlades:IsAvailable()then if G(J.ThrowGlaive,nil,nil,not h:IsSpellInRange(J.ThrowGlaive))then _=185123;return"throw_glaive normal 40"end end end;local function ax()if m()then Q=g:GetEnemiesInMeleeRange(8)R=g:GetEnemiesInMeleeRange(20)S=#Q;T=#R else S=1;T=1 end;UnitsWithoutBWCount=ak(Q)UnitsWithoutSGCount=am(Q)q=HeroRotationCharDB.Toggles[6]o=HeroRotationCharDB.Toggles[4]p=HeroRotationCharDB.Toggles[5]r=HeroRotationCharDB.Toggles[12]s=not HeroRotationCharDB.Toggles[15]t=HeroRotationCharDB.Toggles[40]w=HeroRotationCharDB.Toggles[41]u=HeroRotationCharDB.Toggles[42]v=HeroRotationCharDB.Toggles[43]z=HeroRotationCharDB.Toggles[44]x=HeroRotationCharDB.Toggles[45]y=HeroRotationCharDB.Toggles[46]A=Y.Havoc.FelRushMode=="All In"or Y.Havoc.FelRushMode=="Safe"and J.Felblade:CooldownRemains(BypassRecovery)<=0 or Y.Havoc.FelRushMode=="w/ Gap Closer"and(J.Felblade:CooldownRemains(BypassRecovery)<=0 or J.Metamorphosis:CooldownRemains(BypassRecovery)<=0 and C or J.FelRush:Charges()==2 or J.TheHunt:CooldownRemains(BypassRecovery)<=0 and o)B=Y.Havoc.VengefulRetreatMode=="All In"or Y.Havoc.VengefulRetreatMode=="Safe"and J.Felblade:CooldownRemains(BypassRecovery)<=0 or Y.Havoc.VengefulRetreatMode=="w/ Gap Closer"and(J.Felblade:CooldownRemains(BypassRecovery)<=0 or J.Metamorphosis:CooldownRemains(BypassRecovery)<=0 and C or J.FelRush:CooldownRemains(BypassRecovery)<=0 or J.TheHunt:CooldownRemains(BypassRecovery)<=0 and o)C=false;D=false;if Y.Havoc.IncludedCooldowns.Metamorphosis and l.CDsON()or Y.Havoc.IncludedSmallCooldowns.Metamorphosis and(l.CDsON()or p)or not Y.Havoc.IncludedSmallCooldowns.Metamorphosis and not Y.Havoc.IncludedCooldowns.Metamorphosis then C=true end;if Y.Havoc.IncludedCooldowns.EyeBeam and l.CDsON()or Y.Havoc.IncludedSmallCooldowns.EyeBeam and(l.CDsON()or p)or not Y.Havoc.IncludedSmallCooldowns.EyeBeam and not Y.Havoc.IncludedCooldowns.EyeBeam then D=true end;if not BotOn then a0=0;_=0 end;if a0>0 then a0=0 end;if _>0 then _=0 end;a1=false;NecroPetsUpCount=ad(Q)if g:IsChanneling(J.EyeBeam)then if G(J.Pool)then _=9999;return"casting EB"end end;if w and J.Imprison:IsUsableP()and J.Imprison:CooldownRemains(BypassRecovery)<=0 and f("mouseover"):GUID()~=nil then if G(J.Imprison,nil,nil,nil)then a0=231;return"queue Imprison MO"end elseif w and J.Imprison:IsUsableP()and J.Imprison:CooldownRemains(BypassRecovery)<=0 and X.TargetIsValid()then if G(J.Imprison,nil,nil,nil)then _=217832;return"queue Imprison"end elseif(not J.Imprison:IsUsableP()or J.Imprison:CooldownRemains()>0 or not X.TargetIsValid())and w then HeroRotationCharDB.Toggles[41]=not HeroRotationCharDB.Toggles[41]l.Print("Imprison Queue is now "..(HeroRotationCharDB.Toggles[41]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if x and J.FelEruption:IsUsableP()and J.FelEruption:CooldownRemains(BypassRecovery)<=0 and J.FelEruption:IsAvailable()and f("mouseover"):GUID()~=nil then if G(J.FelEruption,nil,nil,nil)then a0=1211881;return"queue Fel Eruption"end elseif x and J.FelEruption:IsUsableP()and J.FelEruption:CooldownRemains(BypassRecovery)<=0 and J.FelEruption:IsAvailable()and X.TargetIsValid()then if G(J.FelEruption,nil,nil,nil)then _=211881;return"queue Fel Eruption"end elseif(not J.FelEruption:IsUsableP()and g:Fury()>10 or J.FelEruption:CooldownRemains()>0 or not J.FelEruption:IsAvailable())and x then HeroRotationCharDB.Toggles[45]=not HeroRotationCharDB.Toggles[45]l.Print("Fel Eruption Queue is now "..(HeroRotationCharDB.Toggles[45]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if y and J.ChaosNova:IsUsableP()and J.ChaosNova:CooldownRemains(BypassRecovery)<=0 then if G(J.ChaosNova,nil,nil,nil)then _=179057;return"queue Chaos Nova MO"end elseif(not J.ChaosNova:IsUsableP()and g:Fury()>30 or J.ChaosNova:CooldownRemains()>0 or not X.TargetIsValid())and y then HeroRotationCharDB.Toggles[46]=not HeroRotationCharDB.Toggles[46]l.Print("ChaosNova Queue is now "..(HeroRotationCharDB.Toggles[46]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if g:FuryDeficit()>=35 and not g:IsChanneling(J.EyeBeam)or not g:AffectingCombat()then a1=true end;if X.TargetIsValid()then if not g:AffectingCombat()and q then local P=at()if P then return P end end;if not V and not U then a3=J.FirstBlood:IsAvailable()or S>=3-aa(J.TrailofRuin:IsAvailable())end;if V then a3=g:BuffDown(J.ChaosTheoryBuff)or J.FirstBlood:IsAvailable()and S>=2-aa(J.TrailofRuin:IsAvailable())or not J.CycleofHatred:IsAvailable()and S>=4-aa(J.TrailofRuin:IsAvailable())end;if U then a3=J.FirstBlood:IsAvailable()or(g:BuffUp(J.MetamorphosisBuff)or J.TrailofRuin:IsAvailable()or h:DebuffUp(J.EssenceBreakDebuff))and S>=3-aa(J.TrailofRuin:IsAvailable())or not J.Demonic:IsAvailable()and S>=4 end;if J.EssenceBreak:IsAvailable()and J.EssenceBreak:CooldownUp()then a3=false end;a2=not J.Demonic:IsAvailable()and(J.Metamorphosis:CooldownRemains()<6 and C)and g:FuryDeficit()>30;a4=a3 and g:Fury()<75-aa(J.FirstBlood:IsAvailable())*20;a5=J.Demonic:IsAvailable()and not J.BlindFury:IsAvailable()and(J.EyeBeam:CooldownRemains()<g:GCD()*2 and D)and g:FuryDeficit()>20;a7=J.Momentum:IsAvailable()and g:BuffDown(J.MomentumBuff)and not t;local P=X.Interrupt(10,J.Disrupt,Y.Commons.OffGCDasOffGCD.Disrupt,Z)if P then return P end;for ay=1,25 do local az,aA,aA,aB=UnitBuff("target",ay)if aB~=nil and aB=="Magic"then if J.ConsumeMagic:IsCastable()and z and h:IsInRange(30)then if G(J.ConsumeMagic,nil)then _=278326;return"Consume Magic"end end end end;if K.CruciformVeinripper:IsEquipped()and h:DebuffUp(J.SadisticGleeDebuff)and UnitsWithoutSGCount>0 and Y.Havoc.TargetSwap=="AutoSwap"and not r then a0=999 end;if NecroPetsUpCount>0 and J.ThrowGlaive:IsCastable()and(h:IsInRange(8)or g:HealthPercentage()<=25)then a0=21185123 end;if n()or o and g:AffectingCombat()then local P=au()if P then return P end end;if J.Blur:IsCastable()and g:HealthPercentage()<=Y.Havoc.BlurHealthThreshold and g:AffectingCombat()then if G(J.Blur,nil)then _=198589;return"Blur defensives (Danger)"end end;if J.ThrowGlaive:IsCastable()and J.VengefulRetreat:TimeSinceLastCast()>1 and g:AffectingCombat()and(g:BuffStack(J.FelBombardmentBuff)==5 and(g:BuffUp(J.ImmolationAuraBuff)or g:BuffDown(J.MetamorphosisBuff)))then if G(J.ThrowGlaive,nil,nil,not h:IsSpellInRange(J.ThrowGlaive))then _=185123;return"throw_glaive fel_bombardment"end end;if J.Demonic:IsAvailable()and g:AffectingCombat()then local P=av()if P then return P end end;if true and g:AffectingCombat()then local P=aw()if P then return P end end end end;local function aC()end;function ReturnSpell()if _==0 then return 0 else return _ end end;function ReturnSpellMO()if a0==0 then return 0 else return a0 end end;function ShouldOrb()return a1 end;l.SetAPL(577,ax,aC)