local a,b=...local c=HeroLib;local d=HeroRotation;local e=HeroCache;local f=c.Unit;local g=f.Player;local h=f.Target;local i=c.Spell;local j=c.Item;local GetTime=GetTime;local k=math.max;d.Commons.DemonHunter={}local l=d.Commons.DemonHunter;local m=i.DemonHunter.Vengeance;l.Souls={}local n=l.Souls;n.AuraSouls=0;n.IncomingSouls=0;c:RegisterForSelfCombatEvent(function(...)local o=select(12,...)local p=0;if o==m.Fracture:ID()or o==m.Shear:ID()then p=2 elseif o==m.SoulCarver:ID()then p=3;C_Timer.After(1,function()n.IncomingSouls=n.IncomingSouls+1 end)C_Timer.After(2,function()n.IncomingSouls=n.IncomingSouls+1 end)C_Timer.After(3,function()n.IncomingSouls=n.IncomingSouls+1 end)elseif o==m.ElysianDecree:ID()then p=m.SoulSigils:IsAvailable()and 4 or 3 elseif m.SoulSigils:IsAvailable()and(o==m.SigilofFlame:ID()or o==m.SigilofMisery:ID()or o==m.SigilofChains:ID()or o==m.SigilofSilence:ID())then p=1 else p=0 end;if p>0 then n.IncomingSouls=n.IncomingSouls+p end end,"SPELL_CAST_SUCCESS")c:RegisterForSelfCombatEvent(function(...)local o=select(12,...)if o==425672 then n.IncomingSouls=n.IncomingSouls+1 end end,"SPELL_DAMAGE")c:RegisterForSelfCombatEvent(function(...)local o=select(12,...)if o==203981 then n.AuraSouls=1;n.IncomingSouls=k(0,n.IncomingSouls-1)end end,"SPELL_AURA_APPLIED")c:RegisterForSelfCombatEvent(function(...)local o,q,q,q,r=select(12,...)if o==203981 then n.AuraSouls=r;n.IncomingSouls=k(0,n.IncomingSouls-r)end end,"SPELL_AURA_APPLIED_DOSE")c:RegisterForSelfCombatEvent(function(...)local o,q,q,q,r=select(12,...)if o==203981 then n.AuraSouls=r end end,"SPELL_AURA_REMOVED_DOSE")c:RegisterForSelfCombatEvent(function(...)local o,q,q,q,r=select(12,...)if o==203981 then n.AuraSouls=0 end end,"SPELL_AURA_REMOVED")