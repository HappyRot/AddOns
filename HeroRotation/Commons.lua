local a,b=...local c=HeroLib;local d,e=HeroCache,c.Utils;local f=c.Unit;local g=f.Player;local h=f.Target;local i=c.Spell;local j=c.Item;local pairs=pairs;b.Commons={}local k={}b.Commons.Everyone=k;local l=b.GUISettings.General;local m=b.GUISettings.Abilities;function k.TargetIsValid()return h:Exists()and g:CanAttack(h)and not h:IsDeadOrGhost()end;function k.UnitIsCycleValid(f,n,o)return not f:IsFacingBlacklisted()and not f:IsUserCycleBlacklisted()and(not n or f:FilteredTimeToDie(">",n,o))end;function k.CanDoTUnit(f,p)return f:Health()>=p or f:IsDummy()end;function k.Interrupt(q,i,r,s)if l.InterruptEnabled and h:IsInterruptible()and h:IsInRange(q)then if i:IsCastable()then if b.Cast(i,r)then return"Cast "..i:Name().." (Interrupt)"end elseif l.InterruptWithStun and h:CanBeStunned()then if s then for t=1,#s do if s[t][1]:IsCastable()and s[t][3]()then if b.Cast(s[t][1])then return s[t][2]end end end end end end end;function k.IsSoloMode()return l.SoloMode and not g:IsInRaidArea()and not g:IsInDungeonArea()end;function k.CastCycle(u,v,w,x,y,z)if w(h)then return b.Cast(u,y,z,x)end;if b.AoEON()then local A=h:GUID()for B,C in pairs(v)do if C:GUID()~=A and not C:IsFacingBlacklisted()and not C:IsUserCycleBlacklisted()and w(C)then b.CastLeftNameplate(C,u)break end end end end;function k.CastTargetIf(u,v,D,E,w,x,y,z)local F=not w or w and w(h)if not b.AoEON()and F then return b.Cast(u,y,z,x)end;if b.AoEON()then local G,H=nil,nil;for B,C in pairs(v)do if not C:IsFacingBlacklisted()and not C:IsUserCycleBlacklisted()and(C:AffectingCombat()or C:IsDummy())and(not H or e.CompareThis(D,E(C),H))then G,H=C,E(C)end end;if G then if F and(G:GUID()==h:GUID()or H==E(h))then return b.Cast(u,y,z,x)elseif w and w(G)or not w then b.CastLeftNameplate(G,u)end end end end