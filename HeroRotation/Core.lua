local a,b=...local c=HeroLib;local d,e=HeroCache,c.Utils;local f=c.Unit;local g=f.Player;local h=f.Target;local i=c.Spell;local j=c.Item;local k=math.min;local print=print;local select=select;local l=string.lower;local strsplit=strsplit;local tostring=tostring;local m=_G.DBM;local n=_G.BigWigsLoader;local o=false;local p=_G["IsBoomKaBitch"]HeroRotation=b;b.BossMods={EngagedBosses={}}local q=b.BossMods.EngagedBosses;function b.Print(...)print("[|cFFFF6600Hero Rotation|r]",...)end;b.APLs={}b.APLInits={}function b.SetAPL(r,s,t)b.APLs[r]=s;b.APLInits[r]=t end;function b.GetTexture(u)local v=u.SpellID;if v then local w=d.Persistent.Texture.Spell;if not w[v]then if v>=999900 then w[v]="Interface\\Addons\\HeroRotation\\Textures\\"..tostring(v)elseif u.TextureSpellID then w[v]=GetSpellTexture(u.TextureSpellID)else w[v]=GetSpellTexture(v)end end;return w[v]end;local x=u.ItemID;if x then local w=d.Persistent.Texture.Item;if not w[x]then local y,y,y,y,y,y,y,y,y,z=GetItemInfo(x)w[x]=z end;return w[x]end end;local A=i(61304)local B,C,D;local function E(u,F,G)local H,I;local J=GetTime()if g:IsCasting()or g:IsChanneling()then H=g:CastStart()I=g:CastDuration()else H,I=A:CooldownInfo()end;if B~=u then B=u;C=J;D=0 end;if F then local K;if G then K=G else K=g.TimeToXResourceMap[u:CostInfo(nil,"type")](u:Cost())end;if K and K>0 then if K>H+I-J then local L=J-C+K;if D==0 and L>0.25 or D>L or L-D>0.5 then D=L end;H=C;I=D end end end;if H+I<J then H=0;I=0;B=nil end;b.MainIconFrame:SetCooldown(H,I)end;b.CastOffGCDOffset=1;function b.Cast(u,M,N,O,G)local P=d.Persistent.Player.Spec[1]local p=_G["IsBoomKaBitch"]if P==64 and not p then print("|cffff6060You are using an unapproved rotation. It has been logged|r.")return false end;local Q=b.GetTexture(u)local R=not b.GUISettings.General.HideKeyBinds and c.Action.TextureHotKey(Q)if M or N=="Cooldown"then if b.CastOffGCDOffset==1 or b.CastOffGCDOffset==2 and b.SmallIconFrame:GetIcon(1)~=Q then b.SmallIconFrame:ChangeIcon(b.CastOffGCDOffset,Q,R,O)b.CastOffGCDOffset=b.CastOffGCDOffset+1;u.LastDisplayTime=GetTime()return false end elseif N=="Suggested"then b.CastSuggested(u,O)elseif N=="SuggestedRight"then b.CastRightSuggested(u,O)else local S=999910;local T=u.SpellID==S or u:IsUsable()local U=N=="Pooling"local O=O or false;b.MainIconFrame:ChangeIcon(Q,R,T,O)E(u,U,G)u.LastDisplayTime=GetTime()return true end;return nil end;function b.CastAnnotated(u,M,V)local W=b.Cast(u,M)if not M then b.MainIconFrame:OverlayText(V)end;return W end;function b.CastPooling(u,G,O)return b.Cast(u,false,"Pooling",O,G)end;local X,Y,Z,_;b.MaxQueuedCasts=3;local function a0(...)X={...}Y=k(#X,b.MaxQueuedCasts)Z={}_={}for a1=1,Y do Z[a1]=b.GetTexture(X[a1])X[a1].LastDisplayTime=GetTime()_[a1]=not b.GUISettings.General.HideKeyBinds and c.Action.TextureHotKey(Z[a1])end;b.MainIconFrame:ChangeIcon(Z[1],_[1],X[1]:IsUsable())b.MainIconFrame:SetupParts(Z,_)end;function b.CastQueue(...)a0(...)E()return"Should Return"end;function b.CastQueuePooling(G,...)a0(...)if G then E(X[1],true,G)else local a2,a3=nil,0;for a1=1,#X do if X[a1]:Cost()>a3 then a3=X[a1]:Cost()a2=X[a1]end end;E(a2,true)end;return"Should Return"end;b.CastLeftOffset=1;function b.CastLeftCommon(u)local a4=b.GetTexture(u)local R=not b.GUISettings.General.HideKeyBinds and c.Action.TextureHotKey(a4)b.LeftIconFrame:ChangeIcon(a4,R)b.CastLeftOffset=b.CastLeftOffset+1;u.LastDisplayTime=GetTime()end;function b.CastLeft(u)if b.CastLeftOffset==1 then b.CastLeftCommon(u)end;return false end;function b.CastLeftNameplate(a5,u)if b.CastLeftOffset==1 and b.Nameplate.AddIcon(a5,u)then b.CastLeftCommon(u)end;return false end;b.CastSuggestedOffset=1;function b.CastSuggested(u,O)if b.CastSuggestedOffset==1 then local a4=b.GetTexture(u)local R=not b.GUISettings.General.HideKeyBinds and c.Action.TextureHotKey(a4)b.SuggestedIconFrame:ChangeIcon(a4,R,O)b.CastSuggestedOffset=b.CastSuggestedOffset+1;u.LastDisplayTime=GetTime()end;return false end;b.CastRightSuggestedOffset=1;function b.CastRightSuggested(u,O)if b.CastRightSuggestedOffset==1 then local a4=b.GetTexture(u)local R=not b.GUISettings.General.HideKeyBinds and c.Action.TextureHotKey(a4)b.RightSuggestedIconFrame:ChangeIcon(a4,R,O)b.CastRightSuggestedOffset=b.CastRightSuggestedOffset+1;u.LastDisplayTime=GetTime()end;return false end;function b.CmdHandler(a6)local a7,a8,a9=strsplit(" ",l(a6))if a7=="cds"then HeroRotationCharDB.Toggles[1]=not HeroRotationCharDB.Toggles[1]b.ToggleIconFrame:UpdateButtonText(1)b.Print("CDs are now "..(HeroRotationCharDB.Toggles[1]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="aoe"then HeroRotationCharDB.Toggles[2]=not HeroRotationCharDB.Toggles[2]b.ToggleIconFrame:UpdateButtonText(2)b.Print("AoE is now "..(HeroRotationCharDB.Toggles[2]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="toggle"then HeroRotationCharDB.Toggles[3]=not HeroRotationCharDB.Toggles[3]b.ToggleIconFrame:UpdateButtonText(3)b.Print("HeroRotation is now "..(HeroRotationCharDB.Toggles[3]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="covenants"then HeroRotationCharDB.Toggles[4]=not HeroRotationCharDB.Toggles[4]b.ToggleIconFrame:UpdateButtonText(4)b.Print("Covenants are now "..(HeroRotationCharDB.Toggles[4]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="smallcds"then HeroRotationCharDB.Toggles[5]=not HeroRotationCharDB.Toggles[5]b.ToggleIconFrame:UpdateButtonText(5)b.Print("Small Cooldowns are now "..(HeroRotationCharDB.Toggles[5]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="opener"then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]b.ToggleIconFrame:UpdateButtonText(6)b.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="unlock"then b.MainFrame:Unlock()b.Print("HeroRotation UI is now |cff00ff00unlocked|r.")elseif a7=="lock"then b.MainFrame:Lock()b.Print("HeroRotation UI is now |cffff0000locked|r.")elseif a7=="scale"then if a8 and a9 then a9=tonumber(a9)if a9 and type(a9)=="number"and a9>0 and a9<=10 then if a8=="ui"then b.MainFrame:ResizeUI(a9)elseif a8=="buttons"then b.MainFrame:ResizeButtons(a9)elseif a8=="all"then b.MainFrame:ResizeUI(a9)b.MainFrame:ResizeButtons(a9)else b.Print("Invalid |cff88ff88[Type]|r for Scale.")b.Print("Should be |cff8888ff/hr scale|r |cff88ff88[Type]|r |cffff8888[Size]|r.")b.Print("Type accepted are |cff88ff88ui|r, |cff88ff88buttons|r, |cff88ff88all|r.")end else b.Print("Invalid |cffff8888[Size]|r for Scale.")b.Print("Should be |cff8888ff/hr scale|r |cff88ff88[Type]|r |cffff8888[Size]|r.")b.Print("Size accepted are |cffff8888number > 0 and <= 10|r.")end else b.Print("Invalid arguments for Scale.")b.Print("Should be |cff8888ff/hr scale|r |cff88ff88[Type]|r |cffff8888[Size]|r.")b.Print("Type accepted are |cff88ff88ui|r, |cff88ff88buttons|r, |cff88ff88all|r.")b.Print("Size accepted are |cffff8888number > 0 and <= 10|r.")end elseif a7=="resetbuttons"then b.ToggleIconFrame:ResetAnchor()elseif a7=="help"then b.Print("|cffffff00--[Toggles]--|r")b.Print("  On/Off: |cff8888ff/hr toggle|r")b.Print("  CDs: |cff8888ff/hr cds|r")b.Print("  AoE: |cff8888ff/hr aoe|r")b.Print("|cffffff00--[User Interface]--|r")b.Print("  UI Lock: |cff8888ff/hr lock|r")b.Print("  UI Unlock: |cff8888ff/hr unlock|r")b.Print("  UI Scale: |cff8888ff/hr scale|r |cff88ff88[Type]|r |cffff8888[Size]|r")b.Print("    [Type]: |cff88ff88ui|r, |cff88ff88buttons|r, |cff88ff88all|r")b.Print("    [Size]: |cffff8888number > 0 and <= 10|r")b.Print("  Button Anchor Reset : |cff8888ff/hr resetbuttons|r")elseif a7=="holdaotd"then HeroRotationCharDB.Toggles[10]=not HeroRotationCharDB.Toggles[10]b.Print("Army of the Dead is now "..(HeroRotationCharDB.Toggles[10]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="holdsacpac"then HeroRotationCharDB.Toggles[11]=not HeroRotationCharDB.Toggles[11]b.Print("Sacrifical Pact is now "..(HeroRotationCharDB.Toggles[11]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="stopautoswap"then HeroRotationCharDB.Toggles[12]=not HeroRotationCharDB.Toggles[12]b.Print("Auto Swap is now "..(HeroRotationCharDB.Toggles[12]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="amz"then HeroRotationCharDB.Toggles[13]=not HeroRotationCharDB.Toggles[13]b.Print("Anti-Magic Zone Queue is now "..(HeroRotationCharDB.Toggles[13]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="deathgrip"then HeroRotationCharDB.Toggles[14]=not HeroRotationCharDB.Toggles[14]b.Print("Death Grip Queue is now "..(HeroRotationCharDB.Toggles[14]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holdpot"then HeroRotationCharDB.Toggles[15]=not HeroRotationCharDB.Toggles[15]b.Print("DPS Pots are now "..(HeroRotationCharDB.Toggles[15]and"|cffff0000disabled|r."or"|cff00ff00enabled|r. Requires Show:Potions checked in settings"))elseif a7=="asphyxiate"then HeroRotationCharDB.Toggles[16]=not HeroRotationCharDB.Toggles[16]b.Print("Asphyxiate Queue is now "..(HeroRotationCharDB.Toggles[16]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="funnelaoe"then HeroRotationCharDB.Toggles[20]=not HeroRotationCharDB.Toggles[20]b.Print("Funnel AoE is now "..(HeroRotationCharDB.Toggles[20]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="holdvanish"then HeroRotationCharDB.Toggles[21]=not HeroRotationCharDB.Toggles[21]b.Print("Vanish is now "..(HeroRotationCharDB.Toggles[21]and"|cffff0000disabled|r."or"|cff00ff00enabled|r. Requires Use Vanish checked in settings"))elseif a7=="cheapshot"then HeroRotationCharDB.Toggles[22]=not HeroRotationCharDB.Toggles[22]b.Print("Cheap Shot Queue is now "..(HeroRotationCharDB.Toggles[22]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="kidney"then HeroRotationCharDB.Toggles[23]=not HeroRotationCharDB.Toggles[23]b.Print("Kidney Shot Queue is now "..(HeroRotationCharDB.Toggles[23]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="blind"then HeroRotationCharDB.Toggles[24]=not HeroRotationCharDB.Toggles[24]b.Print("Blind Queue is now "..(HeroRotationCharDB.Toggles[24]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="sap"then HeroRotationCharDB.Toggles[25]=not HeroRotationCharDB.Toggles[25]b.Print("Sap Queue is now "..(HeroRotationCharDB.Toggles[25]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="shurikentornado"then HeroRotationCharDB.Toggles[26]=not HeroRotationCharDB.Toggles[26]b.Print("Shuriken Tornado Queue is now "..(HeroRotationCharDB.Toggles[26]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="feint"then HeroRotationCharDB.Toggles[27]=not HeroRotationCharDB.Toggles[27]b.Print("Feint Queue is now "..(HeroRotationCharDB.Toggles[27]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="flagellation"then HeroRotationCharDB.Toggles[28]=not HeroRotationCharDB.Toggles[28]b.Print("Flagellation Queue is now "..(HeroRotationCharDB.Toggles[28]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holdshurikentornado"then HeroRotationCharDB.Toggles[29]=not HeroRotationCharDB.Toggles[29]b.Print("Shuriken Tornado is now "..(HeroRotationCharDB.Toggles[29]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="racial"then HeroRotationCharDB.Toggles[30]=not HeroRotationCharDB.Toggles[30]b.Print("Racial Ability Queue is now "..(HeroRotationCharDB.Toggles[30]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holdwdp"then HeroRotationCharDB.Toggles[31]=not HeroRotationCharDB.Toggles[31]b.Print("Whirling Dragon Punch is now "..(HeroRotationCharDB.Toggles[31]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="holdfsk"then HeroRotationCharDB.Toggles[32]=not HeroRotationCharDB.Toggles[32]b.Print("Flying Serpant Kick is now "..(HeroRotationCharDB.Toggles[32]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="holdfof"then HeroRotationCharDB.Toggles[33]=not HeroRotationCharDB.Toggles[33]b.Print("Fist of Fury is now "..(HeroRotationCharDB.Toggles[33]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="legsweep"then HeroRotationCharDB.Toggles[34]=not HeroRotationCharDB.Toggles[34]b.Print("Leg Sweep Queue is now "..(HeroRotationCharDB.Toggles[34]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="paralysis"then HeroRotationCharDB.Toggles[35]=not HeroRotationCharDB.Toggles[35]b.Print("Paralysis Queue is now "..(HeroRotationCharDB.Toggles[35]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="ringofpeace"then HeroRotationCharDB.Toggles[36]=not HeroRotationCharDB.Toggles[36]b.Print("Ring of Peace Queue is now "..(HeroRotationCharDB.Toggles[36]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="bonedust"then HeroRotationCharDB.Toggles[37]=not HeroRotationCharDB.Toggles[37]b.Print("Bone Dust Brew Queue is now "..(HeroRotationCharDB.Toggles[37]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="cancelfof"then HeroRotationCharDB.Toggles[38]=not HeroRotationCharDB.Toggles[38]b.Print("Cancelling of Fists of Fury is now "..(HeroRotationCharDB.Toggles[38]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="holdmovement"then HeroRotationCharDB.Toggles[40]=not HeroRotationCharDB.Toggles[40]b.Print("Fel Rush and Vengeful Retreat are now "..(HeroRotationCharDB.Toggles[40]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="imprison"then HeroRotationCharDB.Toggles[41]=not HeroRotationCharDB.Toggles[41]b.Print("Imprison Queue is now "..(HeroRotationCharDB.Toggles[41]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holdimmolation"then HeroRotationCharDB.Toggles[42]=not HeroRotationCharDB.Toggles[42]b.Print("Immolation Aura is now "..(HeroRotationCharDB.Toggles[42]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="holdfelblade"then HeroRotationCharDB.Toggles[43]=not HeroRotationCharDB.Toggles[43]b.Print("Fel Blade is now "..(HeroRotationCharDB.Toggles[43]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="consumemagic"then HeroRotationCharDB.Toggles[44]=not HeroRotationCharDB.Toggles[44]b.Print("Consume Magic is now "..(HeroRotationCharDB.Toggles[44]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="feleruption"then HeroRotationCharDB.Toggles[45]=not HeroRotationCharDB.Toggles[45]b.Print("Fel Eruption Queue is now "..(HeroRotationCharDB.Toggles[45]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="chaosnova"then HeroRotationCharDB.Toggles[46]=not HeroRotationCharDB.Toggles[46]b.Print("Chaos Nova Queue is now "..(HeroRotationCharDB.Toggles[46]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holdeyebeam"then HeroRotationCharDB.Toggles[47]=not HeroRotationCharDB.Toggles[47]b.Print("Eye Beam is now "..(HeroRotationCharDB.Toggles[47]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="felrush"then HeroRotationCharDB.Toggles[48]=not HeroRotationCharDB.Toggles[48]b.Print("Fel Rush Queue is now "..(HeroRotationCharDB.Toggles[48]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="darkness"then HeroRotationCharDB.Toggles[49]=not HeroRotationCharDB.Toggles[49]b.Print("Darkness Queue is now "..(HeroRotationCharDB.Toggles[49]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="gouge"then HeroRotationCharDB.Toggles[50]=not HeroRotationCharDB.Toggles[50]b.Print("Gouge Queue is now "..(HeroRotationCharDB.Toggles[50]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="bladerushmelee"then HeroRotationCharDB.Toggles[51]=not HeroRotationCharDB.Toggles[51]b.Print("Blade Rush Melee Only is now "..(HeroRotationCharDB.Toggles[51]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="holdkillingspree"then HeroRotationCharDB.Toggles[52]=not HeroRotationCharDB.Toggles[52]b.Print("Killing Spree is now "..(HeroRotationCharDB.Toggles[52]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="grapplinghook"then HeroRotationCharDB.Toggles[53]=not HeroRotationCharDB.Toggles[53]b.Print("Grappling Hook Queue is now "..(HeroRotationCharDB.Toggles[53]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holdshiv"then HeroRotationCharDB.Toggles[54]=not HeroRotationCharDB.Toggles[54]b.Print("Shiv dispell is now "..(HeroRotationCharDB.Toggles[54]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="forceaoe"then HeroRotationCharDB.Toggles[60]=not HeroRotationCharDB.Toggles[60]b.Print("ForceAoE is now "..(HeroRotationCharDB.Toggles[60]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="massdispel"then HeroRotationCharDB.Toggles[61]=not HeroRotationCharDB.Toggles[61]b.Print("Mass Dispel Queue is now "..(HeroRotationCharDB.Toggles[61]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="shackleundead"then HeroRotationCharDB.Toggles[62]=not HeroRotationCharDB.Toggles[62]b.Print("Shackle Undead Queue is now "..(HeroRotationCharDB.Toggles[62]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="startweave"then HeroRotationCharDB.Toggles[70]=not HeroRotationCharDB.Toggles[70]b.Print("Weaving is now "..(HeroRotationCharDB.Toggles[70]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="holdincarn"then HeroRotationCharDB.Toggles[71]=not HeroRotationCharDB.Toggles[71]b.Print("Incarn/Berserk is now "..(HeroRotationCharDB.Toggles[71]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="autotaunt"then HeroRotationCharDB.Toggles[72]=not HeroRotationCharDB.Toggles[72]b.Print("AutoTaunt is now "..(HeroRotationCharDB.Toggles[72]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="vortex"then HeroRotationCharDB.Toggles[73]=not HeroRotationCharDB.Toggles[73]b.Print("Ursol's Vortex Queue is now "..(HeroRotationCharDB.Toggles[73]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="typhoon"then HeroRotationCharDB.Toggles[74]=not HeroRotationCharDB.Toggles[74]b.Print("Typhoon Queue is now "..(HeroRotationCharDB.Toggles[74]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="stampedingroar"then HeroRotationCharDB.Toggles[75]=not HeroRotationCharDB.Toggles[75]b.Print("Stampeding Roar Queue is now "..(HeroRotationCharDB.Toggles[75]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="incapacitatingroar"then HeroRotationCharDB.Toggles[76]=not HeroRotationCharDB.Toggles[76]b.Print("Incapacitating Roar Queue is now "..(HeroRotationCharDB.Toggles[76]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="mightybash"then HeroRotationCharDB.Toggles[77]=not HeroRotationCharDB.Toggles[77]b.Print("Mighty Bash Queue is now "..(HeroRotationCharDB.Toggles[77]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="zoomzoom"then HeroRotationCharDB.Toggles[78]=not HeroRotationCharDB.Toggles[78]b.Print("ZoomZoom Mode is now "..(HeroRotationCharDB.Toggles[78]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))elseif a7=="entanglingroot"then HeroRotationCharDB.Toggles[79]=not HeroRotationCharDB.Toggles[79]b.Print("Entangling Root Queue is now "..(HeroRotationCharDB.Toggles[79]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="gorefiend"then HeroRotationCharDB.Toggles[80]=not HeroRotationCharDB.Toggles[80]b.Print("Gorefiend's Grasp Queue is now "..(HeroRotationCharDB.Toggles[80]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="controlundead"then HeroRotationCharDB.Toggles[81]=not HeroRotationCharDB.Toggles[81]b.Print("Control Undead Queue is now "..(HeroRotationCharDB.Toggles[81]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holddancingruneweapon"then HeroRotationCharDB.Toggles[82]=not HeroRotationCharDB.Toggles[82]b.Print("Dancing Rune Weapon is now "..(HeroRotationCharDB.Toggles[82]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="holddeathanddecay"then HeroRotationCharDB.Toggles[83]=not HeroRotationCharDB.Toggles[83]b.Print("Death and Decay is now "..(HeroRotationCharDB.Toggles[83]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="holdearthelemental"then HeroRotationCharDB.Toggles[90]=not HeroRotationCharDB.Toggles[90]b.Print("Earth Elemental is now "..(HeroRotationCharDB.Toggles[90]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="capacitortotem"then HeroRotationCharDB.Toggles[91]=not HeroRotationCharDB.Toggles[91]b.Print("Capacitor Totem Queue is now "..(HeroRotationCharDB.Toggles[91]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="healingstreamtotem"then HeroRotationCharDB.Toggles[92]=not HeroRotationCharDB.Toggles[92]b.Print("Healing Stream Totem Queue is now "..(HeroRotationCharDB.Toggles[92]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="tremortotem"then HeroRotationCharDB.Toggles[93]=not HeroRotationCharDB.Toggles[93]b.Print("Tremor Stream Totem Queue is now "..(HeroRotationCharDB.Toggles[93]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="windrushtotem"then HeroRotationCharDB.Toggles[94]=not HeroRotationCharDB.Toggles[94]b.Print("Wind Rush Totem Queue is now "..(HeroRotationCharDB.Toggles[94]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="hex"then HeroRotationCharDB.Toggles[95]=not HeroRotationCharDB.Toggles[95]b.Print("Hex Queue is now "..(HeroRotationCharDB.Toggles[95]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="faetransfusion"then HeroRotationCharDB.Toggles[96]=not HeroRotationCharDB.Toggles[96]b.Print("Fae Transfusion Queue is now "..(HeroRotationCharDB.Toggles[96]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="usepurge"then HeroRotationCharDB.Toggles[97]=not HeroRotationCharDB.Toggles[97]b.Print("Purge Use is now "..(HeroRotationCharDB.Toggles[97]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holdfrozenorb"then HeroRotationCharDB.Toggles[100]=not HeroRotationCharDB.Toggles[100]b.Print("Frozen Orb is now "..(HeroRotationCharDB.Toggles[100]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="holdfrostwyrm"then HeroRotationCharDB.Toggles[110]=not HeroRotationCharDB.Toggles[110]b.Print("Frostwyrm's Fury is now "..(HeroRotationCharDB.Toggles[110]and"|cffff0000disabled|r."or"|cff00ff00enabled|r."))elseif a7=="bindingshot"then HeroRotationCharDB.Toggles[120]=not HeroRotationCharDB.Toggles[120]b.Print("Binding Shot Queue is now "..(HeroRotationCharDB.Toggles[120]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="freezingtrap"then HeroRotationCharDB.Toggles[121]=not HeroRotationCharDB.Toggles[121]b.Print("Freezing Trap Queue is now "..(HeroRotationCharDB.Toggles[121]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="intimidation"then HeroRotationCharDB.Toggles[122]=not HeroRotationCharDB.Toggles[122]b.Print("Intimidation Queue is now "..(HeroRotationCharDB.Toggles[122]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="flare"then HeroRotationCharDB.Toggles[123]=not HeroRotationCharDB.Toggles[123]b.Print("Flare Queue is now "..(HeroRotationCharDB.Toggles[123]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="tartrap"then HeroRotationCharDB.Toggles[124]=not HeroRotationCharDB.Toggles[124]b.Print("Tar Trap Queue is now "..(HeroRotationCharDB.Toggles[124]and"|cff00ff00on|r."or"|cffff0000off|r."))elseif a7=="holdmisdirection"then HeroRotationCharDB.Toggles[125]=not HeroRotationCharDB.Toggles[125]b.Print("Misdirection is now "..(HeroRotationCharDB.Toggles[125]and"|cffff0000disabled|r."or"|cff00ff00enabled|r. (Requires AutoMisdirect checked in settings)"))elseif a7=="huntersmark"then HeroRotationCharDB.Toggles[140]=not HeroRotationCharDB.Toggles[140]b.Print("Hunter's Mark Queue is now "..(HeroRotationCharDB.Toggles[140]and"|cff00ff00on|r."or"|cffff0000off|r."))else b.Print("Invalid arguments.")b.Print("Type |cff8888ff/hr help|r for more infos.")end end;SLASH_HEROROTATION1="/hr"SLASH_HEROROTATION2="/ar"SlashCmdList["HEROROTATION"]=b.CmdHandler;function b.CDsON()return HeroRotationCharDB.Toggles[1]end;local aa,ab;if m then local ac,ad={},{}o=true;DBM_TIMER_PULL=_G.DBM_CORE_L.TIMER_PULL;m:RegisterCallback("DBM_TimerStart",function(y,ae,af,ag,ah,ai,aj,ak)local al;if type(ag)=="string"then al=toNum[ag:match("%d+")]else al=ag end;if not ac[ae]then ac[ae]={text=af,start=GetTime(),duration=al}else ac[ae].text=af;ac[ae].start=GetTime()ac[ae].duration=al end;if aj then ac[ae].spellid=aj;ad[aj]=ac[ae]end end)m:RegisterCallback("DBM_TimerStop",function(y,ae)if ac[ae]and ac[ae].spellid then ad[ac[ae].spellid]=nil end;ac[ae]=nil end)aa=function(af)if af then for ae,am in pairs(ac)do if am.text:match(af)then local an=am.start+am.duration;local ao=an-GetTime()if ao<0 then ao=0 end;return ao,an end end else error("Bad argument 'text' (nil value) for function DBM_GetTimeRemaining")end;return 0,0 end;ab=function(ap)if ad[ap]then local an=ad[ap].start+ad[ap].duration;local ao=an-GetTime()if ao<0 then ao=0 end;return ao,an end;return 0,0 end;hooksecurefunc(m,"StartCombat",function(m,aq,ar,as)if as~="TIMER_RECOVERY"then local at=aq.localization.general.name;local au=aq.id;if at then q[at]=aq;q[at].AddonBaseName="DBM"end;if au then q[au]=aq;q[au].AddonBaseName="DBM"end end end)hooksecurefunc(m,"EndCombat",function(m,aq)local at=aq.localization.general.name or""local au=aq.id or""q[at]=nil;q[au]=nil end)end;function b.BossMods:HasAnyAddon()return o or HasBigWigs end;function b.BossMods:GetPullTimer()local ao,an=0,0;if self:HasAnyAddon()then local av,aw=0,0;local ax,ay=0,0;if o then av,aw=aa(DBM_TIMER_PULL)end;if self.HasBigWigs then ax,ay=BigWigs_GetTimeRemaining(BIGWIGS_TIMER_PULL)end;if av>ax then ao=av;an=aw else ao=ax;an=ay end end;return ao end;do local az={[120651]=true}function b.AoEON()return HeroRotationCharDB.Toggles[2]and not az[h:NPCID()]end end;function b.BossMods:GetTimer(aA)local ao,an=0,0;if aA and self:HasAnyAddon()then local av,aw=0,0;local ax,ay=0,0;if o then if type(aA)=="string"then av,aw=aa(aA)else av,aw=ab(aA)end end;if self.HasBigWigs then ax,ay=BigWigs_GetTimeRemaining(aA)end;if av>ax then ao=av;an=aw else ao=ax;an=ay end end;return ao,an end;function b.BossMods:IsEngage(aA)if self:HasAnyAddon()then local aB=aA and aA;for aC,aD in pairs(q)do if(not aB or aC:match(aB))and(aD.AddonBaseName=="DBM"and aD.inCombat or aD.AddonBaseName=="BigWigs"and aD.isEngaged)then return true,aC end end end end;function b.ON()return HeroRotationCharDB.Toggles[3]end;function b.Locked()return HeroRotationDB.Locked end;function b.IsBoomKaBitch()p=true end