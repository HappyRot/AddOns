local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.MouseOver;local j=d.Spell;local k=d.MultiSpell;local l=d.Item;local m=d.Utils.MergeTableByKey;local n=HeroRotation;local o=n.Commons.Everyone;local p=math.min;local pairs=pairs;local q={}local r=HeroRotationCharDB.Toggles[12]n.Commons.Rogue=q;local s={General=n.GUISettings.General,Commons=n.GUISettings.APL.Rogue.Commons,Assassination=n.GUISettings.APL.Rogue.Assassination,Outlaw=n.GUISettings.APL.Rogue.Outlaw,Subtlety=n.GUISettings.APL.Rogue.Subtlety}local t=0;local u=0;if not j.Rogue then j.Rogue={}end;j.Rogue.Commons={AncestralCall=j(274738),ArcanePulse=j(260364),ArcaneTorrent=j(25046),BagofTricks=j(312411),Berserking=j(26297),BloodFury=j(20572),Fireblood=j(265221),LightsJudgment=j(255647),Shadowmeld=j(58984),CloakofShadows=j(31224),CrimsonVial=j(185311),Evasion=j(5277),Feint=j(1966),Blind=j(2094),CheapShot=j(1833),Kick=j(1766),KidneyShot=j(408),Sap=j(6770),Shadowstep=j(36554),Sprint=j(2983),TricksoftheTrade=j(57934),MasterAssassinsMark=j(340094),EchoingReprimand=j(323547),EchoingReprimand2=j(323558),EchoingReprimand3=j(323559),EchoingReprimand4=j(323560),EchoingReprimand5=j(354838),Flagellation=j(323654),FlagellationBuff=j(345569),Fleshcraft=j(324631),Sepsis=j(328305),SepsisBuff=j(347037),SerratedBoneSpike=j(328547),SerratedBoneSpikeDebuff=j(324073),KevinsOozeling=j(352110),KevinsWrathDebuff=j(352528),LeadbyExample=j(342156),LeadbyExampleBuff=j(342181),MarrowedGemstoneBuff=j(327069),PustuleEruption=j(351094),VolatileSolvent=j(323074),ChaosBaneBuff=j(355829),PoolEnergy=j(999910),SinfulRevelationDebuff=j(324260)}j.Rogue.Assassination=m(j.Rogue.Commons,{Ambush=j(8676),DeadlyPoison=j(2823),DeadlyPoisonDebuff=j(2818),Envenom=j(32645),FanofKnives=j(51723),Garrote=j(703),Mutilate=j(1329),PoisonedKnife=j(185565),Rupture=j(1943),SliceandDice=j(315496),Stealth=j(1784),Stealth2=j(115191),Vanish=j(1856),VanishBuff=j(11327),Vendetta=j(79140),WoundPoison=j(8679),WoundPoisonDebuff=j(8680),BlindsideBuff=j(121153),CrimsonTempest=j(121411),DeeperStratagem=j(193531),Elusiveness=j(79008),Exsanguinate=j(200806),HiddenBladesBuff=j(270070),InternalBleeding=j(154953),MarkedforDeath=j(137619),MasterAssassin=j(255989),MasterAssassinBuff=j(256735),Nightstalker=j(14062),PreyontheWeak=j(131511),PreyontheWeakDebuff=j(255909),Shiv=j(5938),ShivDebuff=j(319504),Subterfuge=j(108208),SubterfugeBuff=j(115192),VenomRush=j(152152),DeathfromAbove=j(269513),Maneuverability=j(197000),Neurotoxin=j(206328),SmokeBomb=j(212182)})j.Rogue.Outlaw=m(j.Rogue.Commons,{AncestralCall=j(274738),ArcanePulse=j(260364),ArcaneTorrent=j(25046),BagofTricks=j(312411),Berserking=j(26297),BloodFury=j(20572),Fireblood=j(265221),LightsJudgment=j(255647),Shadowmeld=j(58984),AdrenalineRush=j(13750),Ambush=j(8676),BetweentheEyes=j(315341),BladeFlurry=j(13877),Dispatch=j(2098),Elusiveness=j(79008),Opportunity=j(195627),PistolShot=j(185763),RolltheBones=j(315508),Shiv=j(5938),SinisterStrike=j(193315),SliceandDice=j(315496),Stealth=j(1784),Vanish=j(1856),VanishBuff=j(11327),AcrobaticStrikes=j(196924),BladeRush=j(271877),DeeperStratagem=j(193531),Dreadblades=j(343142),GhostlyStrike=j(196937),KillingSpree=j(51690),LoadedDiceBuff=j(256171),MarkedforDeath=j(137619),PreyontheWeak=j(131511),PreyontheWeakDebuff=j(255909),QuickDraw=j(196938),CloakofShadows=j(31224),CrimsonVial=j(185311),Evasion=j(5277),Feint=j(1966),Blind=j(2094),CheapShot=j(1833),Gouge=j(1776),GrapplingHook=j(195457),Kick=j(1766),KidneyShot=j(408),Sap=j(6770),Sprint=j(2983),TricksoftheTrade=j(57934),DeathfromAbove=j(269513),Dismantle=j(207777),Maneuverability=j(197000),PlunderArmor=j(198529),SmokeBomb=j(212182),ThickasThieves=j(221622),Broadside=j(193356),BuriedTreasure=j(199600),GrandMelee=j(193358),RuthlessPrecision=j(193357),SkullandCrossbones=j(199603),TrueBearing=j(193359),EchoingReprimand=j(323547),Flagellation=j(323654),FlagellationBuff=j(345569),Sepsis=j(328305),SepsisBuff=j(347037),SerratedBoneSpike=j(328547),SerratedBoneSpikeDebuff=j(324073),Ambidexterity=j(341542),CountTheOdds=j(341546),ConcealedBlunderbuss=j(340587),DeathlyShadowsBuff=j(341202),GreenskinsWickers=j(340573),MasterAssassinsMark=j(340094),PoolEnergy=j(999910),SinfulRevelationDebuff=j(324260)})j.Rogue.Subtlety=m(j.Rogue.Commons,{AncestralCall=j(274738),ArcanePulse=j(260364),ArcaneTorrent=j(25046),BagofTricks=j(312411),Berserking=j(26297),BloodFury=j(20572),Fireblood=j(265221),LightsJudgment=j(255647),Shadowmeld=j(58984),Backstab=j(53),BlackPowder=j(319175),Elusiveness=j(79008),Eviscerate=j(196819),FindWeaknessDebuff=j(316220),Rupture=j(1943),ShadowBlades=j(121471),ShadowDance=j(185313),ShadowDanceBuff=j(185422),Shadowstrike=j(185438),Shiv=j(5938),ShurikenStorm=j(197835),ShurikenToss=j(114014),SliceandDice=j(315496),Stealth=j(1784),Stealth2=j(115191),SymbolsofDeath=j(212283),SymbolsofDeathCrit=j(227151),Vanish=j(1856),VanishBuff=j(11327),VanishBuff2=j(115193),Alacrity=j(193539),DarkShadow=j(245687),DeeperStratagem=j(193531),EnvelopingShadows=j(238104),Gloomblade=j(200758),MarkedforDeath=j(137619),MasterofShadows=j(196976),Nightstalker=j(14062),PreyontheWeak=j(131511),PreyontheWeakDebuff=j(255909),Premeditation=j(343160),PremeditationBuff=j(343173),SecretTechnique=j(280719),ShadowFocus=j(108209),ShurikenTornado=j(277925),Subterfuge=j(108208),Vigor=j(14983),Weaponmaster=j(193537),CloakofShadows=j(31224),CrimsonVial=j(185311),Evasion=j(5277),Feint=j(1966),Blind=j(2094),CheapShot=j(1833),Kick=j(1766),KidneyShot=j(408),Sap=j(6770),Shadowstep=j(36554),Sprint=j(2983),TricksoftheTrade=j(57934),ColdBlood=j(213981),DeathfromAbove=j(269513),Maneuverability=j(197000),ShadowyDuel=j(207736),SmokeBomb=j(212182),VeilofMidnight=j(198952),EchoingReprimand=j(323547),EchoingReprimand2=j(323558),EchoingReprimand3=j(323559),EchoingReprimand4=j(323560),EchoingReprimand5=j(354838),Flagellation=j(323654),FlagellationBuff=j(345569),Sepsis=j(328305),SepsisBuff=j(347037),SerratedBoneSpike=j(328547),SerratedBoneSpikeDebuff=j(324073),DeeperDaggers=j(341549),PerforatedVeinsBuff=j(341572),LeadbyExample=j(342156),LeadbyExampleBuff=j(342181),DeathlyShadowsBuff=j(341202),FinalityBlackPowder=j(340603),FinalityEviscerate=j(340600),FinalityRupture=j(340601),TheRottenBuff=j(341134),PoolEnergy=j(999910),SinfulRevelationDebuff=j(324260)})if not l.Rogue then l.Rogue={}end;l.Rogue.Assassination={GalecallersBoon=l(159614,{13,14}),LustrousGoldenPlumage=l(159617,{13,14}),ComputationDevice=l(167555,{13,14}),VigorTrinket=l(165572,{13,14}),FontOfPower=l(169314,{13,14}),RazorCoral=l(169311,{13,14})}l.Rogue.Outlaw={ComputationDevice=l(167555,{13,14}),VigorTrinket=l(165572,{13,14}),FontOfPower=l(169314,{13,14}),RazorCoral=l(169311,{13,14}),MistcallerOcarina=l(178715,{13,14}),PotionofSpectralAgility=l(171270),Healthstone=l(5512),HealPot=l(171267),PhialofSerenity=l(177278)}l.Rogue.Subtlety={ComputationDevice=l(167555,{13,14}),VigorTrinket=l(165572,{13,14}),FontOfPower=l(169314,{13,14}),RazorCoral=l(169311,{13,14}),MistcallerOcarina=l(178715,{13,14}),PotionofSpectralAgility=l(171270),Healthstone=l(5512),HealPot=l(171267),PhialofSerenity=l(177278)}function q.Stealth(v,w)u=0;t=0;if(s.Commons.StealthOOC=="Always"or s.Commons.StealthOOC=="w/ Target"and o.TargetIsValid())and v:IsCastable()and g:StealthDown()and not g:DebuffUp(j(319070))then if n.Cast(v,nil)then t=200;return"Cast Stealth (OOC)"end else t=0 end;return false end;do local x=j(185311)function q.CrimsonVial()u=0;t=0;if x:IsCastable()and g:HealthPercentage()<=s.Commons.CrimsonVialHP then if n.Cast(x,nil)then t=201;return"Cast Crimson Vial (Defensives)"end end;return false end end;do local y=j(1966)function q.Feint()u=0;t=0;if y:IsCastable()and g:BuffDown(y)and g:HealthPercentage()<=s.Commons.FeintHP then if n.Cast(y,nil)then t=202;return"Cast Feint (Defensives)"end end end end;do local z=j(3408)local A=j(2823)local B=j(315584)local C=j(5761)local D=j(8679)function q.Poisons()u=0;t=0;local E=g:AffectingCombat()and 180 or 900;local F;F=g:BuffRemains(D)if F>0 then if F<E then if n.Cast(D)then t=203;return"Wound Poison Refresh"end end else if A:IsAvailable()then F=g:BuffRemains(A)if F<E then if n.Cast(A)then t=204;return"Deadly Poison Refresh"end end else F=g:BuffRemains(B)if F<E then if n.Cast(B)then t=205;return"Instant Poison Refresh"end end end end;F=g:BuffRemains(z)if F>0 then if F<E then if n.Cast(z)then t=206;return"Crippling Poison Refresh"end end else F=g:BuffRemains(C)if F<E then if n.Cast(C)then t=204;return"Numbing Poison Refresh"end end end end end;function q.MfDSniping(G)u=0;t=0;if G:IsCastable()and(g:AffectingCombat()or HeroRotationCharDB.Toggles[6])then local H,I=nil,60;local J=i:IsInRange(30)and i:TimeToDie()or 11111;for K,L in pairs(g:GetEnemiesInRange(30))do local M=L:TimeToDie()if not L:IsMfDBlacklisted()and M<g:ComboPointsDeficit()*1.5 and M<I then if J-M>1 then H,I=L,M else H,I=i,J end end end;if H and H:GUID()~=h:GUID()then n.CastLeftNameplate(H,G)if H:GUID()==f("mouseover"):GUID()and s.Subtlety.TargetSwap=="Mouseover"then u=1117 elseif s.Subtlety.TargetSwap=="AutoSwap"and H:GUID()~=h:GUID()and not r then u=999 end end end end;function q.CanDoTUnit(L,N)return o.CanDoTUnit(L,N)end;do local O=j(193531)function q.CPMaxSpend()return O:IsAvailable()and 6 or 5 end end;function q.CPSpend()return p(g:ComboPoints(),q.CPMaxSpend())end;function q.TimeToNextTornado()if g:BuffUp(S.ShurikenTornado)then if g:BuffRemains(S.ShurikenTornado)<=4 and g:BuffRemains(S.ShurikenTornado)>3 then return g:BuffRemains(S.ShurikenTornado)-3 elseif g:BuffRemains(S.ShurikenTornado)<=3 and g:BuffRemains(S.ShurikenTornado)>2 then return g:BuffRemains(S.ShurikenTornado)-2 elseif g:BuffRemains(S.ShurikenTornado)<=2 and g:BuffRemains(S.ShurikenTornado)>1 then return g:BuffRemains(S.ShurikenTornado)-1 elseif g:BuffRemains(S.ShurikenTornado)<=1 then return g:BuffRemains(S.ShurikenTornado)end end end;do local P=j(323558)local Q=j(323559)local R=j(323560)function q.AnimachargedCP()if g:BuffUp(j.Rogue.Commons.EchoingReprimand2)then return 2 elseif g:BuffUp(j.Rogue.Commons.EchoingReprimand3)then return 3 elseif g:BuffUp(j.Rogue.Commons.EchoingReprimand4)then return 4 elseif g:BuffUp(j.Rogue.Commons.EchoingReprimand5)then return 5 end;return-1 end;function q.EffectiveComboPoints(T)if T==2 and g:BuffUp(P)or T==3 and g:BuffUp(j.Rogue.Commons.EchoingReprimand3)or T==4 and g:BuffUp(j.Rogue.Commons.EchoingReprimand4)or T==5 and g:BuffUp(j.Rogue.Commons.EchoingReprimand5)then return 7 else return T end end end;do local U=j.Rogue.Assassination.DeadlyPoisonDebuff;local V=j.Rogue.Assassination.WoundPoisonDebuff;function q.Poisoned(L)return(L:DebuffUp(U)or L:DebuffUp(V))and true or false end end;do local U=j.Rogue.Assassination.DeadlyPoisonDebuff;local V=j.Rogue.Assassination.WoundPoisonDebuff;function q.PoisonRemains(L)return L:DebuffUp(U)and L:DebuffRemains(U)or L:DebuffUp(V)and L:DebuffRemains(V)or 0 end end;do local W=j.Rogue.Assassination.Garrote;local X=j.Rogue.Assassination.Rupture;local Y=j.Rogue.Assassination.CrimsonTempest;local Z=j.Rogue.Assassination.InternalBleeding;function q.Bleeds()return(h:DebuffUp(W)and 1 or 0)+(h:DebuffUp(X)and 1 or 0)+(h:DebuffUp(Y)and 1 or 0)+(h:DebuffUp(Z)and 1 or 0)end end;do local W=j.Rogue.Assassination.Garrote;local Z=j.Rogue.Assassination.InternalBleeding;local X=j.Rogue.Assassination.Rupture;local _=0;function q.PoisonedBleeds()_=0;for K,L in pairs(g:GetEnemiesInRange(50))do if q.Poisoned(L)then if L:DebuffUp(W)then _=_+1 end;if L:DebuffUp(Z)then _=_+1 end;if L:DebuffUp(X)then _=_+1 end end end;return _ end end;do local a0,a1=j(340094),4;function q.MasterAssassinsMarkRemains()if g:BuffRemains(a0)<0 then return g:GCDRemains()+a1 else return g:BuffRemains(a0)end end end;function q.ReturnSpell()if t==0 then return 0 else return t end end;function q.ReturnSpellMO()if u==0 then return 0 else return u end end