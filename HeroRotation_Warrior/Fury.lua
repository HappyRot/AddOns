local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=d.Spell;local j=d.Item;local k=HeroRotation;local l=k.Cast;local m=k.AoEON;local n=k.CDsON;local o=k.Commons.Everyone.num;local p=k.Commons.Everyone.bool;local q=i.Warrior.Fury;local r=j.Warrior.Fury;local s={}local t;local u,v;local w=0;local x=0;local y=11111;local z=11111;d:RegisterForEvent(function()y=11111;z=11111 end,"PLAYER_REGEN_ENABLED")local A,B;local C;local D=k.Commons.Everyone;local E={General=k.GUISettings.General,Commons=k.GUISettings.APL.Warrior.Commons,Fury=k.GUISettings.APL.Warrior.Fury}local F={{q.StormBolt,"Cast Storm Bolt (Interrupt)",function()return true end}}local function o(G)if G then return 1 else return 0 end end;local function p(G)return G~=0 end;local function H()if q.BerserkerStance:IsCastable()and g:BuffDown(q.BerserkerStance,true)then if l(q.BerserkerStance)then x=q.BerserkerStance:ID()return"berserker_stance precombat 2"end end;if q.Charge:IsReady()and Opener and not C and E.Fury.UseCharge then if l(q.Charge,nil)then x=q.Charge:ID()return"charge precombat 12"end end;if q.Avatar:IsCastable()and not q.TitansTorment:IsAvailable()then if l(q.Avatar,nil)then x=q.Avatar:ID()return"avatar precombat 6"end end;if q.Recklessness:IsCastable()and not q.RecklessAbandon:IsAvailable()then if l(q.Recklessness,nil)then x=q.Recklessness:ID()x=q.Recklessness:ID()return"recklessness precombat 8"end end;if q.Bloodthirst:IsCastable()and C then if l(q.Bloodthirst,nil,nil,not C)then x=q.Bloodthirst:ID()x=q.Bloodthirst:ID()return"bloodthirst precombat 10"end end end;local function I()if n()and q.Recklessness:IsCastable()and(B>1 or z<12)then if l(q.Recklessness,nil)then x=q.Recklessness:ID()return"recklessness multi_target 2"end end;if n()and q.OdynsFury:IsCastable()and(B>1 and q.TitanicRage:IsAvailable()and(g:BuffDown(q.MeatCleaverBuff)or g:BuffUp(q.AvatarBuff)or g:BuffUp(q.RecklessnessBuff)))then if l(q.OdynsFury,nil,nil,not h:IsInMeleeRange(12))then x=q.OdynsFury:ID()return"odyns_fury multi_target 4"end end;if q.Whirlwind:IsCastable()and(B>1 and q.ImprovedWhilwind:IsAvailable()and g:BuffDown(q.MeatCleaverBuff))then if l(q.Whirlwind,nil,nil,not h:IsInMeleeRange(8))then x=q.Whirlwind:ID()return"whirlwind multi_target 6"end end;if q.Execute:IsReady()and(g:BuffUp(q.AshenJuggernautBuff)and g:BuffRemains(q.AshenJuggernautBuff)<g:GCD())then if l(q.Execute,nil,nil,not C)then x=280735;return"execute multi_target 8"end end;if n()and q.ThunderousRoar:IsCastable()and t then if l(q.ThunderousRoar,nil,nil,not h:IsInMeleeRange(12))then x=q.ThunderousRoar:ID()return"thunderous_roar multi_target 10"end end;if n()and q.OdynsFury:IsCastable()and(B>1 and t)then if l(q.OdynsFury,nil,nil,not h:IsInMeleeRange(12))then x=q.OdynsFury:ID()return"odyns_fury multi_target 12"end end;local J=g:CritChancePct()+o(g:BuffUp(q.RecklessnessBuff))*20+g:BuffStack(q.MercilessAssaultBuff)*10+g:BuffStack(q.BloodcrazeBuff)*15;if q.Bloodbath:IsCastable()and(g:HasTier(30,4)and J>=95)then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()x=q.Bloodbath:ID()return"bloodbath multi_target 14"end end;if q.Bloodthirst:IsCastable()and(g:HasTier(30,4)and J>=95 or not q.RecklessAbandon:IsAvailable()and g:BuffUp(q.FuriousBloodthirstBuff)and t)then if l(q.Bloodthirst,nil,nil,not C)then x=q.Bloodthirst:ID()return"bloodthirst multi_target 16"end end;if q.CrushingBlow:IsCastable()and(q.WrathandFury:IsAvailable()and t)then if l(q.CrushingBlow,nil,nil,not C)then x=q.CrushingBlow:ID()return"crushing_blow multi_target 18"end end;if q.Execute:IsReady()and t then if l(q.Execute,nil,nil,not C)then x=280735;return"execute multi_target 20"end end;if n()and q.OdynsFury:IsCastable()and t then if l(q.OdynsFury,nil,nil,not h:IsInMeleeRange(12))then x=q.OdynsFury:ID()return"odyns_fury multi_target 22"end end;if q.Rampage:IsReady()and(g:BuffUp(q.RecklessnessBuff)or g:BuffRemains(q.EnrageBuff)<g:GCD()or g:Rage()>110 and q.OverwhelmingRage:IsAvailable()or g:Rage()>80 and not q.OverwhelmingRage:IsAvailable())then if l(q.Rampage,nil,nil,not C)then x=q.Rampage:ID()return"rampage multi_target 24"end end;if q.Execute:IsReady()then if l(q.Execute,nil,nil,not C)then x=280735;return"execute multi_target 26"end end;if q.Bloodbath:IsCastable()and(t and q.RecklessAbandon:IsAvailable()and not q.WrathandFury:IsAvailable())then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()return"bloodbath multi_target 28"end end;if q.Bloodthirst:IsCastable()and(not t or q.Annihilator:IsAvailable()and g:BuffDown(q.RecklessnessBuff))then if l(q.Bloodthirst,nil,nil,not C)then x=q.Bloodthirst:ID()x=q.Bloodthirst:ID()return"bloodthirst multi_target 30"end end;if q.Onslaught:IsReady()and(not q.Annihilator:IsAvailable()and t or q.Tenderize:IsAvailable())then if l(q.Onslaught,nil,nil,not C)then x=q.Onslaught:ID()return"Onslaught multi_target 32"end end;if q.RagingBlow:IsCastable()and(q.RagingBlow:Charges()>1 and q.WrathandFury:IsAvailable())then if l(q.RagingBlow,nil,nil,not C)then x=q.RagingBlow:ID()return"raging_blow multi_target 34"end end;if q.CrushingBlow:IsCastable()and(q.CrushingBlow:Charges()>1 and q.WrathandFury:IsAvailable())then if l(q.CrushingBlow,nil,nil,not C)then x=q.CrushingBlow:ID()return"crushing_blow multi_target 36"end end;if q.Bloodbath:IsCastable()and(not t or not q.WrathandFury:IsAvailable())then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()return"bloodbath multi_target 38"end end;if q.CrushingBlow:IsCastable()and(t and q.RecklessAbandon:IsAvailable())then if l(q.CrushingBlow,nil,nil,not C)then x=q.CrushingBlow:ID()return"crushing_blow multi_target 40"end end;if q.Bloodthirst:IsCastable()and not q.WrathandFury:IsAvailable()then if l(q.Bloodthirst,nil,nil,not C)then x=q.Bloodthirst:ID()return"bloodthirst multi_target 42"end end;if q.RagingBlow:IsCastable()and q.RagingBlow:Charges()>1 then if l(q.RagingBlow,nil,nil,not C)then x=q.RagingBlow:ID()return"raging_blow multi_target 44"end end;if q.Rampage:IsReady()then if l(q.Rampage,nil,nil,not C)then x=q.Rampage:ID()return"rampage multi_target 46"end end;if q.Slam:IsReady()and q.Annihilator:IsAvailable()then if l(q.Slam,nil,nil,not C)then x=q.Slam:ID()return"slam multi_target 48"end end;if q.Bloodbath:IsCastable()then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()return"bloodbath multi_target 50"end end;if q.RagingBlow:IsCastable()then if l(q.RagingBlow,nil,nil,not C)then x=q.RagingBlow:ID()return"raging_blow multi_target 52"end end;if q.CrushingBlow:IsCastable()then if l(q.CrushingBlow,nil,nil,not C)then x=q.CrushingBlow:ID()return"crushing_blow multi_target 54"end end;if q.Whirlwind:IsCastable()then if l(q.Whirlwind,nil,nil,not h:IsInMeleeRange(8))then x=q.Whirlwind:ID()return"whirlwind multi_target 56"end end end;local function K()if q.Whirlwind:IsCastable()and(B>1 and q.ImprovedWhilwind:IsAvailable()and g:BuffDown(q.MeatCleaverBuff))then if l(q.Whirlwind,nil,nil,not h:IsInMeleeRange(8))then x=q.Whirlwind:ID()return"whirlwind single_target 2"end end;if q.Execute:IsReady()and(g:BuffUp(q.AshenJuggernautBuff)and g:BuffRemains(q.AshenJuggernautBuff)<g:GCD())then if l(q.Execute,nil,nil,not C)then x=280735;return"execute single_target 4"end end;if n()and q.OdynsFury:IsCastable()and(t and(q.DancingBlades:IsAvailable()and g:BuffRemains(q.DancingBladesBuff)<5 or not q.DancingBlades:IsAvailable()))then if l(q.OdynsFury,nil,nil,not h:IsInMeleeRange(12))then x=q.OdynsFury:ID()return"odyns_fury single_target 6"end end;if q.Rampage:IsReady()and(q.AngerManagement:IsAvailable()and(g:BuffUp(q.RecklessnessBuff)or g:BuffRemains(q.EnrageBuff)<g:GCD()or g:RagePercentage()>85))then if l(q.Rampage,nil,nil,not C)then x=q.Rampage:ID()return"rampage single_target 8"end end;local J=g:CritChancePct()+o(g:BuffUp(q.RecklessnessBuff))*20+g:BuffStack(q.MercilessAssaultBuff)*10+g:BuffStack(q.BloodcrazeBuff)*15;if q.Bloodbath:IsCastable()and(g:HasTier(30,4)and J>=95)then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()return"bloodbath single_target 10"end end;if q.Bloodthirst:IsCastable()and(g:HasTier(30,4)and J>=95 or not q.RecklessAbandon:IsAvailable()and g:BuffUp(q.FuriousBloodthirstBuff)and t and(h:DebuffDown(q.GushingWoundDebuff)or g:BuffUp(q.ElysianMightBuff)))then if l(q.Bloodthirst,nil,nil,not C)then x=q.Bloodthirst:ID()return"bloodthirst single_target 12"end end;if q.Bloodbath:IsCastable()and g:HasTier(31,2)then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()return"bloodbath single_target 14"end end;if n()and q.ThunderousRoar:IsCastable()and t then if l(q.ThunderousRoar,nil,nil,not h:IsInMeleeRange(12))then return"thunderous_roar single_target 16"end end;if q.Onslaught:IsReady()and(t or q.Tenderize:IsAvailable())then if l(q.Onslaught,nil,nil,not C)then x=q.Onslaught:ID()return"Onslaught single_target 18"end end;if q.CrushingBlow:IsCastable()and(q.WrathandFury:IsAvailable()and t and g:BuffDown(q.FuriousBloodthirstBuff))then if l(q.CrushingBlow,nil,nil,not C)then x=q.CrushingBlow:ID()return"crushing_blow single_target 20"end end;if q.Execute:IsReady()and(t and g:BuffDown(q.FuriousBloodthirstBuff)and g:BuffUp(q.AshenJuggernautBuff)or g:BuffRemains(q.SuddenDeathBuff)<=g:GCD()and(h:HealthPercentage()>35 and q.Massacre:IsAvailable()or h:HealthPercentage()>20))then if l(q.Execute,nil,nil,not C)then x=280735;return"execute single_target 22"end end;if q.Rampage:IsReady()and(q.RecklessAbandon:IsAvailable()and(g:BuffUp(q.RecklessnessBuff)or g:BuffRemains(q.EnrageBuff)<g:GCD()or g:RagePercentage()>85))then if l(q.Rampage,nil,nil,not C)then x=q.Rampage:ID()return"rampage single_target 26"end end;if q.Execute:IsReady()and t then if l(q.Execute,nil,nil,not C)then x=280735;return"execute single_target 28"end end;if q.Rampage:IsReady()and q.AngerManagement:IsAvailable()then if l(q.Rampage,nil,nil,not C)then x=q.Rampage:ID()return"rampage single_target 24"end end;if q.Execute:IsReady()then if l(q.Execute,nil,nil,not C)then x=280735;return"execute single_target 26"end end;if q.Bloodbath:IsCastable()and(t and q.RecklessAbandon:IsAvailable()and not q.WrathandFury:IsAvailable())then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()return"bloodbath single_target 28"end end;if q.Rampage:IsReady()and(h:HealthPercentage()<35 and q.Massacre:IsAvailable())then if l(q.Rampage,nil,nil,not C)then x=q.Rampage:ID()return"rampage single_target 30"end end;if q.Bloodthirst:IsCastable()and((not t or q.Annihilator:IsAvailable()and g:BuffDown(q.RecklessnessBuff))and g:BuffDown(q.FuriousBloodthirstBuff))then if l(q.Bloodthirst,nil,nil,not C)then x=q.Bloodthirst:ID()return"bloodthirst single_target 32"end end;if q.RagingBlow:IsCastable()and(q.RagingBlow:Charges()>1 and q.WrathandFury:IsAvailable())then if l(q.RagingBlow,nil,nil,not C)then x=q.RagingBlow:ID()return"raging_blow single_target 34"end end;if q.CrushingBlow:IsCastable()and(q.CrushingBlow:Charges()>1 and q.WrathandFury:IsAvailable()and g:BuffDown(q.FuriousBloodthirstBuff))then if l(q.CrushingBlow,nil,nil,not C)then x=q.CrushingBlow:ID()return"crushing_blow single_target 36"end end;if q.Bloodbath:IsCastable()and(not t or not q.WrathandFury:IsAvailable())then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()return"bloodbath single_target 38"end end;if q.CrushingBlow:IsCastable()and(t and q.RecklessAbandon:IsAvailable()and g:BuffDown(q.FuriousBloodthirstBuff))then if l(q.CrushingBlow,nil,nil,not C)then x=q.CrushingBlow:ID()return"crushing_blow single_target 40"end end;if q.Bloodthirst:IsCastable()and(not q.WrathandFury:IsAvailable()and g:BuffDown(q.FuriousBloodthirstBuff))then if l(q.Bloodthirst,nil,nil,not C)then x=q.Bloodthirst:ID()return"bloodthirst single_target 42"end end;if q.RagingBlow:IsCastable()and q.RagingBlow:Charges()>1 then if l(q.RagingBlow,nil,nil,not C)then x=q.RagingBlow:ID()return"raging_blow single_target 44"end end;if q.Rampage:IsReady()then if l(q.Rampage,nil,nil,not C)then x=q.Rampage:ID()return"rampage single_target 46"end end;if q.Slam:IsReady()and q.Annihilator:IsAvailable()then if l(q.Slam,nil,nil,not C)then x=q.Slam:ID()return"slam single_target 48"end end;if q.Bloodbath:IsCastable()then if l(q.Bloodbath,nil,nil,not C)then x=q.Bloodbath:ID()return"bloodbath single_target 50"end end;if q.RagingBlow:IsCastable()then if l(q.RagingBlow,nil,nil,not C)then x=q.RagingBlow:ID()return"raging_blow single_target 52"end end;if q.CrushingBlow:IsCastable()and g:BuffDown(q.FuriousBloodthirstBuff)then if l(q.CrushingBlow,nil,nil,not C)then x=q.CrushingBlow:ID()return"crushing_blow single_target 54"end end;if q.Bloodthirst:IsCastable()then if l(q.Bloodthirst,nil,nil,not C)then x=q.Bloodthirst:ID()return"bloodthirst single_target 56"end end;if q.Whirlwind:IsCastable()then if l(q.Whirlwind,nil,nil,not h:IsInMeleeRange(8))then x=q.Whirlwind:ID()return"whirlwind single_target 58"end end;if q.WreckingThrow:IsCastable()then if l(q.WreckingThrow,nil,nil,not h:IsInRange(30))then x=q.WreckingThrow:ID()return"wrecking_throw single_target 60"end end;if q.StormBolt:IsCastable()then if l(q.StormBolt,nil,nil,not C)then x=q.StormBolt:ID()return"storm_bolt single_target 62"end end end;local function L()u=B==1;v=B>=2 end;local function M()Opener=HeroRotationCharDB.Toggles[5]SmallCDsOn=HeroRotationCharDB.Toggles[4]StopAutoSwap=HeroRotationCharDB.Toggles[12]UsePots=HeroRotationCharDB.Toggles[15]if E.Commons.Enabled.TopTrinket then TopTrinketID=GetInventoryItemID("player",13)else TopTrinketID=1 end;if E.Commons.Enabled.BottomTrinket then BotTrinketID=GetInventoryItemID("player",14)else BotTrinketID=1 end end;local function N()if not BotOn then w=0;x=0 end;if m()then A=g:GetEnemiesInMeleeRange(5)B=#A else B=1 end;M()t=g:BuffUp(q.EnrageBuff)C=h:IsInRange(5)local O=g:AffectingCombat()and 180 or 900;local P;if i(386196):IsAvailable()then if not g:BuffUp(q.BerserkerStance)then if l(q.BerserkerStance,nil)then x=q.BerserkerStance:ID()return"Cast Berserker Stance"end end end;if i(6673):IsAvailable()and E.Fury.UseAutoBattleShout then P=g:BuffRemains(i(6673))if P<O then if l(q.BattleShout,nil)then x=q.BattleShout:ID()return"battle_shout refresh"end end end;if E.Fury.UseDefensives and g:AffectingCombat()then if q.EnragedRegeneration:IsReady()and g:HealthPercentage()<E.Fury.EnragedRegneration then if k.Cast(q.EnragedRegeneration,nil,nil,nil)then x=184364;return"Enraged Regeneration 100"end end;if q.RallyingCry:IsReady()and g:HealthPercentage()<E.Fury.RallyingCry then if k.Cast(q.RallyingCry,nil,nil,nil)then x=97462;return"RallyingCry 100"end end;if r.Healthstone:IsReady()and r.Healthstone:CooldownRemains()<=0 and g:HealthPercentage()<E.Commons.HealthstoneHP then if k.Cast(r.Healthstone,nil)then x=51;return"Healthstone HP"end end;if g:HealthPercentage()<E.Commons.HealPotHP and r.CosmicHealPot:IsReady()and r.CosmicHealPot:CooldownRemains()<=0 then if k.Cast(r.CosmicHealPot,nil)then x=54;return"HealPot HP"end end end;if D.TargetIsValid()and g:AffectingCombat()and g:GetEnemiesInMeleeRange(8)then y=d.BossFightRemains()z=y;if z==11111 then z=d.FightRemains(A,false)end;if not g:AffectingCombat()then local Q=H()if Q then return Q end end;if q.Charge:IsCastable()and Opener and E.Fury.UseCharge then if l(q.Charge,nil,nil,not h:IsSpellInRange(q.Charge))then x=q.Charge:ID()return"charge main 2"end end;if n()and E.Commons.Enabled.Potions and UsePots then local R=D.PotionSelected()if not k.GUISettings.General.HoldPotforBL or k.GUISettings.General.HoldPotforBL and g:BloodlustUp()then if R and R:IsReady()then if l(R,nil,nil)then x=54;return"potion main 6"end end end end;local Q=D.Interrupt(5,q.Pummel,E.Commons.OffGCDasOffGCD.Pummel,F)if Q then return Q end;if g:HealthPercentage()<E.Commons.VictoryRushHP then if q.VictoryRush:IsReady()then if l(q.VictoryRush,nil,nil,not C)then x=q.VictoryRush:ID()return"victory_rush heal"end end;if q.ImpendingVictory:IsReady()then if l(q.ImpendingVictory,nil,nil,not C)then x=q.ImpendingVictory:ID()return"impending_victory heal"end end end;if n()then local S=g:GetUseableTrinkets(s)if S then if l(S,nil,nil)then if S:ID()==GetInventoryItemID("player",13)and E.Commons.Enabled.TopTrinket then x=30;return"top trinket 1"elseif S:ID()==GetInventoryItemID("player",14)and E.Commons.Enabled.BottomTrinket then x=40;return"Bot trinket 1"end end end;if q.Ravager:IsCastable()and(q.Avatar:CooldownRemains()<3 or g:BuffUp(q.RecklessnessBuff)or z<10)then if l(q.Ravager,nil,nil,not h:IsInRange(40))then x=q.Ravager:ID()return"ravager main 8"end end;if q.LightsJudgment:IsCastable()and g:BuffDown(q.RecklessnessBuff)then if l(q.LightsJudgment,nil,nil,not h:IsSpellInRange(q.LightsJudgment))then x=q.LightsJudgment:ID()return"lights_judgment main 10"end end;if q.Berserking:IsCastable()and g:BuffUp(q.RecklessnessBuff)then if l(q.Berserking,nil)then x=q.Berserking:ID()return"berserking main 12"end end;if q.BloodFury:IsCastable()then if l(q.BloodFury,nil)then x=q.BloodFury:ID()return"blood_fury main 14"end end;if q.Fireblood:IsCastable()then if l(q.Fireblood,nil)then x=q.Fireblood:ID()return"fireblood main 16"end end;if q.AncestralCall:IsCastable()then if l(q.AncestralCall,nil)then x=q.AncestralCall:ID()return"ancestral_call main 18"end end;if q.Avatar:IsCastable()and(q.TitansTorment:IsAvailable()and t and g:BuffDown(q.AvatarBuff)and q.OdynsFury:CooldownDown()or q.BerserkersTorment:IsAvailable()and t and g:BuffDown(q.AvatarBuff)or not q.TitansTorment:IsAvailable()and not q.BerserkersTorment:IsAvailable()and(g:BuffUp(q.RecklessnessBuff)or z<20))then if l(q.Avatar,nil)then x=q.Avatar:ID()return"avatar main 20"end end;if q.Recklessness:IsCastable()and(q.Annihilator:IsAvailable()and q.SpearofBastion:CooldownRemains()<1 or q.Avatar:CooldownRemains()>40 or not q.Avatar:IsAvailable()or z<12)then if l(q.Recklessness,nil)then x=q.Recklessness:ID()return"recklessness main 22"end end;if q.Recklessness:IsCastable()and(not q.Annihilator:IsAvailable()or z<12)then if l(q.Recklessness,nil)then x=q.Recklessness:ID()return"recklessness main 24"end end;if q.SpearofBastion:IsCastable()and(t and(g:BuffUp(q.FuriousBloodthirstBuff)and q.TitansTorment:IsAvailable()or not q.TitansTorment:IsAvailable()or z<20 or B>1 or not g:HasTier(31,2)))then if l(q.SpearofBastion,nil,nil,not(h:IsInRange(25)or C))then x=q.SpearofBastion:ID()return"spear_of_bastion main 26"end end end;if m()and B>=2 then local Q=I()if Q then return Q end;if k.CastAnnotated(q.Pool,false,"WAIT")then return"Wait for MultiTarget()"end end;if B==1 then local Q=K()if Q then return Q end;if k.CastAnnotated(q.Pool,false,"WAIT")then return"Wait for SingleTarget()"end end;if k.CastAnnotated(q.Pool,false,"WAIT")then return"Wait/Pool Resources"end end end;local function T()q.MarkofFyralathDebuff:RegisterAuraTracking()k.Print("Fury Warrior rotation has been updated for patch 10.2.0.")end;function ReturnSpell()if x==0 then return 0 else return x end end;function ReturnSpellMO()if w==0 then return 0 else return w end end;k.SetAPL(72,N,T)