local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Pet;local i=f.Target;local j=d.Spell;local k=d.MultiSpell;local l=d.Item;local m=HeroRotation;local n=m.AoEON;local o=m.CDsON;local p=m.Cast;local q=HeroRotationCharDB.Toggles[4]and select(8,GetInstanceInfo())~=1698;local r=HeroRotationCharDB.Toggles[5]local s=HeroRotationCharDB.Toggles[6]local t=not HeroRotationCharDB.Toggles[15]local u=HeroRotationCharDB.Toggles[12]local v=HeroRotationCharDB.Toggles[70]local w=HeroRotationCharDB.Toggles[71]local x=HeroRotationCharDB.Toggles[72]local y=HeroRotationCharDB.Toggles[73]local z=HeroRotationCharDB.Toggles[74]local A=HeroRotationCharDB.Toggles[75]local B=HeroRotationCharDB.Toggles[76]local C=HeroRotationCharDB.Toggles[77]local D=HeroRotationCharDB.Toggles[78]local E=false;local F={228318,178658,333227,334800,334967,324737,326450,334470,326450,320703,320012,324085,333241,331510}local G={325552,326836,326092,334926,328395,330725,333299,323831,328494,322968,334496,334493,319603}local H=m.Commons.Everyone;local I={General=m.GUISettings.General,Commons=m.GUISettings.APL.Druid.Commons,Guardian=m.GUISettings.APL.Druid.Guardian,Guardian2=m.GUISettings.APL.Druid.Guardian2}local J=j.Druid.Guardian;local K=l.Druid.Guardian;local L={}local M=g:GetEquipment()local N=l(0)local O=l(0)if M[13]then N=l(M[13])end;if M[14]then O=l(M[14])end;local P;local Q;local R;local S=0;local T=0;local U=0;local V;local W,X;local Y=g:HasLegendaryEquipped(58)local Z=g:HasLegendaryEquipped(49)local a0=g:HasLegendaryEquipped(48)local a1=g:HasLegendaryEquipped(60)local a2=g:CovenantID()d:RegisterForEvent(function()a2=g:CovenantID()end,"COVENANT_CHOSEN")d:RegisterForEvent(function()M=g:GetEquipment()N=l(0)O=l(0)if M[13]then N=l(M[13])end;if M[14]then O=l(M[14])end;Y=g:HasLegendaryEquipped(58)Z=g:HasLegendaryEquipped(49)a0=g:HasLegendaryEquipped(48)a1=g:HasLegendaryEquipped(60)end,"PLAYER_EQUIPMENT_CHANGED")d:RegisterForEvent(function()J.AdaptiveSwarm:RegisterInFlight()end,"LEARNED_SPELL_IN_TAB")J.AdaptiveSwarm:RegisterInFlight()local function a3(a4)if a4 then return 1 else return 0 end end;local function a5(a4)return a4~=0 end;local function a6(a7)local a8=0;for a9 in pairs(a7)do local aa=a7[a9]if aa:IsChanneling(j(240784))then a8=a8+1 end end;return a8 end;local function ab(a7)local ac=0;for a9 in pairs(a7)do local aa=a7[a9]if aa:CastRemains()<=g:GCD()+0.25 and aa:IsCasting(j(240784))then ac=ac+1 end end;return ac end;local function ad(a7)local ae=0;for a9 in pairs(a7)do local aa=a7[a9]if aa:NPCID()==118044 then ae=ae+1 end end;return ae end;local function af(a7)local ag=0;for a9 in pairs(a7)do local aa=a7[a9]if aa:NPCID()==118065 or aa:NPCID()==118032 then ag=ag+1 end end;return ag end;local function ah(ai)if ai:DebuffRefreshable(J.MoonfireDebuff)and ai:TimeToDie()>12 and(ai:AffectingCombat()or ai:IsDummy()or ai:NPCID()==153285)and ai:GUID()==f("mouseover"):GUID()and I.Guardian.TargetSwap=="Mouseover"and ai:NPCID()~=118044 then S=18921;return true elseif ai:DebuffRefreshable(J.MoonfireDebuff)and ai:TimeToDie()>12 and(ai:AffectingCombat()or ai:IsDummy()or ai:NPCID()==153285)and I.Guardian.TargetSwap=="AutoSwap"and ai:GUID()~=i:GUID()and not u and ai:NPCID()~=118044 then S=9999;if S==999 then starttime=GetTime()endtime=starttime+0.25 elseif S>0 and endtime~=nil and GetTime()>endtime then S=0 end;return true elseif ai:DebuffRefreshable(J.MoonfireDebuff)and ai:TimeToDie()>12 and(ai:AffectingCombat()or ai:IsDummy()or ai:NPCID()==153285)and ai:GUID()==i:GUID()and ai:NPCID()~=118044 then T=8921;return true elseif ai:DebuffRefreshable(J.MoonfireDebuff)and ai:TimeToDie()>12 and(ai:AffectingCombat()or ai:IsDummy()or ai:NPCID()==153285)and ai:NPCID()~=118044 then return true end end;local function aj(ai)if ai:DebuffRefreshable(J.MoonfireDebuff)and(ai:NPCID()==118032 or ai:NPCID()==118065)and ai:GUID()==f("mouseover"):GUID()and ai:NPCID()~=118044 then S=18921;return true elseif ai:DebuffRefreshable(J.MoonfireDebuff)and(ai:NPCID()==118032 or ai:NPCID()==118065)and ai:GUID()==f("target"):GUID()and ai:NPCID()~=118044 then T=8921;return true elseif ai:DebuffRefreshable(J.MoonfireDebuff)and(ai:NPCID()==118032 or ai:NPCID()==118065)then return true end end;local function ak(ai)if ai:DebuffRefreshable(J.SunfireDebuff)and ai:NPCID()==118065 and ai:GUID()==f("mouseover"):GUID()and ai:NPCID()~=118044 then S=2197630;return true elseif ai:DebuffRefreshable(J.SunfireDebuff)and ai:NPCID()==118065 and ai:GUID()==f("target"):GUID()and ai:NPCID()~=118044 then T=197630;return true elseif ai:DebuffRefreshable(J.SunfireDebuff)and ai:NPCID()==118065 then return true end end;local function al(ai)return ai:DebuffRefreshable(J.ThrashDebuff)or ai:DebuffStack(J.ThrashDebuff)<3 or ai:DebuffStack(J.ThrashDebuff)<4 and Y or X>=4 or g:BuffUp(J.BerserkBuff)and g:BuffRemains(J.BerserkBuff)<=g:GCD()+0.5 end;local function am(ai)if ai:DebuffStack(J.ThrashDebuff)>2 and(ai:AffectingCombat()or ai:IsDummy()or ai:NPCID()==153285)and ai:GUID()==f("mouseover"):GUID()and I.Guardian.TargetSwap=="Mouseover"then S=180313;return true elseif ai:DebuffStack(J.ThrashDebuff)>2 and(ai:AffectingCombat()or ai:IsDummy()or ai:NPCID()==153285)and I.Guardian.TargetSwap=="AutoSwap"and ai:GUID()~=i:GUID()and not u then S=9999;if S==999 then starttime=GetTime()endtime=starttime+0.25 elseif S>0 and endtime~=nil and GetTime()>endtime then S=0 end;return true elseif ai:DebuffStack(J.ThrashDebuff)>2 and(ai:AffectingCombat()or ai:IsDummy()or ai:NPCID()==153285)and ai:GUID()==i:GUID()then T=80313;return true elseif ai:DebuffStack(J.ThrashDebuff)>2 and(ai:AffectingCombat()or ai:IsDummy()or ai:NPCID()==153285)then return true end;return ai:DebuffStack(J.ThrashDebuff)>2 end;local function an()if g:HealthPercentage()<I.Guardian2.FrenziedRegenHP and J.FrenziedRegeneration:IsReady()and g:BuffDown(J.FrenziedRegenerationBuff)and not g:HealingAbsorbed()and g:BuffUp(J.BearForm)then if p(J.FrenziedRegeneration,nil,nil)then T=22842;return"frenzied_regeneration defensive 2"end end;if J.Ironfur:IsCastable()and not E and g:BuffUp(J.BearForm)and(g:Rage()>=J.Ironfur:Cost()+1 and(Q or i:IsDummy()or i:NPCID()==153285)and(g:BuffDown(J.IronfurBuff)or g:BuffStack(J.IronfurBuff)<2 and g:BuffRefreshable(J.Ironfur)or g:Rage()>=90))then if p(J.Ironfur,nil,nil)then T=192081;return"ironfur defensive 4"end end;if J.Renewal:IsCastable()and g:HealthPercentage()<I.Guardian2.RenewalHP then if p(J.Renewal,nil,nil)then T=108238;return"Renewal defensive 4"end end;if J.Barkskin:IsCastable()and select(8,GetInstanceInfo())~=1698 and(g:HealthPercentage()<I.Guardian2.BarkskinHP and g:BuffDown(J.IronfurBuff)or g:HealthPercentage()<I.Guardian2.BarkskinHP*0.75)then if p(J.Barkskin,nil,nil)then T=22812;return"barkskin defensive 6"end end;if J.SurvivalInstincts:IsCastable()and g:HealthPercentage()<I.Guardian2.SurvivalInstinctsHP then if p(J.SurvivalInstincts,nil,nil)then T=61336;return"survival_instincts defensive 8"end end;if J.BristlingFur:IsCastable()and g:Rage()<I.Guardian2.BristlingFurRage then if p(J.BristlingFur,nil,nil)then T=155835;return"bristling_fur defensive 10"end end;if g:HealthPercentage()<I.Guardian2.PhialHP and K.PhialofSerenity:IsReady()and K.PhialofSerenity:CooldownRemains()<=0 then if m.Cast(K.PhialofSerenity,nil)then T=55;return"PhialofSerenity HP"end end;if g:HealthPercentage()<I.Guardian2.HealthstoneHP and K.Healthstone:IsReady()and K.Healthstone:CooldownRemains()<=0 then if m.Cast(K.Healthstone,nil)then T=40;return"Healthstone HP"end end;if g:HealthPercentage()<I.Guardian2.HealPotHP and K.HealPot:IsReady()and K.HealPot:CooldownRemains()<=0 then if m.Cast(K.HealPot,nil)then T=41;return"HealPot HP"end end end;local function ao()if J.CatForm:IsCastable()and v and J.FeralAffinity:IsAvailable()and not g:BuffUp(J.CatForm)and not select(8,GetInstanceInfo())==1698 then if p(J.CatForm)then T=768;return"cat_form precombat 2"end end;if J.MoonkinForm:IsCastable()and(v or select(8,GetInstanceInfo())==1698)and J.BalanceAffinity:IsAvailable()and not g:BuffUp(J.MoonkinForm)then if p(J.MoonkinForm)then T=197625;return"moonkin_form precombat 2"end end;if J.HeartoftheWild:IsCastable()and o()and i:IsInMeleeRange(8)and v and(J.BalanceAffinity:IsAvailable()or J.FeralAffinity:IsAvailable())and not select(8,GetInstanceInfo())==1698 then if p(J.HeartoftheWild,nil)then T=319454;return"heart_of_the_wild bear Precombat "end end;if J.Prowl:IsCastable()and v and J.FeralAffinity:IsAvailable()and g:BuffDown(J.Prowl)and not select(8,GetInstanceInfo())==1698 then if p(J.Prowl,nil)then T=5215;return"Prowl Precombat"end end;if J.BearForm:IsCastable()and g:BuffDown(J.BearForm)and(not v or not J.FeralAffinity:IsAvailable()and not J.BalanceAffinity:IsAvailable())and not select(8,GetInstanceInfo())==1698 then if p(J.BearForm)then T=5487;return"bear_form precombat 2"end end;if J.Wrath:IsCastable()and(v or select(8,GetInstanceInfo())==1698)and g:BuffUp(J.MoonkinForm)and(a2~=3 or select(8,GetInstanceInfo())==1698)then if p(J.Wrath)then T=5176;return"cat_form precombat 2"end end;if J.Starfire:IsCastable()and(v or select(8,GetInstanceInfo())==1698)and g:BuffUp(J.MoonkinForm)and a2==3 then if p(J.Starfire)then T=197628;return"cat_form precombat 2"end end;if J.Fleshcraft:IsCastable()and q and not g:IsMoving()and(J.PustuleEruption:SoulbindEnabled()or J.VolatileSolvent:SoulbindEnabled())then if p(J.Fleshcraft,nil,nil)then T=324631;return"fleshcraft precombat 3"end end;if J.WildCharge:IsCastable()and(i:IsInRange(25)and not i:IsInRange(8))and not select(8,GetInstanceInfo())==1698 then if p(J.WildCharge)then T=102401;return"wild_charge precombat 4"end end;if J.Rake:IsCastable()and g:BuffUp(J.Prowl)and not select(8,GetInstanceInfo())==1698 then if p(J.Rake)then T=1822;return"Rake cat 2"end end;if J.Mangle:IsCastable()and i:IsInMeleeRange(5)and g:BuffUp(J.BearForm)and not select(8,GetInstanceInfo())==1698 then if p(J.Mangle)then T=33917;return"mangle precombat 6"end end;if J.Thrash:IsCastable()and i:IsInMeleeRange(8)and g:BuffUp(J.BearForm)and not select(8,GetInstanceInfo())==1698 then if p(J.Thrash)then T=77758;return"thrash precombat 8"end end;if J.Moonfire:IsCastable()and i:NPCID()~=118044 and not select(8,GetInstanceInfo())==1698 then if p(J.Moonfire,nil,nil,not i:IsSpellInRange(J.Moonfire))then T=8921;return"moonfire precombat 10"end end end;local function ap()if J.MoonkinForm:IsCastable()and g:BuffDown(J.MoonkinForm)then if p(J.MoonkinForm)then T=197625;return"MoonkinForm lycara 2"end end end;local function aq()if J.CatForm:IsCastable()and g:BuffDown(J.CatForm)then if p(J.CatForm)then T=768;return"catform lycara 2"end end end;local function ar()if J.MoonkinForm:IsCastable()and g:BuffDown(J.MoonkinForm)then if p(J.MoonkinForm)then T=197625;return"owl_form owl 2"end end;if J.HeartoftheWild:IsCastable()and o()and J.HeartoftheWild:IsAvailable()and g:BuffDown(J.HeartoftheWild)then if p(J.HeartoftheWild)then T=319454;return"HOTW owl 2"end end;if J.ConvoketheSpirits:IsCastable()and g:BuffUp(J.MoonkinForm)and q and(J.FirstStrike:SoulbindEnabled()and g:BuffUp(J.FirstStrike))then if p(J.ConvoketheSpirits)then T=323764;return"Convoke owl 2"end end;if J.ConvoketheSpirits:IsCastable()and q and g:BuffUp(J.MoonkinForm)and(J.HeartoftheWild:IsAvailable()and(g:BuffUp(J.HeartoftheWild)or J.HeartoftheWild:CooldownRemains()>15)or not J.HeartoftheWild:IsAvailable()or not o())then if p(J.ConvoketheSpirits)then T=323764;return"Convoke owlvoke 2"end end end;local function as()if J.CatForm:IsCastable()and g:BuffDown(J.CatForm)then if p(J.CatForm)then T=768;return"catform catvoke 2"end end;if J.HeartoftheWild:IsCastable()and o()and J.HeartoftheWild:IsAvailable()and g:BuffDown(J.HeartoftheWild)then if p(J.HeartoftheWild)then T=319454;return"HOTW catvoke 2"end end;if J.ConvoketheSpirits:IsCastable()and q and g:BuffUp(J.CatForm)and(J.FirstStrike:SoulbindEnabled()and g:BuffUp(J.FirstStrikeBuff)or J.HeartoftheWild:IsAvailable()and(g:BuffUp(J.HeartoftheWild)or J.HeartoftheWild:CooldownRemains()>15)or not J.HeartoftheWild:IsAvailable()or not o())then if p(J.ConvoketheSpirits)then T=323764;return"Convoke catvoke 2"end end end;local function at()if J.BearForm:IsCastable()and g:BuffDown(J.BearForm)then if p(J.BearForm)then T=5487;return"bear_form bear 2"end end;if J.HeartoftheWild:IsCastable()and o()and i:IsInMeleeRange(8)and(J.BalanceAffinity:IsAvailable()and a2==2)then if p(J.HeartoftheWild,nil)then T=319454;return"heart_of_the_wild bear 3"end end;if J.Ironfur:IsCastable()and g:Rage()>=J.Ironfur:Cost()+1 and not R and(g:BuffUp(J.IncarnationBuff)or g:BuffUp(J.BerserkBuff))then if p(J.Ironfur,nil,nil)then T=192081;return"ironfur Zerk 1"end end;if J.Thrash:IsCastable(BypassRecovery)and i:IsInMeleeRange(8)and(a1 or g:BuffUp(J.IncarnationBuff)or g:BuffUp(J.BerserkBuff))and select(8,GetInstanceInfo())~=1698 then if p(J.Thrash)then T=77758;return"thrash bear 30"end end;if J.Moonfire:IsReady()then if H.CastCycle(J.Moonfire,W,ah,not i:IsSpellInRange(J.Moonfire))then return"moonfire bear 4"end end;if J.RavenousFrenzy:IsCastable()and q and i:IsInMeleeRange(8)then if p(J.RavenousFrenzy,nil,nil)then T=323546;return"ravenous_frenzy bear 7"end end;if K.Jotungeirr:IsEquippedAndReady()and a2==2 and i:IsInMeleeRange(8)then if p(K.Jotungeirr,nil,nil)then T=16;return"jotungeirr_destinys_call bear 8"end end;if a2==2 and i:IsInMeleeRange(8)then local au=g:GetUseableTrinkets(L)if au then if p(au,nil,nil)then if au:ID()==TopTrinketID and I.Commons.Enabled.TopTrinket and(I.Commons.TopTrinketHP<=0 and o()or I.Commons.TopTrinketHP>g:HealthPercentage())then T=24;return"top trinket 1"elseif au:ID()==BotTrinketID and I.Commons.Enabled.BotTrinket and(I.Commons.BotTrinketHP<=0 and o()or I.Commons.BotTrinketHP>g:HealthPercentage())then T=30;return"top trinket 2"end end end end;if I.Commons.Enabled.Potions and t and i:IsInMeleeRange(8)and K.PotionofPhantomFire:IsReady()and(a2==2 and g:BuffRemains(J.IncarnationBuff)>=23 and g:BuffRemains(J.IncarnationBuff)<=26)then if p(K.PotionofPhantomFire,nil,nil)then T=50;return"potion bear 11"end end;if J.ConvoketheSpirits:IsCastable()and q and i:IsInMeleeRange(8)then if p(J.ConvoketheSpirits,nil,nil,not i:IsInMeleeRange(5))then T=323764;return"convoke_the_spirits bear 12"end end;if J.Berserk:IsCastable()and not w and i:IsInMeleeRange(8)and o()and(Q or i:IsDummy()or i:NPCID()==153285)and(g:BuffUp(J.RavenousFrenzyBuff)or a2~=2)then if p(J.Berserk,nil)then T=50334;return"berserk bear 13"end end;if J.Incarnation:IsCastable()and not w and i:IsInMeleeRange(8)and o()and(Q or i:IsDummy()or i:NPCID()==153285)and(g:BuffUp(J.RavenousFrenzyBuff)or a2~=2)then if p(J.Incarnation,nil)then T=102558;return"incarnation bear 14"end end;if J.Berserking:IsCastable()and i:IsInMeleeRange(8)and(g:BuffUp(J.BerserkBuff)or g:BuffUp(J.IncarnationBuff))then if p(J.Berserking,nil)then T=26297;return"berserking bear 15"end end;if J.Barkskin:IsCastable()and(Q or i:IsDummy()or i:NPCID()==153285)and not I.Guardian.UseBarkskinDefensively and J.Brambles:IsAvailable()and select(8,GetInstanceInfo())~=1698 then if p(J.Barkskin,nil,nil)then T=22812;return"barkskin bear 17"end end;if J.AdaptiveSwarm:IsCastable()and i:IsInMeleeRange(8)and q and(i:DebuffDown(J.AdaptiveSwarmDebuff)and J.AdaptiveSwarm:TimeSinceLastCast()>0.3 and i:DebuffDown(J.AdaptiveSwarmDebuff)or g:BuffRemains(J.AdaptiveSwarmHeal)>3 or i:DebuffStack(J.AdaptiveSwarmDebuff)<3 and i:DebuffRemains(J.AdaptiveSwarmDebuff)<5 and i:DebuffUp(J.AdaptiveSwarmDebuff))then if p(J.AdaptiveSwarm,nil,nil,not i:IsSpellInRange(J.AdaptiveSwarm))then T=325727;return"adaptive_swarm bear 18"end end;if J.Moonfire:IsCastable()and g:BuffUp(J.GalacticGuardianBuff)and select(8,GetInstanceInfo())==1698 and f("boss1"):NPCID()==117933 and f("boss1"):IsInRange(40)then if p(J.Moonfire)then T=118921;return"Moonfire owl Boss 2"end end;if J.Moonfire:IsReady()and(g:BuffUp(J.GalacticGuardianBuff)and X<3)then if p(J.Moonfire,nil,nil,not i:IsSpellInRange(J.Moonfire))then T=8921;return"moonfire bear 19"end end;if J.Thrash:IsCastable()and i:IsInMeleeRange(8)and(i:DebuffRefreshable(J.ThrashDebuff)or i:DebuffStack(J.ThrashDebuff)<3 or i:DebuffStack(J.ThrashDebuff)<4 and Y or X<=4)then if p(J.Thrash)then T=77758;return"thrash bear 20"end end;if J.Fleshcraft:IsCastable()and q and(J.PustuleEruption:SoulbindEnabled()and(J.Thrash:CooldownRemains()>0 and J.Mangle:CooldownRemains()>0 and i:DebuffRemains(J.MoonfireDebuff)>=3 and(g:BuffDown(J.IncarnationBuff)and g:BuffDown(J.BerserkBuff)and g:BuffDown(J.GalacticGuardianBuff)))or J.VolatileSolvent:SoulbindEnabled())then if p(J.Fleshcraft,nil,nil)then T=324631;return"fleshcraft bear 27"end end;if J.Swipe:IsCastable()and i:IsInMeleeRange(8)and(g:BuffDown(J.IncarnationBuff)and g:BuffDown(J.BerserkBuff)and X>=4)then if p(J.Swipe,nil,nil,not i:IsInMeleeRange(8))then T=213771;return"swipe bear 28"end end;if J.Maul:IsReady()and i:IsInMeleeRange(8)and R and not E and(g:BuffUp(J.IncarnationBuff)and X<3 and g:BuffStack(J.ToothandClawBuff)>=2 or g:BuffUp(J.ToothandClawBuff)and g:BuffRemains(J.ToothandClawBuff)<1.5 or g:BuffStack(J.SavageCombatantBuff)>=3 or g:BuffUp(J.BerserkBuff)and X<3)then if p(J.Maul,nil,nil,not i:IsInMeleeRange(5))then T=6807;return"maul bear 30"end end;if J.Maul:IsReady()and i:IsInMeleeRange(8)and R and not E and(g:BuffStack(J.SavageCombatantBuff)>=1 and g:BuffUp(J.ToothandClawBuff)and g:BuffUp(J.IncarnationBuff)and X==2)then if p(J.Maul,nil,nil,not i:IsInMeleeRange(5))then T=6807;return"maul bear 32"end end;if J.Mangle:IsCastable()and i:IsInMeleeRange(8)and(g:BuffUp(J.IncarnationBuff)and X<=3)then if p(J.Mangle,nil,nil,not i:IsInMeleeRange(5))then T=33917;return"mangle bear 34"end end;if J.Maul:IsReady()and i:IsInMeleeRange(8)and R and not E and((g:BuffStack(J.ToothandClawBuff)>=2 or g:BuffUp(J.ToothandClawBuff)and g:BuffRemains(J.ToothandClawBuff)<1.5 or g:BuffStack(J.SavageCombatantBuff)>=3)and X<3)then if p(J.Maul,nil,nil,not i:IsInMeleeRange(5))then T=6807;return"maul bear 36"end end;if J.Thrash:IsCastable()and i:IsInMeleeRange(8)and X>1 then if p(J.Thrash,nil,nil,not i:IsInMeleeRange(8))then T=77758;return"thrash bear 38"end end;if J.Mangle:IsCastable()and i:IsInMeleeRange(8)and(g:Rage()<90 and X<3 or g:Rage()<85 and X<3 and J.SouloftheForest:IsAvailable())then if p(J.Mangle,nil,nil,not i:IsInMeleeRange(5))then T=33917;return"mangle bear 40"end end;if J.Pulverize:IsReady()and i:IsInMeleeRange(8)then if H.CastCycle(J.Pulverize,W,am,not i:IsInMeleeRange(5))then return"pulverize bear 42"end end;if J.Thrash:IsCastable()and i:IsInMeleeRange(8)then if p(J.Thrash,nil,nil,not i:IsInMeleeRange(8))then T=77758;return"thrash bear 44"end end;if J.Maul:IsReady()and i:IsInMeleeRange(8)and R and not E and X<3 then if p(J.Maul,nil,nil,not i:IsInMeleeRange(5))then T=6807;return"maul bear 46"end end;if J.Swipe:IsCastable()and i:IsInMeleeRange(8)then if p(J.Swipe,nil,nil,not i:IsInMeleeRange(8))then T=213771;return"swipe bear 48"end end end;local function av()if J.CatForm:IsCastable()and g:BuffDown(J.CatForm)then if p(J.CatForm)then T=768;return"cat_form cat 2"end end;if J.Rake:IsCastable()and g:BuffUp(J.Prowl)then if p(J.Rake)then T=1822;return"Rake cat 2"end end;if J.HeartoftheWild:IsCastable()and J.HeartoftheWild:IsAvailable()and g:BuffDown(J.HeartoftheWild)and o()then if p(J.HeartoftheWild)then T=319454;return"HOTW cat 2"end end;if J.Rake:IsCastable()and(i:DebuffRefreshable(J.RakeDebuff)or g:Energy()<45)then if p(J.Rake)then T=1822;return"Rake cat 3"end end;if J.Rip:IsCastable()and i:DebuffRefreshable(J.Rip)and g:ComboPoints()>=1 then if p(J.Rip)then T=1079;return"Rip cat 2"end end;if J.ConvoketheSpirits:IsCastable()and q then if p(J.ConvoketheSpirits)then T=323764;return"Convoke cat 2"end end;if J.FerociousBite:IsCastable()and g:ComboPoints()>=4 and g:Energy()>50 then if p(J.FerociousBite)then T=22568;return"FB cat 2"end end;if J.AdaptiveSwarm:IsCastable()and q and(i:DebuffDown(J.AdaptiveSwarmDebuff)and J.AdaptiveSwarm:TimeSinceLastCast()>0.3 or i:DebuffStack(J.AdaptiveSwarmDebuff)<3 and i:DebuffRemains(J.AdaptiveSwarmDebuff)<5 and i:DebuffUp(J.AdaptiveSwarmDebuff))then if p(J.AdaptiveSwarm)then T=325727;return"Adaptive Swarm cat 2"end end;if J.Fleshcraft:IsCastable()and q and not g:IsMoving()and(J.PustuleEruption:SoulbindEnabled()and g:Energy()<35 or J.VolatileSolvent:SoulbindEnabled())then if p(J.Fleshcraft,nil,nil)then T=324631;return"fleshcraft precombat 3"end end;if true then if p(J.Swipe)then T=213771;return"Swipe cat 2"end end end;local function aw()if J.MoonkinForm:IsCastable()and g:BuffDown(J.MoonkinForm)then if p(J.MoonkinForm)then T=197625;return"owl_form owl 2"end end;if J.HeartoftheWild:IsCastable()and o()and J.HeartoftheWild:IsAvailable()and g:BuffDown(J.HeartoftheWild)then if p(J.HeartoftheWild)then T=319454;return"HOTW owl 2"end end;if J.Starsurge:IsCastable()and not g:IsMoving()then if p(J.Starsurge)then T=197626;return"Starsurge owl 2"end end;if J.ConvoketheSpirits:IsCastable()and q and J.FirstStrike:SoulbindEnabled()then if p(J.ConvoketheSpirits)then T=323764;return"Convoke owl 2"end end;if J.AdaptiveSwarm:IsCastable()and q and(i:DebuffDown(J.AdaptiveSwarmDebuff)and J.AdaptiveSwarm:TimeSinceLastCast()>0.3 or i:DebuffStack(J.AdaptiveSwarmDebuff)<3 and i:DebuffRemains(J.AdaptiveSwarmDebuff)<5 and i:DebuffUp(J.AdaptiveSwarmDebuff))then if p(J.AdaptiveSwarm)then T=325727;return"Adaptive Swarm cat 2"end end;if J.Sunfire:IsCastable()and i:DebuffRefreshable(J.SunfireDebuff)then if p(J.Sunfire)then T=197630;return"Sunfire owl 2"end end;if J.Sunfire:IsCastable()then if H.CastCycle(J.Sunfire,Enemies40y,ak,not i:IsSpellInRange(J.Sunfire))then return"Sunfire Owl 3"end end;if J.Moonfire:IsCastable()and g:BuffUp(J.GalacticGuardianBuff)and select(8,GetInstanceInfo())==1698 and f("boss1"):NPCID()==117933 and f("boss1"):IsInRange(40)then if p(J.Moonfire)then T=118921;return"Moonfire owl Boss 2"end end;if J.Moonfire:IsCastable()and(i:DebuffRefreshable(J.MoonfireDebuff)or g:BuffUp(J.GalacticGuardianBuff))then if p(J.Moonfire)then T=8921;return"Moonfire owl 2"end end;if J.Starfire:IsCastable()and EclipseAnyNext and a2==3 and not g:IsMoving()then if p(J.Starfire)then T=197628;return"Starfire owl 2"end end;if J.Wrath:IsCastable()and EclipseAnyNext and a2~=3 and not g:IsMoving()then if p(J.Wrath)then T=5176;return"Wrath owl 2"end end;if J.ConvoketheSpirits:IsCastable()and q and(g:BuffUp(J.EclipseLunar)or g:BuffUp(J.EclipseSolar))then if p(J.ConvoketheSpirits)then T=323764;return"Convoke owl 2"end end;if J.Starfire:IsCastable()and not g:IsMoving()and(EclipseInLunar or EclipseSolarNext or EclipseInLunar and g:BuffUp(J.EclipseLunar)and J.Starsurge:TimeSinceLastCast()<14)then if p(J.Starfire)then T=197628;return"Starfire owl 2"end end;if J.Wrath:IsCastable()and not g:IsMoving()then if p(J.Wrath)then T=5176;return"Wrath owl 2"end end;if J.Moonfire:IsCastable()and g:IsMoving()then if p(J.Moonfire)then T=8921;return"Moonfire owl 2"end end end;local function ax()s=HeroRotationCharDB.Toggles[6]q=HeroRotationCharDB.Toggles[4]and select(8,GetInstanceInfo())~=1698;r=HeroRotationCharDB.Toggles[5]u=HeroRotationCharDB.Toggles[12]t=not HeroRotationCharDB.Toggles[15]v=HeroRotationCharDB.Toggles[70]w=HeroRotationCharDB.Toggles[71]x=HeroRotationCharDB.Toggles[72]y=HeroRotationCharDB.Toggles[73]z=HeroRotationCharDB.Toggles[74]A=HeroRotationCharDB.Toggles[75]B=HeroRotationCharDB.Toggles[76]C=HeroRotationCharDB.Toggles[77]D=HeroRotationCharDB.Toggles[78]E=false end;local function ay()EclipseInAny=g:BuffUp(J.EclipseSolar)or g:BuffUp(J.EclipseLunar)EclipseInBoth=g:BuffUp(J.EclipseSolar)and g:BuffUp(J.EclipseLunar)EclipseInLunar=g:BuffUp(J.EclipseLunar)and g:BuffDown(J.EclipseSolar)EclipseInSolar=g:BuffUp(J.EclipseSolar)and g:BuffDown(J.EclipseLunar)EclipseLunarNext=not EclipseInAny and(J.Starfire:Count()==0 and J.Wrath:Count()>0 or g:IsCasting(J.Wrath))or EclipseInSolar;EclipseSolarNext=not EclipseInAny and(J.Wrath:Count()==0 and J.Starfire:Count()>0 or g:IsCasting(J.Starfire))or EclipseInLunar;EclipseAnyNext=not EclipseInAny and J.Wrath:Count()>0 and J.Starfire:Count()>0 end;local function az()if n()then W=g:GetEnemiesInMeleeRange(8)X=#W;V=g:GetEnemiesInMeleeRange(5)Enemies40y=g:GetEnemiesInRange(40)else W=g:GetEnemiesInMeleeRange(8)if#W>=1 then X=1 else X=0 end;V=g:GetEnemiesInMeleeRange(5)end;TopTrinketID,_=GetInventoryItemID("player",13)BotTrinketID,_=GetInventoryItemID("player",14)P=g:ActiveMitigationNeeded()Q=g:IsTankingAoE(8)or g:IsTanking(i)UnitsCastinNetherStormCount=a6(W)UnitsCastinNetherStormCount2=ab(W)UnitsCastinNetherStormCount3=ad(W)MTNegligableMeleeCount=af(W)if n()then if MTNegligableMeleeCount>0 then X=X-MTNegligableMeleeCount end end;R=false;if not I.Guardian.UseRageDefensively then R=true end;if not BotOn then S=0;T=0 end;if S>0 then S=0 end;if T>0 then T=0 end;ShouldReturn=ax()ay()if m.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+m.GUISettings.General.OpenerReset elseif m.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]m.ToggleIconFrame:UpdateButtonText(6)m.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if y and J.UrsolsVortex:IsUsableP()and J.RestorationAffinity:IsAvailable()and J.UrsolsVortex:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(J.UrsolsVortex,nil,nil,nil)then T=102793;return"UrsolsVortex Queue"end elseif(not J.UrsolsVortex:IsUsableP()or J.UrsolsVortex:CooldownRemains()>0 or not g:AffectingCombat()or not J.RestorationAffinity:IsAvailable())and y then HeroRotationCharDB.Toggles[73]=not HeroRotationCharDB.Toggles[73]m.Print("Ursols Vortex Queue is now "..(HeroRotationCharDB.Toggles[73]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if z and J.Typhoon:IsUsableP()and J.BalanceAffinity:IsAvailable()and J.Typhoon:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(J.Typhoon,nil,nil,nil)then T=132469;return"Typhoon Queue"end elseif(not J.Typhoon:IsUsableP()or J.Typhoon:CooldownRemains()>0 or not g:AffectingCombat()or not J.BalanceAffinity:IsAvailable())and z then HeroRotationCharDB.Toggles[74]=not HeroRotationCharDB.Toggles[74]m.Print("Typhoon Queue is now "..(HeroRotationCharDB.Toggles[74]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if A and J.StampedingRoar:IsUsableP()and J.StampedingRoar:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(J.StampedingRoar,nil,nil,nil)then T=106898;return"StampedingRoar Queue"end elseif(not J.StampedingRoar:IsUsableP()or J.StampedingRoar:CooldownRemains()>0 or not g:AffectingCombat())and A then HeroRotationCharDB.Toggles[75]=not HeroRotationCharDB.Toggles[75]m.Print("Stampeding Roar Queue is now "..(HeroRotationCharDB.Toggles[75]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if B and J.IncapacitatingRoar:IsUsableP()and J.IncapacitatingRoar:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(J.IncapacitatingRoar,nil,nil,nil)then T=99;return"IncapacitatingRoar Queue"end elseif(not J.IncapacitatingRoar:IsUsableP()or J.IncapacitatingRoar:CooldownRemains()>0 or not g:AffectingCombat())and B then HeroRotationCharDB.Toggles[76]=not HeroRotationCharDB.Toggles[76]m.Print("Incapacitating Roar Queue is now "..(HeroRotationCharDB.Toggles[76]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if C and J.MightyBash:IsAvailable()and J.MightyBash:IsUsableP()and J.MightyBash:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(J.MightyBash,nil,nil,nil)then T=5211;return"MightyBash Queue"end elseif(not J.MightyBash:IsUsableP()or J.MightyBash:CooldownRemains()>0 or not g:AffectingCombat()or not J.MightyBash:IsAvailable())and C then HeroRotationCharDB.Toggles[77]=not HeroRotationCharDB.Toggles[77]m.Print("Mighty Bash Queue is now "..(HeroRotationCharDB.Toggles[76]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if g:IsChanneling(J.ConvoketheSpirits)then if p(J.Pool,nil)then T=99999;return"channeling 4"end end;if D then if g:BuffUp(J.TravelForm)and J.WildCharge:IsAvailable()and J.WildCharge:CooldownRemains()<=0 and not g:BuffUp(J.Sprint)and not IsFlyableArea()then if p(J.WildCharge,nil)then T=102417;return"Zoom Zoom Jump"end end;if not g:BuffUp(J.TravelForm)and(J.WildCharge:IsAvailable()and J.TravelForm:CooldownRemains()<=0 and not g:BuffUp(J.Sprint)and g:BuffDown(J.SoulShape)and not IsFlyableArea()and not IsIndoors()or IsFlyableArea()and not IsIndoors())then if p(J.TravelForm,nil)then T=783;return"Travel Form for Jump"end end;if J.StampedingRoar:CooldownRemains()<=0 and g:BuffDown(J.SoulShape)and IsIndoors()and g:BuffDown(J.TravelForm)then if p(J.StampedingRoar,nil)then T=106898;return"StampedingRoar"end end;if J.Flicker:IsCastable()and g:BuffUp(J.SoulShape)then if p(J.Flicker,nil)then T=324701;return"Flicker"end end;if J.SoulShape:IsAvailable()and J.SoulShape:IsCastable()and not g:BuffUp(J.SoulShape)and not g:BuffUp(J.StampedingRoar)and not g:BuffUp(J.Sprint)then if p(J.SoulShape,nil)then T=310143;return"zoom zoom soulshape"end end;if J.Sprint:IsAvailable()and J.Sprint:IsCastable()and not g:BuffUp(J.SoulShape)and IsIndoors()and not g:BuffUp(J.StampedingRoar)then if p(J.Sprint,nil)then T=1850;return"Zoom zoom Sprint"end end;if J.CatForm:IsCastable()and not g:BuffUp(J.CatForm)and not g:BuffUp(J.SoulShape)and IsIndoors()then if p(J.CatForm,nil)then T=768;return"Zoom zoom CatForm"end end end;if H.TargetIsValid()then if select(8,GetInstanceInfo())==1698 then if UnitsCastinNetherStormCount>0 and j(99):IsReady()then if p(j(99),nil)then T=99;return"Shout Interrupt MT 1"end end;if UnitsCastinNetherStormCount2>0 and j(99):IsReady()and g:BuffUp(J.BearForm)then if p(J.Pool,nil)then T=99999;return"Pool for Shout Interrupt MT 1"end end;if UnitsCastinNetherStormCount3>0 and J.Barkskin:IsReady()and f("boss1"):NPCID()==117933 and f("boss1"):TimeToDie()>60 then if p(J.Barkskin,nil,nil)then T=22812;return"barkskin defensive MT 6"end end;if i:IsInRange(28)and not i:IsInRange(8)and J.WildCharge:IsReady()and g:BuffUp(J.BearForm)and f("target"):NPCID()~=117933 and f("target"):NPCID()~=118032 then if p(j(102401),nil)then T=102401;return"Wild Charge Back"end end;if true then local ShouldReturn=an()if ShouldReturn then return ShouldReturn end end;if(select(8,UnitChannelInfo("target"))==234676 or select(9,UnitCastingInfo("target"))==234676)and f("target"):IsInRange(20)then if g:BuffUp(J.BearForm)or g:BuffUp(J.CatForm)then if p(j(106839),nil)then T=11106839;return"interrupt boss MT"end else if p(J.BearForm,nil)then T=5487;return"Bear for interrupt"end end end;if f("boss1"):NPCID()==117933 then if(select(8,UnitChannelInfo("boss1"))==234423 or select(9,UnitCastingInfo("boss1"))==234423)and f("boss1"):IsInRange(20)then if g:BuffUp(J.MoonkinForm)and j(132469):CooldownRemains()<=0 and UnitsCastinNetherStormCount2==0 and UnitsCastinNetherStormCount==0 then if p(j(132469),nil)then T=132469;return"typhoon interrupt boss MT"end elseif g:BuffUp(J.BearForm)or g:BuffUp(J.CatForm)then if p(j(106839),nil)then T=11106839;return"interrupt boss MT"end elseif(not g:BuffUp(J.BearForm)or g:BuffUp(J.CatForm))and j(132469):CooldownRemains()>=0 then if p(J.BearForm,nil)then T=5487;return"Bear for interrupt"end end end;if J.Moonfire:IsReady()then if H.CastCycle(J.Moonfire,g:GetEnemiesInMeleeRange(40),aj,not i:IsSpellInRange(J.Moonfire))then return"moonfire MT 4"end end;if X==0 then if g:BuffUp(J.MoonkinForm)then if(g:HealthPercentage()<I.Guardian2.MTRegrowth-20 and not g:IsCasting(j(8936))or g:HealthPercentage()<I.Guardian2.MTRegrowth-20)and j(8936):IsReady()and not g:IsMoving()then if p(j(8936),nil)then T=8936;return"Regrowth phase 1"end elseif true then local ShouldReturn=aw()if ShouldReturn then return ShouldReturn end end else if p(J.MoonkinForm,nil)then T=197625;return"Moonkin phase 1"end end else if UnitsCastinNetherStormCount>0 and j(99):IsCastable()and g:BuffUp(J.BearForm)then if p(j(99),nil)then T=99;return"Shout Interrupt MT 1"end elseif g:BuffUp(J.BearForm)then local ShouldReturn=at()if ShouldReturn then return ShouldReturn end elseif g:BuffDown(J.BearForm)then if p(J.BearForm,nil)then T=5487;return"Bear for melee"end end end end;if f("boss1"):NPCID()==117198 then if(select(8,UnitChannelInfo("boss1"))==234676 or select(9,UnitCastingInfo("boss1"))==234676)and f("boss1"):IsInRange(20)then if(g:BuffUp(J.BearForm)or g:BuffUp(J.CatForm))and j(106839):CooldownRemains()<=0 then if p(j(106839),nil)then T=11106839;return"interrupt boss MT"end elseif g:BuffUp(J.BearForm)and j(132469):CooldownRemains()<=0 then if p(j(132469),nil)then T=132469;return"interrupt boss MT"end elseif not g:BuffUp(J.BearForm)then if p(J.BearForm,nil)then T=5487;return"Bear for interrupt"end end end;if(select(8,UnitChannelInfo("boss1"))==236572 or select(9,UnitCastingInfo("boss1"))==236572)and f("boss1"):IsInRange(8)and j(5211):IsAvailable()and j(5211):IsReady()then if p(j(5211),nil)then T=g:DebuffStack(j(236572))return"interrupt boss bash MT"end end;if(select(8,UnitChannelInfo("boss1"))==236572 or select(9,UnitCastingInfo("boss1"))==236572)and g:BuffUp(J.BearForm)then for aA=1,40 do local _,_,aB,_,_,_,_,_,_,aC,_,_,_,_,_,_=UnitDebuff("player",aA)if aC~=nil and aC==236572 and aB~=nil and aB>=2 and J.SurvivalInstincts:IsCastable()then if p(J.SurvivalInstincts,nil,nil)then T=61336;return"survival_instincts defensive 8"end end;if aC~=nil and aC==236572 and aB~=nil and aB>=1 and J.Barkskin:IsCastable()then if p(J.Barkskin,nil,nil)then T=22812;return"barkskin defensive 6"end end;if aC~=nil and aC==236572 and aB~=nil and aB>=0 and J.Ironfur:IsCastable()and(g:Rage()>=J.Ironfur:Cost()+1 and(g:BuffDown(J.IronfurBuff)or g:BuffStack(J.IronfurBuff)<2 and g:BuffRefreshable(J.Ironfur)or g:Rage()>=90))then if p(J.Ironfur,nil,nil)then T=192081;return"ironfur defensive 4"end end end end;if J.Moonfire:IsReady()then if H.CastCycle(J.Moonfire,g:GetEnemiesInMeleeRange(40),aj,not i:IsSpellInRange(J.Moonfire))then return"moonfire MT 4"end end;if X>=0 then if UnitsCastinNetherStormCount>0 and j(99):IsCastable()and g:BuffUp(J.BearForm)then if p(j(99),nil)then T=99;return"Shout Interrupt MT 1"end elseif g:BuffUp(J.BearForm)then local ShouldReturn=at()if ShouldReturn then return ShouldReturn end elseif g:BuffDown(J.BearForm)then if p(J.BearForm,nil)then T=5487;return"Bear for melee"end end end end end;if not g:AffectingCombat()and s then local ShouldReturn=ao()if ShouldReturn then return ShouldReturn end end;if not UnitIsEnemy("player","mouseover")and UnitIsDead("mouseover")then if J.Rebirth:IsCastable()and(g:Rage()>=30 and g:BuffUp(J.BearForm)or g:BuffDown(J.BearForm)and not g:IsMoving())then if p(J.Rebirth,nil)then T=20484;return"Rebirth MO"end elseif J.Rebirth:CooldownRemains(BypassRecovery)<=0 and(g:Rage()<30 and g:BuffUp(J.BearForm))then E=true end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if J.Moonfire:IsCastable()then if p(J.Moonfire,nil)then S=18921;return"explosive MO SWD"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if J.Moonfire:IsCastable()then if p(J.Moonfire,nil)then T=8921;return"explosive  SWD"end end end;F={228318,178658,333227,334800,334967,324737,326450,334470,326450,320703,320012,324085,333241,331510}if UnitExists("target")and J.Soothe:IsCastable()then if UnitCanAttack("player","target")and UnitAffectingCombat("target")and UnitIsDead("target")~=true then for aA=0,40 do local _,_,aD,aE,_,_,_,_,_,aF=UnitBuff("target",aA)for _,aG in pairs(F)do if aG==aF then if p(J.Soothe,nil)then T=2908;return"Southe Enrage"end end end end end end;if UnitExists("mouseover")and J.Soothe:IsCastable()then if UnitCanAttack("player","mouseover")and UnitAffectingCombat("mouseover")and UnitIsDead("mouseover")~=true then for aA=0,40 do local _,_,aD,aE,_,_,_,_,_,aF=UnitBuff("mouseover",aA)for _,aG in pairs(F)do if aG==aF then if p(J.Soothe,nil)then S=12908;return"Southe Enrage mouseover"end end end end end end;for aA=0,40 do local _,_,aD,aE,_,_,_,_,_,aF=UnitDebuff("mouseover",aA)if J.RemoveCorruption:IsCastable()and UnitIsDead("mouseover")~=true and UnitCanAttack("player","mouseover")~=true and IsItemInRange(34471,"mouseover")and(aE=="Poison"or aE=="Curse")then if p(J.RemoveCorruption,nil)then T=2782;return"Remove Corruption MO"end end end;if(Q or i:IsDummy()or i:NPCID()==153285)and g:BuffUp(J.BearForm)then local ShouldReturn=an()if ShouldReturn then return ShouldReturn end end;if K.Jotungeirr:IsEquippedAndReady()and a2~=2 and o()then if p(K.Jotungeirr,nil,nil)then T=16;return"jotungeirr_destinys_call main"end end;if a2~=2 and o()then local au=g:GetUseableTrinkets(L)if au then if p(au,nil,nil)then if au:ID()==TopTrinketID and I.Commons.Enabled.TopTrinket and(I.Commons.TopTrinketHP<=0 and o()or I.Commons.TopTrinketHP>g:HealthPercentage())then T=24;return"top trinket 1"elseif au:ID()==BotTrinketID and I.Commons.Enabled.BotTrinket and(I.Commons.BotTrinketHP<=0 and o()or I.Commons.BotTrinketHP>g:HealthPercentage())then T=30;return"top trinket 2"end end end end;if I.Commons.Enabled.Potions and t and K.PotionofPhantomFire:IsReady()and(a2~=2 and(g:BuffUp(J.BerserkBuff)or g:BuffUp(J.Incarnation)))then if p(K.PotionofPhantomFire,nil,nil)then T=50;return"potion main"end end;if v and J.FeralAffinity:IsAvailable()and a2~=2 and g:BuffDown(J.IncarnationBuff)and(J.Thrash:CooldownRemains()>0 and J.Mangle:CooldownRemains()>0 and i:DebuffRemains(J.MoonfireDebuff)>=g:GCD()+0.5 and g:Rage()<40 and g:BuffDown(J.IncarnationBuff)and g:BuffDown(J.BerserkBuff)and g:BuffDown(J.GalacticGuardianBuff)or g:BuffUp(J.CatForm)and g:Energy()>25 or i:DebuffRefreshable(J.RakeDebuff)and i:DebuffRefreshable(J.Rip)or Z and g:BuffDown(J.OathofElderDruidBuff)and(g:BuffUp(J.CatForm)and g:Energy()>20)and g:BuffRemins(J.HeartoftheWild)<=10 or a2==1 and J.EmpowerBond:CooldownRemains()<=1 and X<2 or g:BuffUp(J.HeartoftheWild)and g:Energy()>90)then local ShouldReturn=av()if ShouldReturn then return ShouldReturn end end;if v and J.FeralAffinity:IsAvailable()and a2==2 and(J.Thrash:CooldownRemains()>0 and J.Mangle:CooldownRemains()>0 and i:DebuffRemains(J.MoonfireDebuff)>=g:GCD()+0.5 and g:Rage()<40 and g:BuffDown(J.IncarnationBuff)and g:BuffDown(J.BerserkBuff)and g:BuffDown(J.GalacticGuardianBuff)or g:BuffUp(J.CatForm)and g:Energy()>25 or i:DebuffRefreshable(J.RakeDebuff)and i:DebuffRefreshable(J.Rip)and g:Rage()<40 and g:BuffDown(J.IncarnationBuff)and g:BuffDown(J.BerserkBuff)and g:BuffDown(J.GalacticGuardianBuff))then local ShouldReturn=av()if ShouldReturn then return ShouldReturn end end;if v and J.BalanceAffinity:IsAvailable()and(J.Thrash:CooldownRemains()>0 and J.Mangle:CooldownRemains()>0 and g:Rage()<15 and g:BuffDown(J.IncarnationBuff)and g:BuffDown(J.BerserkBuff)and g:BuffDown(J.GalacticGuardianBuff)or g:BuffUp(J.MoonkinForm)and i:DebuffRefreshable(J.SunfireDebuff)or g:BuffUp(J.MoonkinForm)and g:BuffUp(J.HeartoftheWild)or Z and g:BuffDown(J.OathofElderDruidBuff)or a2==3 and J.ConvoketheSpirits:CooldownRemains()<=1 or a2==1 and J.EmpowerBond:CooldownRemains()<=1 and X<2)then local ShouldReturn=aw()if ShouldReturn then return ShouldReturn end end;if v and(a0 and J.BalanceAffinity:IsAvailable()and g:BuffUp(J.LycarasFleetingGlimpse)and g:BuffRemains(J.LycarasFleetingGlimpse)<=2)then local ShouldReturn=ap()if ShouldReturn then return ShouldReturn end end;if v and(a0 and J.FeralAffinity:IsAvailable()and g:BuffUp(J.LycarasFleetingGlimpse)and g:BuffRemains(J.LycarasFleetingGlimpse)<=2)then local ShouldReturn=aq()if ShouldReturn then return ShouldReturn end end;if I.Guardian.SwapForConvoke and q and(J.BalanceAffinity:IsAvailable()and not v and(a2==3 and J.ConvoketheSpirits:CooldownRemains()<=1))then local ShouldReturn=ar()if ShouldReturn then return ShouldReturn end end;if I.Guardian.SwapForConvoke and q and(J.FeralAffinity:IsAvailable()and not v and(a2==3 and J.ConvoketheSpirits:CooldownRemains()<=1))then local ShouldReturn=as()if ShouldReturn then return ShouldReturn end end;if true then local ShouldReturn=at()if ShouldReturn then return ShouldReturn end end;if true then if m.CastAnnotated(J.Pool,false,"WAIT")then return"Wait/Pool Resources"end end end end;local function aH()end;function ReturnSpell()if T==0 then return 0 else return T end end;function ReturnSpellMO()if S==0 then return 0 else return S end end;m.SetAPL(104,az,aH)