local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=HeroRotation;local m=l.Cast;local n=l.CDsON;local o=l.AoEON;local p=HeroRotationCharDB.Toggles[4]local q=HeroRotationCharDB.Toggles[5]local r=HeroRotationCharDB.Toggles[6]local s=HeroRotationCharDB.Toggles[12]local t=HeroRotationCharDB.Toggles[13]local u=HeroRotationCharDB.Toggles[14]local v=HeroRotationCharDB.Toggles[15]local w=HeroRotationCharDB.Toggles[16]local x=HeroRotationCharDB.Toggles[80]local y=HeroRotationCharDB.Toggles[81]local z=HeroRotationCharDB.Toggles[82]local A=0;local B=j.DeathKnight.Blood;local C=k.DeathKnight.Blood;local D={}local E;local F;local G;local H;local I;local J=d.GhoulTable;local K;local L;local M=0;local N=999999;local O=0;local P=g:CovenantID()d:RegisterForEvent(function()P=g:CovenantID()end,"COVENANT_CHOSEN")local Q=l.Commons.Everyone;local R={General=l.GUISettings.General,Commons=l.GUISettings.APL.DeathKnight.Commons,Blood=l.GUISettings.APL.DeathKnight.Blood}local S={{B.Asphyxiate,"Cast Asphyxiate (Interrupt)",function()return true end}}local T=0;local U=0;d:RegisterForEvent(function()equip=g:GetEquipment()trinket1=k(0)trinket2=k(0)if equip[13]then trinket1=k(equip[13])end;if equip[14]then trinket2=k(equip[14])end;SuperstrainEquipped=g:HasLegendaryEquipped(30)PhearomonesEquipped=g:HasLegendaryEquipped(31)DeadliestCoilEquipped=g:HasLegendaryEquipped(45)end,"PLAYER_EQUIPMENT_CHANGED")local V={5,8,10,30,40,100}local W={}local function X()for _,Y in ipairs(V)do if Y==8 or 5 then W[Y]=h:IsInMeleeRange(Y)end;W[Y]=h:IsInRange(Y)end end;local function Z(a0)if a0 then return 1 else return 0 end end;local function a1(a0)return a0~=0 end;local function a2(a3)local a4=0;for _,a5 in pairs(a3)do if not a5:DebuffUp(B.BloodPlagueDebuff)then a4=a4+1 end end;return a4 end;local function a6()if Q.TargetIsValid()then if B.Fleshcraft:IsCastable()and(A==0 or A>B.Fleshcraft:ExecuteTime())and p and not g:IsMoving()then if m(B.Fleshcraft,nil,nil)then T=324631;return"fleshcraft precombat 1"end end;if B.DeathsCaress:IsReady()and not h:IsInMeleeRange(5)then if m(B.DeathsCaress,nil,nil,not h:IsSpellInRange(B.DeathsCaress))then T=195292;return"deaths_caress precombat 2"end end;if B.Marrowrend:IsReady()and h:IsInMeleeRange(5)then if m(B.Marrowrend)then T=195182;return"marrowrend precombat 4"end end;if B.BloodBoil:IsCastable()and h:IsInMeleeRange(10)then if m(B.BloodBoil)then T=50842;return"blood_boil precombat 6"end end end end;local function a7()if B.AntiMagicShell:IsReady()and M>0 and g:HealthPercentage()<=R.Commons.AntiMagicShellHP then if m(B.AntiMagicShell,nil,nil)then T=48707;return"AntiMagic Shell defensives 18"end end;if B.RuneTap:IsReady()and F and g:HealthPercentage()<=R.Blood.RuneTapThreshold and g:Rune()>=3 and B.RuneTap:Charges()>=1 and g:BuffDown(B.RuneTapBuff)then if m(B.RuneTap,nil)then T=194679;return"rune_tap defensives 2"end end;if Q.ActiveMitigationNeeded()and B.Marrowrend:TimeSinceLastCast()>2.5 and B.DeathStrike:TimeSinceLastCast()>2.5 then if B.DeathStrike:IsReady()and not L and g:BuffStack(B.BoneShieldBuff)>7 then if m(B.DeathStrike,nil,nil,not h:IsSpellInRange(B.DeathStrike))then T=49998;return"death_strike defensives 4"end end;if B.Marrowrend:IsReady()then if m(B.Marrowrend,nil,nil,not h:IsSpellInRange(B.Marrowrend))then T=195182;return"marrowrend defensives 6"end end;if B.Tombstone:IsReady()and g:BuffStack(B.BoneShieldBuff)>=7 then if m(B.Tombstone,nil)then T=219808;return"tombstone defensives 8"end end;if B.DeathStrike:IsReady()and not L then if m(B.DeathStrike,nil,nil,not h:IsSpellInRange(B.DeathStrike))then T=49998;return"death_strike defensives 10"end end end;if B.Marrowrend:IsReady()and(g:BuffRemains(B.BoneShieldBuff)<=6 or h:TimeToDie()<5 and g:BuffRemains(B.BoneShieldBuff)<10 and H==1)then if m(B.Marrowrend,nil,nil,not h:IsSpellInRange(B.Marrowrend))then T=195182;return"marrowrend defensives 12"end end;if B.VampiricBlood:IsCastable()and F and g:HealthPercentage()<=R.Blood.VampiricBloodThreshold and g:BuffDown(B.IceboundFortitudeBuff)then if m(B.VampiricBlood,nil)then T=55233;return"vampiric_blood defensives 14"end end;if B.Lichborne:IsReady()and g:HealthPercentage()<=R.Commons.LichborneHP then if m(B.Lichborne,nil,nil)then T=49039;return"Lichborne defensives 18"end end;if B.DeathPact:IsAvailable()and B.DeathPact:IsReady()and g:HealthPercentage()<=R.Commons.DeathPactHP then if m(B.DeathPact,nil,nil)then T=48743;return"DeathPact defensives 18"end end;if B.IceboundFortitude:IsCastable()and F and g:HealthPercentage()<=R.Blood.IceboundFortitudeThreshold and g:BuffDown(B.VampiricBloodBuff)then if m(B.IceboundFortitude,nil)then T=48792;return"icebound_fortitude defensives 16"end end;if B.DeathStrike:IsReady()and not L and g:HealthPercentage()<=50+(g:RunicPower()>90 and 20 or 0)and not g:HealingAbsorbed()then if m(B.DeathStrike,nil,nil,not h:IsSpellInRange(B.DeathStrike))then T=49998;return"death_strike defensives 18"end end end;local function a8()if B.BloodTap:IsCastable()and(g:Rune()<=2 and g:RuneTimeToX(4)>g:GCD()and B.BloodTap:ChargesFractional()>=1.8)then if m(B.BloodTap)then T=221699;return"blood_tap standard 2"end end;if B.DancingRuneWeapon:IsCastable()and not z and n()and(not B.Blooddrinker:IsAvailable()or not B.Blooddrinker:CooldownUp())then if m(B.DancingRuneWeapon,nil)then T=49028;return"dancing_rune_weapon standard 4"end end;if B.Marrowrend:IsReady()and((P~=4 or g:BuffUp(B.AbominationLimbBuff))and(g:BuffRemains(B.BoneShieldBuff)<=g:RuneTimeToX(3)or g:BuffRemains(B.BoneShieldBuff)<=g:GCD()+Z(B.Blooddrinker:CooldownUp())*Z(B.Blooddrinker:IsAvailable())*2 or g:BuffStack(B.BoneShieldBuff)<3)and g:RunicPowerDeficit()>=20)then if m(B.Marrowrend,nil,nil,not h:IsSpellInRange(B.Marrowrend))then T=195182;return"marrowrend standard 8"end end;if B.DeathStrike:IsReady()and not L and not K and g:RunicPowerDeficit()<=70 then if m(B.DeathStrike,nil,nil,not h:IsSpellInRange(B.DeathStrike))then T=49998;return"death_strike standard 10"end end;if B.Marrowrend:IsReady()and(g:BuffStack(B.BoneShieldBuff)<6 and g:RunicPowerDeficit()>=15 and(P~=3 or g:BuffRemains(B.DeathsDueBuff)>5))then if m(B.Marrowrend,nil,nil,not h:IsSpellInRange(B.Marrowrend))then T=195182;return"marrowrend standard 12"end end;if B.HeartStrike:IsReady()and(not B.Blooddrinker:IsAvailable()and g:BuffRemains(B.DeathAndDecayBuff)<5 and g:RunicPowerDeficit()<=15+Z(g:BuffUp(B.DancingRuneWeaponBuff))*5+H*Z(B.Heartbreaker:IsAvailable())*2)then if m(B.HeartStrike,nil,nil,not h:IsSpellInRange(B.HeartStrike))then T=206930;return"heart_strike standard 14"end end;if B.BloodBoil:IsCastable()and h:IsInRange(10)and(B.BloodBoil:ChargesFractional()>=1.8 and(g:BuffStack(B.HemostasisBuff)<=5-EnemiesCount10y or EnemiesCount10y>2))then if m(B.BloodBoil,nil,nil,not h:IsInMeleeRange(10))then T=50842;return"blood_boil standard 16"end end;if B.DeathAndDecay:IsReady()and(g:BuffUp(B.CrimsonScourgeBuff)and B.RelishinBlood:IsAvailable()and g:RunicPowerDeficit()>10)then if m(B.DeathAndDecay,nil,nil,not h:IsInRange(30))then T=43265;return"death_and_decay standard 18"end end;if B.Bonestorm:IsReady()and not L and(g:RunicPower()>=R.Blood.BonestormPower and g:BuffDown(B.DancingRuneWeaponBuff))then if m(B.Bonestorm,nil,nil,not h:IsInRange(8))then T=194844;return"bonestorm standard 20"end end;if B.DeathStrike:IsReady()and not L and not K and(g:RunicPowerDeficit()<=15+Z(g:BuffUp(B.DancingRuneWeaponBuff))*5+H*Z(B.Heartbreaker:IsAvailable())*2 or h:TimeToDie()<10)then if m(B.DeathStrike,nil,nil,not h:IsSpellInRange(B.DeathStrike))then T=49998;return"death_strike standard 22"end end;if B.DeathAndDecay:IsReady()and H>=3 then if m(B.DeathAndDecay,nil,nil,not h:IsInRange(30))then T=43265;return"death_and_decay standard 24"end end;if B.HeartStrike:IsReady()and(g:BuffUp(B.DancingRuneWeaponBuff)or g:RuneTimeToX(4)<g:GCD())then if m(B.HeartStrike,nil,nil,not h:IsSpellInRange(B.HeartStrike))then T=206930;return"heart_strike standard 26"end end;if B.BloodBoil:IsCastable()and h:IsInRange(10)and g:BuffUp(B.DancingRuneWeaponBuff)then if m(B.BloodBoil,nil,nil,not h:IsInMeleeRange(10))then T=50842;return"blood_boil standard 28"end end;if B.BloodTap:IsCastable()and g:RuneTimeToX(3)>g:GCD()then if m(B.BloodTap)then T=221699;return"blood_tap standard 30"end end;if B.DeathAndDecay:IsReady()and(g:BuffUp(B.CrimsonScourgeBuff)or B.RapidDecomposition:IsAvailable()or H>=2)then if m(B.DeathAndDecay,nil,nil,not h:IsInRange(30))then T=43265;return"death_and_decay standard 32"end end;if B.Consumption:IsCastable()then if m(B.Consumption,nil,nil,not h:IsSpellInRange(B.Consumption))then T=274156;return"consumption standard 34"end end;if B.BloodBoil:IsCastable()and h:IsInRange(10)and B.BloodBoil:ChargesFractional()>=1.1 then if m(B.BloodBoil,nil,nil,not h:IsInMeleeRange(10))then T=50842;return"blood_boil standard 36"end end;if B.HeartStrike:IsReady()and(g:Rune()>1 and(g:RuneTimeToX(3)<g:GCD()or g:BuffStack(B.BoneShieldBuff)>7))then if m(B.HeartStrike,nil,nil,not h:IsSpellInRange(B.HeartStrike))then T=206930;return"heart_strike standard 38"end end;if B.ArcaneTorrent:IsCastable()and R.Commons.Enabled.Racials and n()and g:RunicPowerDeficit()>20 then if m(B.ArcaneTorrent,nil,nil,not h:IsInMeleeRange(8))then T=155145;return"arcane_torrent standard 40"end end end;local function a9()if B.DeathStrike:IsReady()and not L and not K and(P==3 and g:BuffRemains(B.DeathsDueBuff)>6 and g:RunicPower()>70)then if m(B.DeathStrike,nil,nil,not h:IsSpellInRange(B.DeathStrike))then T=49998;return"death_strike covenants 2"end end;if B.HeartStrike:IsReady()and(P==3 and g:BuffUp(B.DeathAndDecayBuff)and((g:BuffUp(B.DeathsDueBuff)or g:BuffUp(B.DancingRuneWeaponBuff))and g:BuffRemains(B.DeathsDueBuff)))then if m(B.HeartStrike,nil,nil,not h:IsSpellInRange(B.HeartStrike))then T=206930;return"heart_strike covenants 4"end end;if B.DeathsDue:IsReady()and p and(g:BuffDown(B.DeathsDueBuff)or g:BuffRemains(B.DeathsDueBuff)<4 or g:BuffUp(B.CrimsonScourgeBuff))then if m(B.DeathsDue,nil,nil,not h:IsSpellInRange(B.DeathsDue))then T=324128;return"deaths_due covenants 6"end end;if J.active()and B.SacrificialPact:IsReady()and((P~=3 or g:BuffRemains(B.DeathsDueBuff)>6)and g:BuffDown(B.DancingRuneWeaponBuff)and(J.remains()<10 or d.FilteredFightRemains(Enemies10y,"<",g:GCD())))then if m(B.SacrificialPact,nil)then T=237574;return"sacrificial_pact covenants 8"end end;if B.DeathStrike:IsReady()and not L and not K and(P==2 and g:RunicPower()>70 and B.SwarmingMist:CooldownRemains()<3)then if m(B.DeathStrike,nil,nil,not h:IsSpellInRange(B.DeathStrike))then T=49998;return"death_strike covenants 10"end end;if B.SwarmingMist:IsReady()and p and g:BuffDown(B.DancingRuneWeaponBuff)then if m(B.SwarmingMist,nil,nil)then T=311648;return"swarming_mist covenants 12"end end;if B.Marrowrend:IsReady()and(P==4 and g:BuffDown(B.BoneShieldBuff))then if m(B.Marrowrend,nil,nil,not h:IsSpellInRange(B.Marrowrend))then T=195182;return"marrowrend covenants 14"end end;if B.AbominationLimb:IsCastable()and p and g:BuffDown(B.DancingRuneWeaponBuff)then if m(B.AbominationLimb,nil,nil,not h:IsInRange(8))then T=315443;return"abomination_limb covenants 16"end end;if B.ShackleTheUnworthy:IsCastable()and p and(B.DancingRuneWeapon:CooldownRemains()<3 or g:BuffDown(B.DancingRuneWeaponBuff))then if m(B.ShackleTheUnworthy,nil,nil,not h:IsSpellInRange(B.ShackleTheUnworthy))then T=312202;return"shackle_the_unworthy covenants 18"end end;if B.Fleshcraft:IsCastable()and(A==0 or A>B.Fleshcraft:ExecuteTime())and not g:IsMoving()and p and(B.PustuleEruption:SoulbindEnabled()or B.VolatileSolvent:SoulbindEnabled())then if m(B.Fleshcraft,nil,nil)then T=324631;return"fleshcraft covenants 20"end end end;local function aa()r=HeroRotationCharDB.Toggles[6]p=HeroRotationCharDB.Toggles[4]q=HeroRotationCharDB.Toggles[5]s=HeroRotationCharDB.Toggles[12]t=HeroRotationCharDB.Toggles[13]u=HeroRotationCharDB.Toggles[14]v=HeroRotationCharDB.Toggles[15]w=HeroRotationCharDB.Toggles[16]x=HeroRotationCharDB.Toggles[80]y=HeroRotationCharDB.Toggles[81]z=HeroRotationCharDB.Toggles[82]K=false;L=false;if B.Bonestorm:IsAvailable()and n()and B.Bonestorm:CooldownRemains()<=0 and B.Bonestorm:IsCastable()then K=true end;if GetTime()-N>=5 then M=0 end;A=0;for Y=1,20 do if select(10,UnitDebuff("player",Y))==240447 then if select(6,UnitDebuff("player",Y))~=nil then A=select(6,UnitDebuff("player",Y))-GetTime()end end end end;local function ab(self,ac)local ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,O,ar,as,at,au,av,aw,ax,ay,az=CombatLogGetCurrentEventInfo()if ak==UnitGUID("player")then if string.match(ae,"_DAMAGE")then if ae~="SWING_DAMAGE"and aq~=1 then N=GetTime()M=O end end end end;local aA=CreateFrame("Frame")aA:RegisterEvent("COMBAT_LOG_EVENT_UNFILTERED")aA:SetScript("OnEvent",ab)local function aB()Enemies10y=g:GetEnemiesInRange(10)if o()then G=g:GetEnemiesInMeleeRange(8)H=#G;EnemiesCount10y=#Enemies10y else H=1;EnemiesCount10y=1 end;I=a2(Enemies10y)TopTrinketID,_=GetInventoryItemID("player",13)BotTrinketID,_=GetInventoryItemID("player",14)ActiveMitigationNeeded=g:ActiveMitigationNeeded()F=g:IsTankingAoE(8)or g:IsTanking(h)if not BotOn then U=0;T=0 end;if U>0 then U=0 end;if T>0 then T=0 end;E=aa()if l.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+l.GUISettings.General.OpenerReset elseif l.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]l.ToggleIconFrame:UpdateButtonText(6)l.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if g:IsChanneling(j(324631))then if l.CastAnnotated(B.Pool,false,"WAIT")then T=99999;return"Pool During Blooddrinker"end end;if not g:AffectingCombat()and Q.TargetIsValid()and r then local E=a6()if E then return E end end;if not UnitIsEnemy("player","mouseover")and UnitIsPlayer("mouseover")and UnitIsDead("mouseover")then if B.RaiseAlly:IsCastable()and g:RunicPower()>=30 then if m(B.RaiseAlly,nil)then U=161999;return"RaiseAlly MO"end elseif B.RaiseAlly:CooldownRemains(BypassRecovery)<=0 and g:RunicPower()<30 then L=true end end;if w and B.Asphyxiate:IsUsableP()and B.Asphyxiate:CooldownRemains(BypassRecovery)<=0 then if l.Cast(B.Asphyxiate,nil,nil,nil)then if f("mouseover"):GUID()~=nil and f("mouseover"):IsSpellInRange(B.Asphyxiate)then U=1221562;return"queue Asphyxiate MO"else T=221562;return"queue Asphyxiate"end end elseif(not B.Asphyxiate:IsUsableP()or B.Asphyxiate:CooldownRemains()>0)and w then HeroRotationCharDB.Toggles[16]=not HeroRotationCharDB.Toggles[16]l.Print("Asphyxiate Queue is now "..(HeroRotationCharDB.Toggles[16]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if u and B.DeathGrip:IsUsableP()and B.DeathGrip:CooldownRemains(BypassRecovery)<=0 then if l.Cast(B.DeathGrip,nil,nil,nil)then if f("mouseover"):GUID()~=nil and f("mouseover"):IsSpellInRange(B.DeathGrip)then U=149576;return"queue DeathGrip MO"else T=49576;return"queue DeathGrip"end end elseif(not B.DeathGrip:IsUsableP()or B.DeathGrip:CooldownRemains()>0)and u then HeroRotationCharDB.Toggles[14]=not HeroRotationCharDB.Toggles[14]l.Print("DeathGrip Queue is now "..(HeroRotationCharDB.Toggles[14]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if x and B.GorefiendsGrasp:IsUsableP()and B.GorefiendsGrasp:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if l.Cast(B.GorefiendsGrasp,nil,nil,nil)then T=108199;return"queue Gorefiends Grasp"end elseif(not B.GorefiendsGrasp:IsUsableP()or B.GorefiendsGrasp:CooldownRemains()>0 or not g:AffectingCombat())and x then HeroRotationCharDB.Toggles[80]=not HeroRotationCharDB.Toggles[80]l.Print("Gorefiend's Grasp Queue is now "..(HeroRotationCharDB.Toggles[80]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if t and B.AntiMagicZone:IsUsableP()and B.AntiMagicZone:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if l.Cast(B.AntiMagicZone,nil,nil,nil)then T=51052;return"queue Anti Magic Zone"end elseif(not B.AntiMagicZone:IsUsableP()or B.AntiMagicZone:CooldownRemains()>0 or not g:AffectingCombat())and t then HeroRotationCharDB.Toggles[13]=not HeroRotationCharDB.Toggles[13]l.Print("Anti-Magic Zone Queue is now "..(HeroRotationCharDB.Toggles[13]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if y and B.ControlUndead:IsUsableP()and B.ControlUndead:CooldownRemains(BypassRecovery)<=0 and not g:PrevGCD(1,B.ControlUndead)then if l.Cast(B.ControlUndead,nil,nil,nil)then if f("mouseover"):GUID()~=nil and f("mouseover"):IsInRange(30)then U=1111673;return"queue ControlUndead MO"else T=111673;return"queue ControlUndead"end end elseif(not B.ControlUndead:IsUsableP()or B.ControlUndead:CooldownRemains()>0 or g:PrevGCD(1,B.ControlUndead))and y then HeroRotationCharDB.Toggles[81]=not HeroRotationCharDB.Toggles[81]l.Print("Control Undead Queue is now "..(HeroRotationCharDB.Toggles[81]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if Q.TargetIsValid()and g:AffectingCombat()then if R.Commons.UseDefensives then local E=a7()if E then return E end end;if g:IsChanneling(B.Blooddrinker)and g:BuffUp(B.BoneShieldBuff)and I==0 and not g:ShouldStopCasting()and g:CastRemains()>0.2 then if l.CastAnnotated(B.Pool,false,"WAIT")then T=99999;return"Pool During Blooddrinker"end end;if n()then if B.BloodFury:IsCastable()and R.Commons.Enabled.Racials and((B.DancingRuneWeapon:CooldownUp()or z)and(not B.Blooddrinker:IsReady()or not B.Blooddrinker:IsAvailable()))then if m(B.BloodFury,nil)then T=20572;return"blood_fury main 2"end end;if B.Berserking:IsCastable()and R.Commons.Enabled.Racials then if m(B.Berserking,nil)then T=26297;return"berserking main 4"end end;if B.ArcanePulse:IsCastable()and R.Commons.Enabled.Racials and(H>=2 or g:Rune()<1 and g:RunicPowerDeficit()>60)then if m(B.ArcanePulse,nil,nil,not h:IsInRange(8))then T=260364;return"arcane_pulse main 6"end end;if B.LightsJudgment:IsCastable()and R.Commons.Enabled.Racials and g:BuffUp(B.UnholyStrengthBuff)then if m(B.LightsJudgment,nil,nil,not h:IsSpellInRange(B.LightsJudgment))then T=255647;return"lights_judgment main 8"end end;if B.AncestralCall:IsCastable()and R.Commons.Enabled.Racials then if m(B.AncestralCall,nil)then T=274738;return"ancestral_call main 10"end end;if B.Fireblood:IsCastable()and R.Commons.Enabled.Racials then if m(B.Fireblood,nil)then T=265221;return"fireblood main 12"end end;if B.BagofTricks:IsCastable()and R.Commons.Enabled.Racials then if m(B.BagofTricks,nil,nil,not h:IsSpellInRange(B.BagofTricks))then T=312411;return"bag_of_tricks main 14"end end end;if C.PotionofPhantomFire:IsReady()and R.Commons.Enabled.Potions and g:BuffUp(B.DancingRuneWeaponBuff)then if m(C.PotionofPhantomFire,nil,nil)then T=37;return"potion main 16"end end;if(R.Commons.Enabled.TopTrinket or R.Commons.Enabled.BottomTrinket)and n()then local aC=g:GetUseableTrinkets(D)if aC then if m(aC,nil,nil)then if aC:ID()==TopTrinketID and R.Commons.Enabled.TopTrinket then T=24;return"top trinket 1"elseif aC:ID()==BotTrinketID and R.Commons.Enabled.BottomTrinket then T=30;return"top trinket 2"end end end end;if B.Blooddrinker:IsReady()and(A==0 or A>3)and(g:BuffDown(B.DancingRuneWeaponBuff)and(P~=3 or g:BuffRemains(B.DeathsDueBuff)>7))then if m(B.Blooddrinker,nil,nil,not h:IsSpellInRange(B.Blooddrinker))then T=206931;return"blooddrinker main 20"end end;if B.BloodBoil:IsCastable()and h:IsInRange(10)and(B.BloodBoil:Charges()>=2 and(P==1 or g:BuffUp(B.DancingRuneWeaponBuff)))then if m(B.BloodBoil,nil,nil,not h:IsInMeleeRange(10))then T=50842;return"blood_boil main 22"end end;if n()and not i:DebuffUp(j(111673))and B.RaiseDead:IsCastable()then if m(B.RaiseDead,nil,nil)then T=46585;return"raise_dead main 24"end end;if B.DeathStrike:IsReady()and not K and not L and d.FilteredFightRemains(Enemies10y,"<",3)then if m(B.DeathStrike,nil,nil,not h:IsSpellInRange(B.DeathStrike))then T=49998;return"death_strike main 26"end end;if true then local E=a9()if E then return E end end;if true then local E=a8()if E then return E end end;if l.CastAnnotated(B.Pool,false,"WAIT")then return"Wait/Pool Resources"end end end;local function aD()end;function ReturnSpell1()if T==0 then return 0 else return T end end;function ReturnSpellMO1()if U==0 then return 0 else return U end end;l.SetAPL(250,aB,aD)