local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.MultiSpell;local l=d.Item;local m=HeroRotation;local n=m.Cast;local o=m.CDsON;local p=m.AoEON;local q=HeroRotationCharDB.Toggles[4]local r=HeroRotationCharDB.Toggles[5]local s=not HeroRotationCharDB.Toggles[15]local t=HeroRotationCharDB.Toggles[12]local u=HeroRotationCharDB.Toggles[60]local v=HeroRotationCharDB.Toggles[120]local w=HeroRotationCharDB.Toggles[121]local x=HeroRotationCharDB.Toggles[122]local y=HeroRotationCharDB.Toggles[123]local z=HeroRotationCharDB.Toggles[124]local A=HeroRotationCharDB.Toggles[171]local B=HeroRotationCharDB.Toggles[142]local C=HeroRotationCharDB.Toggles[17]local D=m.Commons.Everyone.num;local E=m.Commons.Everyone.bool;local GetTime=GetTime;local F=m.Commons.Hunter;local G=j.Hunter.Marksmanship;local H=l.Hunter.Marksmanship;local function D(I)if I then return 1 else return 0 end end;local J={G.SummonPet,G.SummonPet2,G.SummonPet3,G.SummonPet4,G.SummonPet5}local K={}local L=g:GetEquipment()local M=L[13]and l(L[13])or l(0)local N=L[14]and l(L[14])or l(0)local O,P=GetInventoryItemID("player",13)local Q,P=GetInventoryItemID("player",14)if L[13]then M=l(L[13])end;if L[14]then N=l(L[14])end;local R=M:IsEquippedAndReady()or M:CooldownRemains()>0;local S=N:IsEquippedAndReady()or N:CooldownRemains()>0;local T={LastCast=0,Count=0}local U;local V=11111;local W=11111;local X=0;local Y=0;local Z;local _;local a0;local a1;local a2=m.Commons.Everyone;local a3={General=m.GUISettings.General,Commons=m.GUISettings.APL.Hunter.Commons,Marksmanship=m.GUISettings.APL.Hunter.Marksmanship}local a4=h:HealthPercentage()>70 and G.CarefulAim:IsAvailable()local a5={{G.Intimidation,"Cast Intimidation (Interrupt)",function()return true end}}d:RegisterForEvent(function()L=g:GetEquipment()M=L[13]and l(L[13])or l(0)N=L[14]and l(L[14])or l(0)end,"PLAYER_EQUIPMENT_CHANGED")d:RegisterForEvent(function()T={LastCast=0,Count=0}V=11111;W=11111 end,"PLAYER_REGEN_ENABLED")d:RegisterForEvent(function()G.SerpentSting:RegisterInFlight()G.SteadyShot:RegisterInFlight()G.AimedShot:RegisterInFlight()end,"LEARNED_SPELL_IN_TAB")G.SerpentSting:RegisterInFlight()G.SteadyShot:RegisterInFlight()G.AimedShot:RegisterInFlight()local function a6()return g:BuffUp(G.TrickShotsBuff)and not g:IsCasting(G.AimedShot)and not g:IsChanneling(G.RapidFire)or g:BuffUp(G.VolleyBuff)end;local function a7()if(T.Count==0 or T.Count==1)and g:IsCasting(G.SteadyShot)and T.LastCast<GetTime()-G.SteadyShot:CastTime()then T.LastCast=GetTime()T.Count=T.Count+1 end;if not(g:IsCasting(G.SteadyShot)or g:PrevGCDP(1,G.SteadyShot))then T.Count=0 end;if G.SteadyFocusBuff.LastAppliedOnPlayerTime>T.LastCast then T.Count=0 end end;local function a8(a9)return a9:DebuffRemains(G.SerpentStingDebuff)end;local function aa(a9)return a9:DebuffRemains(G.SerpentStingDebuff)+D(G.SerpentSting:InFlight())*99 end;local function ab(a9)return a9:DebuffStack(G.LatentPoisonDebuff)end;local function ac(a9)if a9:DebuffRefreshable(G.SerpentStingDebuff)and not G.SerpentstalkersTrickery:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==f("mouseover"):GUID()and a3.Marksmanship.TargetSwap=="Mouseover"then Y=1271788;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and not G.SerpentstalkersTrickery:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a3.Marksmanship.TargetSwap=="AutoSwap"and a9:GUID()~=h:GUID()and not t then Y=999;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and not G.SerpentstalkersTrickery:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==h:GUID()then X=271788;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and not G.SerpentstalkersTrickery:IsAvailable()then return true end end;local function ad(a9)if a9:DebuffRefreshable(G.SerpentStingDebuff)and G.HydrasBite:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==f("mouseover"):GUID()and a3.Marksmanship.TargetSwap=="Mouseover"then Y=1271788;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and G.HydrasBite:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a3.Marksmanship.TargetSwap=="AutoSwap"and a9:GUID()~=h:GUID()and not t then Y=999;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and G.HydrasBite:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==h:GUID()then X=271788;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and G.HydrasBite:IsAvailable()then return true end end;local function ae(a9)if a9:DebuffRefreshable(G.SerpentStingDebuff)and G.PoisonInjection:IsAvailable()and not G.SerpentstalkersTrickery:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==f("mouseover"):GUID()and a3.Marksmanship.TargetSwap=="Mouseover"then Y=1271788;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and G.PoisonInjection:IsAvailable()and not G.SerpentstalkersTrickery:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a3.Marksmanship.TargetSwap=="AutoSwap"and a9:GUID()~=h:GUID()and not t then Y=999;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and G.PoisonInjection:IsAvailable()and not G.SerpentstalkersTrickery:IsAvailable()and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==h:GUID()then X=271788;return true elseif a9:DebuffRefreshable(G.SerpentStingDebuff)and G.PoisonInjection:IsAvailable()and not G.SerpentstalkersTrickery:IsAvailable()then return true end end;local function af(a9)if G.SerpentstalkersTrickery:IsAvailable()and(g:BuffDown(G.PreciseShotsBuff)or(g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime())and(not G.ChimaeraShot:IsAvailable()or a0<2)or g:BuffRemains(G.TrickShotsBuff)>G.AimedShot:ExecuteTime()and a0>1)and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==f("mouseover"):GUID()and a3.Marksmanship.TargetSwap=="Mouseover"then Y=119434;return true elseif G.SerpentstalkersTrickery:IsAvailable()and(g:BuffDown(G.PreciseShotsBuff)or(g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime())and(not G.ChimaeraShot:IsAvailable()or a0<2)or g:BuffRemains(G.TrickShotsBuff)>G.AimedShot:ExecuteTime()and a0>1)and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a3.Marksmanship.TargetSwap=="AutoSwap"and a9:GUID()~=h:GUID()and not t then Y=999;return true elseif G.SerpentstalkersTrickery:IsAvailable()and(g:BuffDown(G.PreciseShotsBuff)or(g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime())and(not G.ChimaeraShot:IsAvailable()or a0<2)or g:BuffRemains(G.TrickShotsBuff)>G.AimedShot:ExecuteTime()and a0>1)and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==h:GUID()then X=19434;return true elseif G.SerpentstalkersTrickery:IsAvailable()and(g:BuffDown(G.PreciseShotsBuff)or(g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime())and(not G.ChimaeraShot:IsAvailable()or a0<2)or g:BuffRemains(G.TrickShotsBuff)>G.AimedShot:ExecuteTime()and a0>1)then return true end end;local function ag(a9)if(g:BuffDown(G.PreciseShotsBuff)or(g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime())and(not G.ChimaeraShot:IsAvailable()or a0<2)or g:BuffRemains(G.TrickShotsBuff)>G.AimedShot:ExecuteTime()and a0>1)and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==f("mouseover"):GUID()and a3.Marksmanship.TargetSwap=="Mouseover"then Y=119434;return true elseif(g:BuffDown(G.PreciseShotsBuff)or(g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime())and(not G.ChimaeraShot:IsAvailable()or a0<2)or g:BuffRemains(G.TrickShotsBuff)>G.AimedShot:ExecuteTime()and a0>1)and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a3.Marksmanship.TargetSwap=="AutoSwap"and a9:GUID()~=h:GUID()and not t then Y=999;return true elseif(g:BuffDown(G.PreciseShotsBuff)or(g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime())and(not G.ChimaeraShot:IsAvailable()or a0<2)or g:BuffRemains(G.TrickShotsBuff)>G.AimedShot:ExecuteTime()and a0>1)and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==h:GUID()then X=19434;return true elseif g:BuffDown(G.PreciseShotsBuff)or(g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime())and(not G.ChimaeraShot:IsAvailable()or a0<2)or g:BuffRemains(G.TrickShotsBuff)>G.AimedShot:ExecuteTime()and a0>1 then return true end end;local function ah(a9)if G.SerpentstalkersTrickery:IsAvailable()and(g:BuffRemains(G.TrickShotsBuff)>=G.AimedShot:ExecuteTime()and(g:BuffDown(G.PreciseShotsBuff)or g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<G.AimedShot:CastTime()+g:GCD()))and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==f("mouseover"):GUID()and a3.Marksmanship.TargetSwap=="Mouseover"then Y=119434;return true elseif G.SerpentstalkersTrickery:IsAvailable()and(g:BuffRemains(G.TrickShotsBuff)>=G.AimedShot:ExecuteTime()and(g:BuffDown(G.PreciseShotsBuff)or g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<G.AimedShot:CastTime()+g:GCD()))and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a3.Marksmanship.TargetSwap=="AutoSwap"and a9:GUID()~=h:GUID()and not t then Y=999;return true elseif G.SerpentstalkersTrickery:IsAvailable()and(g:BuffRemains(G.TrickShotsBuff)>=G.AimedShot:ExecuteTime()and(g:BuffDown(G.PreciseShotsBuff)or g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<G.AimedShot:CastTime()+g:GCD()))and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==h:GUID()then X=19434;return true elseif G.SerpentstalkersTrickery:IsAvailable()and(g:BuffRemains(G.TrickShotsBuff)>=G.AimedShot:ExecuteTime()and(g:BuffDown(G.PreciseShotsBuff)or g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<G.AimedShot:CastTime()+g:GCD()))then return true end end;local function ai(a9)if g:BuffRemains(G.TrickShotsBuff)>=G.AimedShot:ExecuteTime()and(g:BuffDown(G.PreciseShotsBuff)or g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<G.AimedShot:CastTime()+g:GCD())and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==f("mouseover"):GUID()and a3.Marksmanship.TargetSwap=="Mouseover"then Y=119434;return true elseif g:BuffRemains(G.TrickShotsBuff)>=G.AimedShot:ExecuteTime()and(g:BuffDown(G.PreciseShotsBuff)or g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<G.AimedShot:CastTime()+g:GCD())and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a3.Marksmanship.TargetSwap=="AutoSwap"and a9:GUID()~=h:GUID()and not t then Y=999;return true elseif g:BuffRemains(G.TrickShotsBuff)>=G.AimedShot:ExecuteTime()and(g:BuffDown(G.PreciseShotsBuff)or g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<G.AimedShot:CastTime()+g:GCD())and(a9:AffectingCombat()or a9:IsDummy()or a9:NPCID()==153285)and a9:GUID()==h:GUID()then X=19434;return true elseif g:BuffRemains(G.TrickShotsBuff)>=G.AimedShot:ExecuteTime()and(g:BuffDown(G.PreciseShotsBuff)or g:BuffUp(G.TrueshotBuff)or G.AimedShot:FullRechargeTime()<G.AimedShot:CastTime()+g:GCD())then return true end end;local function aj()if G.Salvo:IsCastable()then if n(G.Salvo,nil)then X=400456;return"salvo precombat 3"end end;if G.AimedShot:IsReady()and not g:IsCasting(G.AimedShot)and(a0<3 and(not G.Volley:IsAvailable()or a0<2))then if n(G.AimedShot,nil,nil,not a1)then X=19434;return"aimed_shot precombat 6"end end;if G.WailingArrow:IsReady()and not g:IsCasting(G.WailingArrow)and(a0>2 or not G.SteadyFocus:IsAvailable())then if n(G.WailingArrow,nil,nil,not a1)then X=355589;return"wailing_arrow precombat 8"end end;if G.SteadyShot:IsCastable()and(a0>2 or G.Volley:IsAvailable()and a0==2)then if n(G.SteadyShot,nil,nil,not a1)then X=56641;return"steady_shot precombat 10"end end end;local function ak()if G.Berserking:IsReady()and(g:BuffUp(G.TrueshotBuff)or W<13)and a3.Commons.Enabled.Racials then if n(G.Berserking,nil)then X=137096;return"berserking cds 2"end end;if G.BloodFury:IsReady()and(g:BuffUp(G.TrueshotBuff)or G.Trueshot:CooldownRemains()>30 or W<16)and a3.Commons.Enabled.Racials then if n(G.BloodFury,nil)then X=20572;return"blood_fury cds 4"end end;if G.AncestralCall:IsReady()and(g:BuffUp(G.TrueshotBuff)or G.Trueshot:CooldownRemains()>30 or W<16)and a3.Commons.Enabled.Racials then if n(G.AncestralCall,nil)then X=274738;return"ancestral_call cds 6"end end;if G.Fireblood:IsReady()and(g:BuffUp(G.TrueshotBuff)or G.Trueshot:CooldownRemains()>30 or W<9)and a3.Commons.Enabled.Racials then if n(G.Fireblood,nil)then X=273104;return"fireblood cds 8"end end;if G.LightsJudgment:IsReady()and g:BuffDown(G.TrueshotBuff)and a3.Commons.Enabled.Racials then if n(G.LightsJudgment,nil,nil,not h:IsSpellInRange(G.LightsJudgment))then X=255647;return"lights_judgment cds 10"end end;if a3.Commons.Enabled.Potions and o()and s and(g:BuffUp(G.TrueshotBuff)and not m.GUISettings.General.HoldPotforBL or m.GUISettings.General.HoldPotforBL and g:BloodlustUp())then local al=a2.PotionSelected()if al and al:IsReady()then if n(al,nil,nil)then X=12;return"potion cds 12"end end end;if G.Salvo:IsCastable()and(a0>2 or G.Volley:CooldownRemains()<10)then if n(G.Salvo,nil)then X=400456;return"salvo cds 14"end end end;local function am()if G.SteadyShot:IsCastable()and(G.SteadyFocus:IsAvailable()and(T.Count==1 and g:BuffRemains(G.SteadyFocusBuff)<5 or g:BuffDown(G.SteadyFocusBuff)and g:BuffDown(G.TrueshotBuff)and T.Count~=2))then if n(G.SteadyShot,nil,nil,not a1)then X=56641;return"steady_shot st 2"end end;if G.AimedShot:IsReady()and(g:BuffUp(G.TrueshotBuff)and G.AimedShot:FullRechargeTime()<g:GCD()+G.AimedShot:CastTime()and G.LegacyoftheWindrunners:IsAvailable()and G.WindrunnersGuidance:IsAvailable())then if n(G.AimedShot,nil,nil,not a1)then X=19434;return"aimed_shot st 4"end end;if G.KillShot:IsReady()and g:BuffDown(G.TrueshotBuff)then if n(G.KillShot,nil,nil,not a1)then X=53351;return"kill_shot st 6"end end;if G.Volley:IsReady()and g:BuffUp(G.SalvoBuff)then if n(G.Volley,nil,nil,not a1)then X=260243;return"volley st 8"end end;if G.SteelTrap:IsCastable()and g:BuffDown(G.TrueshotBuff)then if n(G.SteelTrap,nil,nil,not h:IsInRange(40))then X=162488;return"steel_trap st 10"end end;if G.SerpentSting:IsReady()and g:BuffDown(G.TrueshotBuff)then if a2.CastTargetIf(G.SerpentSting,Z,"min",a8,ac,not a1)then return"serpent_sting st 12"end end;if G.ExplosiveShot:IsReady()then if n(G.ExplosiveShot,nilt,nil,not a1)then X=212431;return"explosive_shot st 14"end end;if G.Stampede:IsCastable()then if n(G.Stampede,nil,nil,not h:IsInRange(30))then X=201430;return"stampede st 16"end end;if G.DeathChakram:IsReady()and q then if n(G.DeathChakram,nil,nil,not a1)then X=325028;return"dark_chakram st 18"end end;if G.WailingArrow:IsReady()and a0>1 then if n(G.WailingArrow,nil,nil,not a1)then X=355589;return"wailing_arrow st 20"end end;if G.RapidFire:IsCastable()and G.SurgingShots:IsAvailable()then if n(G.RapidFire,nil,nil,not a1)then X=257044;return"rapid_fire st 22"end end;if G.KillShot:IsReady()then if n(G.KillShot,nil,nil,not a1)then X=53351;return"kill_shot st 24"end end;if G.Trueshot:IsReady()and o()and(U and(g:BuffDown(G.TrueshotBuff)or g:BuffRemains(G.TrueshotBuff)<5))then if n(G.Trueshot,nil)then X=288613;return"trueshot st 26"end end;if G.MultiShot:IsReady()and(g:BuffUp(G.SalvoBuff)and not G.Volley:IsAvailable())then if n(G.MultiShot,nil,nil,not a1)then X=257620;return"multishot st 28"end end;if G.AimedShot:IsReady()then if a2.CastTargetIf(G.AimedShot,Z,"min",aa,af,not a1)then return"aimed_shot st 30"end end;if G.AimedShot:IsReady()then if a2.CastTargetIf(G.AimedShot,Z,"max",ab,ag,not a1)then return"aimed_shot st 32"end end;if G.Volley:IsReady()then if n(G.Volley,nil)then X=260243;return"volley trickshots 36"end end;if G.RapidFire:IsCastable()then if n(G.RapidFire,nil,nil,not a1)then X=257044;return"rapid_fire st 38"end end;if G.WailingArrow:IsReady()and g:BuffDown(G.TrueshotBuff)then if n(G.WailingArrow,nil,nil,not a1)then X=355589;return"wailing_arrow st 40"end end;if G.KillCommand:IsCastable()and g:BuffDown(G.TrueshotBuff)then if n(G.KillCommand,nil,nil,not h:IsInRange(50))then X=34026;return"kill_command st 42"end end;if G.ChimaeraShot:IsReady()and(g:BuffUp(G.PreciseShotsBuff)or g:FocusPredicted()>G.ChimaeraShot:Cost()+G.AimedShot:Cost())then if n(G.ChimaeraShot,nil,nil,not a1)then X=342049;return"chimaera_shot st 44"end end;if G.ArcaneShot:IsReady()and(g:BuffUp(G.PreciseShotsBuff)or g:FocusPredicted()>G.ArcaneShot:Cost()+G.AimedShot:Cost())then if n(G.ArcaneShot,nil,nil,not a1)then X=185358;return"arcane_shot st 46"end end;if G.BagofTricks:IsReady()then if n(G.BagofTricks,nil,nil,not h:IsSpellInRange(G.BagofTricks))then X=312411;return"bag_of_tricks st 48"end end;if G.SteadyShot:IsCastable()then if n(G.SteadyShot,nil,nil,not a1)then X=56641;return"steady_shot st 50"end end end;local function an()if G.SteadyShot:IsCastable()and(G.SteadyFocus:IsAvailable()and T.Count==1 and g:BuffRemains(G.SteadyFocusBuff)<8)then if n(G.SteadyShot,nil,nil,not a1)then X=56641;return"steady_shot trickshots 2"end end;if G.KillShot:IsReady()and g:BuffUp(G.RazorFragmentsBuff)then if n(G.KillShot,nil,nil,not a1)then X=53351;return"kill_shot trickshots 4"end end;if G.ExplosiveShot:IsReady()then if n(G.ExplosiveShot,nil,nil,not a1)then X=212431;return"explosive_shot trickshots 8"end end;if G.DeathChakram:IsReady()and q then if n(G.DeathChakram,nil,nil,not a1)then X=325028;return"death_chakram trickshots 10"end end;if G.Stampede:IsReady()then if n(G.Stampede,nil,nil,not h:IsInRange(30))then X=201430;return"stampede trickshots 12"end end;if G.WailingArrow:IsReady()then if n(G.WailingArrow,nil,nil,not a1)then X=355589;return"wailing_arrow trickshots 14"end end;if G.SerpentSting:IsReady()then if a2.CastTargetIf(G.SerpentSting,Z,"min",a8,ad,not a1)then return"serpent_sting trickshots 16"end end;if G.Barrage:IsReady()and a0>7 then if n(G.Barrage,nil,nil,not a1)then X=120360;return"barrage trickshots 18"end end;if G.Volley:IsReady()then if n(G.Volley,nil)then X=260243;return"volley trickshots 20"end end;if G.Trueshot:IsReady()and o()then if n(G.Trueshot,nil,nil,not a1)then X=288613;return"trueshot trickshots 22"end end;if G.RapidFire:IsCastable()and(g:BuffRemains(G.TrickShotsBuff)>=G.RapidFire:ExecuteTime()and G.SurgingShots:IsAvailable())then if n(G.RapidFire,nil,nil,not a1)then X=257044;return"rapid_fire trickshots 24"end end;if G.AimedShot:IsReady()then if a2.CastTargetIf(G.AimedShot,Z,"min",aa,ah,not a1)then return"aimed_shot trickshots 26"end end;if G.AimedShot:IsReady()then if a2.CastTargetIf(G.AimedShot,Z,"max",ab,ai,not a1)then return"aimed_shot trickshots 28"end end;if G.RapidFire:IsCastable()and g:BuffRemains(G.TrickShotsBuff)>=G.RapidFire:ExecuteTime()then if n(G.RapidFire,nil,nil,not a1)then X=257044;return"rapid_fire trickshots 30"end end;if G.ChimaeraShot:IsReady()and(g:BuffUp(G.TrickShotsBuff)and g:BuffUp(G.PreciseShotsBuff)and g:FocusPredicted()>G.ChimaeraShot:Cost()+G.AimedShot:Cost()and a0<4)then if n(G.ChimaeraShot,nil,nil,not a1)then X=342049;return"chimaera_shot trickshots 32"end end;if G.MultiShot:IsReady()and(not a6()or(g:BuffUp(G.PreciseShotsBuff)or g:BuffStack(G.BulletstormBuff)==10)and g:FocusPredicted()>G.MultiShot:Cost()+G.AimedShot:Cost())then if n(G.MultiShot,nil,nil,not a1)then X=257620;return"multishot trickshots 34"end end;if G.SerpentSting:IsReady()then if a2.CastTargetIf(G.SerpentSting,Z,"min",a8,ae,not a1)then return"serpent_sting trickshots 36"end end;if G.SteelTrap:IsCastable()and g:BuffDown(G.TrueshotBuff)then if n(G.SteelTrap,nil,nil,not h:IsInRange(40))then X=312411;return"steel_trap trickshots 38"end end;if G.KillShot:IsReady()and g:FocusPredicted()>G.KillShot:Cost()+G.AimedShot:Cost()then if n(G.KillShot,nil,nil,not a1)then X=53351;return"kill_shot trickshots 40"end end;if G.MultiShot:IsReady()and g:FocusPredicted()>G.MultiShot:Cost()+G.AimedShot:Cost()then if n(G.MultiShot,nil,nil,not a1)then X=257620;return"multishot trickshots 42"end end;if G.BagofTricks:IsReady()and g:BuffDown(G.Trueshot)then if n(G.BagofTricks,nil,nil,not h:IsSpellInRange(G.BagofTricks))then X=312411;return"bag_of_tricks trickshots 44"end end;if G.SteadyShot:IsCastable()then if n(G.SteadyShot,nil,nil,not a1)then X=56641;return"steady_shot trickshots 46"end end end;local function ao()local ap=g:GetUseableTrinkets(K,13)if ap and(not ap:TrinketHasUseBuff()or g:BuffUp(G.TrueshotBuff))then if n(ap,nil,nil)then X=24;return"trinket1 main 2"end end;local aq=g:GetUseableTrinkets(K,14)if aq and a3.Commons.Enabled.BottomTrinket and(not aq:TrinketHasUseBuff()or g:BuffUp(G.TrueshotBuff))then if n(aq,nil,nil)then X=25;return"trinket2 main 4"end end;if ap or aq then local ar=ap or aq;if m.Cast(ar,nil,nil)then if ar:ID()==O and a3.Commons.Enabled.TopTrinket then X=24;return"Generic use_items for "..ar:Name()elseif ar:ID()==Q and a3.Commons.Enabled.BottomTrinket then X=25;return"Generic use_items for "..ar:Name()end end end end;local function as()a1=h:IsSpellInRange(G.AimedShot)Z=g:GetEnemiesInRange(G.AimedShot.MaximumRange)_=h:GetEnemiesInSplashRange(10)if p()then a0=h:GetEnemiesInSplashRangeCount(10)else a0=1 end;if a2.TargetIsValid()or g:AffectingCombat()then V=d.BossFightRemains(nil,true)W=V;if W==11111 then W=d.FightRemains(_,false)end end;local function at()r=HeroRotationCharDB.Toggles[5]q=HeroRotationCharDB.Toggles[4]t=HeroRotationCharDB.Toggles[12]s=not HeroRotationCharDB.Toggles[15]u=HeroRotationCharDB.Toggles[60]v=HeroRotationCharDB.Toggles[120]w=HeroRotationCharDB.Toggles[121]x=HeroRotationCharDB.Toggles[122]y=HeroRotationCharDB.Toggles[123]z=HeroRotationCharDB.Toggles[124]A=HeroRotationCharDB.Toggles[171]HoldMD=HeroRotationCharDB.Toggles[125]B=HeroRotationCharDB.Toggles[142]C=HeroRotationCharDB.Toggles[17]O=GetInventoryItemID("player",13)Q=GetInventoryItemID("player",14)if not a3.Commons.Enabled.TopTrinket and not a3.Commons.Enabled.BotTrinket then K={O,Q}elseif not a3.Commons.Enabled.TopTrinket and a3.Commons.Enabled.BotTrinket then K={O}elseif not a3.Commons.Enabled.BotTrinket and a3.Commons.Enabled.TopTrinket then K={Q}elseif not a3.Commons.Enabled.BotTrinket and not a3.Commons.Enabled.TopTrinket then K={}end end;local function as()a1=h:IsSpellInRange(G.AimedShot)Z=g:GetEnemiesInRange(G.AimedShot.MaximumRange)_=h:GetEnemiesInSplashRange(10)if p()then a0=h:GetEnemiesInSplashRangeCount(10)else a0=1 end;if u then a0=10 end;if a2.TargetIsValid()or g:AffectingCombat()then V=d.BossFightRemains(nil,true)W=V;if W==11111 then W=d.FightRemains(_,false)end end;if not BotOn then Y=0;X=0 end;if Y>0 then Y=0 end;if X>0 then X=0 end;at()if m.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+m.GUISettings.General.OpenerReset elseif m.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]m.ToggleIconFrame:UpdateButtonText(6)m.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if g:BuffUp(j(5384))then return false end;if m.QueuedCast()then X=m.QueuedCast()return"Custom Queue "..j(X):ID()end;if v and G.Bindingshot:IsAvailable()and G.Bindingshot:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.Bindingshot,nil,nil,nil)then X=109248;return"queue Binding Shot"end elseif(not G.Bindingshot:IsUsableP()or G.Bindingshot:CooldownRemains()>0)and v then HeroRotationCharDB.Toggles[120]=not HeroRotationCharDB.Toggles[120]m.Print("Binding Shot Queue is now "..(HeroRotationCharDB.Toggles[120]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if w and G.FreezingTrap:IsAvailable()and G.FreezingTrap:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.FreezingTrap,nil,nil,nil)then X=187650;return"queue Freezing Trap"end elseif(not G.FreezingTrap:IsUsableP()or G.FreezingTrap:CooldownRemains()>0)and w then HeroRotationCharDB.Toggles[121]=not HeroRotationCharDB.Toggles[121]m.Print("Freezing Trap Queue is now "..(HeroRotationCharDB.Toggles[121]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if y and G.Flare:IsAvailable()and G.Flare:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.Flare,nil,nil,nil)then X=1543;return"queue Flare"end elseif(not G.Flare:IsUsableP()or G.Flare:CooldownRemains()>0)and y then HeroRotationCharDB.Toggles[123]=not HeroRotationCharDB.Toggles[123]m.Print("Flare Queue is now "..(HeroRotationCharDB.Toggles[123]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if z and G.TarTrap:IsAvailable()and G.TarTrap:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.TarTrap,nil,nil,nil)then X=187698;return"queue TarTrap"end elseif(not G.TarTrap:IsUsableP()or G.TarTrap:CooldownRemains()>0)and z then HeroRotationCharDB.Toggles[124]=not HeroRotationCharDB.Toggles[124]m.Print("Tar Trap Queue is now "..(HeroRotationCharDB.Toggles[124]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if A and G.DeathChakram:IsAvailable()and G.DeathChakram:CooldownRemains(BypassRecovery)<=0 then if m.Cast(G.DeathChakram,nil,nil,nil)then X=325028;return"queue Death Chakram"end elseif(not G.DeathChakram:IsUsableP()or G.DeathChakram:CooldownRemains()>0)and A then HeroRotationCharDB.Toggles[171]=not HeroRotationCharDB.Toggles[171]m.Print("Death Chakram Queue is now "..(HeroRotationCharDB.Toggles[171]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if G.Exhilaration:IsCastable()and g:HealthPercentage()<=a3.Commons.ExhilarationHP then if n(G.Exhilaration,nil)then X=109304;return"Exhilaration"end end;if g:HealthPercentage()<a3.Commons.HealthstoneHP and H.Healthstone:IsReady()and H.Healthstone:CooldownRemains()<=0 then if m.Cast(H.Healthstone,nil)then X=40;return"Healthstone HP"end end;if g:HealthPercentage()<a3.Commons.HealPotHP and H.CosmicHealPot:IsReady()and H.CosmicHealPot:CooldownRemains()<=0 then if m.Cast(H.CosmicHealPot,nil)then X=45;return"CosmicHealPot HP"end end;if g:HealthPercentage()<a3.Commons.HealPotHP and H.HealPot:IsReady()and H.HealPot:CooldownRemains()<=0 then if m.Cast(H.HealPot,nil)then X=41;return"HealPot HP"end end;if G.AspectoftheTurtle:IsCastable()and g:HealthPercentage()<=a3.Commons.TurtleHP then if n(G.AspectoftheTurtle,nil)then X=186265;return"AspectoftheTurtle"end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if G.ArcaneShot:IsCastable()and f("mouseover"):IsInMeleeRange(8)then if n(G.ArcaneShot,nil)then Y=1185358;return"explosive MO AS"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if G.ArcaneShot:IsCastable()and h:IsInMeleeRange(8)then if n(G.ArcaneShot,nil)then X=185358;return"explosive  SWD"end end end;if a2.TargetIsValid()then a7()if not g:AffectingCombat()and r then local au=aj()if au then return au end end;U=G.Trueshot:CooldownUp()if o()then local au=ak()if au then return au end end;local au=ao()if au then return au end;if a0<3 or not G.TrickShots:IsAvailable()then local au=am()if au then return au end end;if a0>2 then local au=an()if au then return au end end;if m.CastAnnotated(G.PoolFocus,false,"WAIT")then return"Pooling Focus"end end end;if a2.TargetIsValid()then a7()if not g:AffectingCombat()and r then local au=aj()if au then return au end end;U=G.Trueshot:CooldownUp()if o()then local au=ak()if au then return au end end;local au=ao()if au then return au end;if a0<3 or not G.TrickShots:IsAvailable()then local au=am()if au then return au end end;if a0>2 then local au=an()if au then return au end end;if m.CastAnnotated(G.PoolFocus,false,"WAIT")then return"Pooling Focus"end end end;function ReturnSpell()if X==0 then return 0 else return X end end;function ReturnSpellMO()if Y==0 then return 0 else return Y end end;local function av()m.Print("Marksmanship Hunter rotation is currently a work in progress, but has been updated for patch 10.0.")end;m.SetAPL(254,as,av)