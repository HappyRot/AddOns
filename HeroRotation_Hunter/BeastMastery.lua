local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=d.Action;local m=HeroRotation;local n=m.AoEON;local o=m.CDsON;local p=m.Cast;local q=m.CastSuggested;local r=HeroRotationCharDB.Toggles[4]local s=HeroRotationCharDB.Toggles[5]local t=HeroRotationCharDB.Toggles[6]local u=HeroRotationCharDB.Toggles[12]local v=HeroRotationCharDB.Toggles[15]local w=HeroRotationCharDB.Toggles[120]local x=HeroRotationCharDB.Toggles[121]local y=HeroRotationCharDB.Toggles[122]local z=HeroRotationCharDB.Toggles[123]local A=HeroRotationCharDB.Toggles[124]local B;local C;local D;local E;local F={228318,178658,333227,334800,334967,324737,326450,334470,326450,320703,320012,324085,333241,331510,344739}local G=math.max;local _G,pairs,type,table,string,error=_G,pairs,type,table,string,error;local H=m.Commons.Everyone;local I=m.Commons.Hunter;local J={General=m.GUISettings.General,Commons=m.GUISettings.APL.Hunter.Commons,BeastMastery=m.GUISettings.APL.Hunter.BeastMastery}local K=j.Hunter.BeastMastery;local L={K.SummonPet,K.SummonPet2,K.SummonPet3,K.SummonPet4,K.SummonPet5}local M=k.Hunter.BeastMastery;local N={}local O;local P=g:HasLegendaryEquipped(68)local Q=g:HasLegendaryEquipped(72)d:RegisterForEvent(function()P=g:HasLegendaryEquipped(68)Q=g:HasLegendaryEquipped(72)end,"PLAYER_EQUIPMENT_CHANGED")local R,S,T;local U,V;local W;local O;local X;local Y=0;local Z=0;local _={{K.Intimidation,"Cast Intimidation (Interrupt)",function()return true end}}local function a0()X=g:GCD()+0.150;if g:BuffUp(K.AspectoftheWildBuff)then X=G(0.75,X-0.2/(1+g:HastePct()/100))end end;function AreaTTD(a1)local a2=0;local a3=0;local a4=40;if a1~=nil then for a5 in pairs(a1)do local a6=a1[a5]if a6:IsInRange(a4)and(a6:AffectingCombat()or a6:IsDummy()or a6:NPCID()==153285)then local a7=a6:TimeToDie()a3=a3+1;a2=a7+a2 end end end;if a3==0 then return 0 end;return a2/a3 end;local function a8(a9)return a9~=0 end;local function aa(ab)return ab:DebuffRemains(K.BarbedShot)end;local function ac(ab)return h:GetEnemiesInSplashRangeCount(15)end;local function ad(ab)if(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and ab:GUID()==f("mouseover"):GUID()then Z=12643;return true elseif(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and J.BeastMastery.TargetSwap=="AutoSwap"and ab:GUID()~=h:GUID()and not u then Z=999;return true elseif(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and ab:GUID()==h:GUID()then Y=2643;return true elseif ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285 then return true end end;local function ae(ab)if i:BuffUp(K.FrenzyPetBuff)and i:BuffRemains(K.FrenzyPetBuff)<=X+0.5 and ab:TimeToDie()>6 and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and ab:GUID()==f("mouseover"):GUID()then Z=1217200;return true elseif i:BuffUp(K.FrenzyPetBuff)and i:BuffRemains(K.FrenzyPetBuff)<=X+0.5 and ab:TimeToDie()>6 and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and J.BeastMastery.TargetSwap=="AutoSwap"and ab:GUID()~=h:GUID()and not u then Z=999;return true elseif i:BuffUp(K.FrenzyPetBuff)and i:BuffRemains(K.FrenzyPetBuff)<=X+0.5 and ab:TimeToDie()>6 and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and ab:GUID()==h:GUID()then Y=217200;return true elseif i:BuffUp(K.FrenzyPetBuff)and i:BuffRemains(K.FrenzyPetBuff)<=X+0.5 and ab:TimeToDie()>6 and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)then return true end end;local function af(ab)if(K.BarbedShot:FullRechargeTime()<X+0.5 and a8(K.BestialWrath:CooldownRemains())and ab:TimeToDie()>6 or K.BestialWrath:CooldownRemains()<12+X and K.ScentOfBlood:IsAvailable()and ab:TimeToDie()>6)and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and ab:GUID()==f("mouseover"):GUID()then Z=1217200;return true elseif(K.BarbedShot:FullRechargeTime()<X+0.5 and a8(K.BestialWrath:CooldownRemains())and ab:TimeToDie()>6 or K.BestialWrath:CooldownRemains()<12+X and K.ScentOfBlood:IsAvailable()and ab:TimeToDie()>6)and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and J.BeastMastery.TargetSwap=="AutoSwap"and ab:GUID()~=h:GUID()and not u then Z=999;return true elseif(K.BarbedShot:FullRechargeTime()<X+0.5 and a8(K.BestialWrath:CooldownRemains())and ab:TimeToDie()>6 or K.BestialWrath:CooldownRemains()<12+X and K.ScentOfBlood:IsAvailable()and ab:TimeToDie()>6)and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and ab:GUID()==h:GUID()then Y=217200;return true elseif(K.BarbedShot:FullRechargeTime()<X+0.5 and a8(K.BestialWrath:CooldownRemains())and ab:TimeToDie()>6 or K.BestialWrath:CooldownRemains()<12+X and K.ScentOfBlood:IsAvailable()and ab:TimeToDie()>6)and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)then return true end end;local function ag(ab)if ab:TimeToDie()<9 and K.Bloodletting:ConduitEnabled()and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and ab:GUID()==f("mouseover"):GUID()then Z=1217200;return true elseif ab:TimeToDie()<9 and K.Bloodletting:ConduitEnabled()and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and J.BeastMastery.TargetSwap=="AutoSwap"and ab:GUID()~=h:GUID()and not u then Z=999;return true elseif ab:TimeToDie()<9 and K.Bloodletting:ConduitEnabled()and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)and ab:GUID()==h:GUID()then Y=217200;return true elseif ab:TimeToDie()<9 and K.Bloodletting:ConduitEnabled()and(ab:AffectingCombat()or ab:IsDummy()or ab:NPCID()==153285)then return true end end;local function ah()if H.TargetIsValid()and U then if K.BestialWrath:IsCastable()and D and UnitExists("pet")then if p(K.BestialWrath,nil)then Y=19574;return"Bestial Wrath (PreCombat)"end end;if K.BarbedShot:IsCastable()and K.BarbedShot:Charges()>=2 then if p(K.BarbedShot)then Y=217200;return"Barbed Shot (PreCombat)"end end;if K.KillShot:IsCastable()then if p(K.KillShot)then Y=53351;return"Kill Shot (PreCombat)"end end;if K.KillCommand:IsCastable()and UnitExists("pet")and W then if p(K.KillCommand)then Y=34026;return"Kill Command (PreCombat)"end end;if T>1 then if K.MultiShot:IsCastable()then if p(K.MultiShot)then Y=2643;return"Multi-Shot (PreCombat)"end end else if K.CobraShot:IsCastable()then if p(K.CobraShot)then Y=193455;return"Cobra Shot (PreCombat)"end end end end end;local function ai()if K.AncestralCall:IsCastable()and o()and(K.BestialWrath:CooldownRemains()>30 or not D)then if p(K.AncestralCall,nil)then Y=274738;return"Ancestral Call"end end;if K.Fireblood:IsCastable()and o()and(K.BestialWrath:CooldownRemains()>30 or not D)then if p(K.Fireblood,nil)then Y=265221;return"Fireblood"end end;if K.Berserking:IsCastable()and o()and(g:BuffUp(K.AspectoftheWildBuff)and(h:TimeToDie()>180+K.BerserkingBuff:BaseDuration()or(h:HealthPercentage()<35 or not K.KillerInstinct:IsAvailable()))or h:TimeToDie()<13)then if p(K.Berserking,nil)then Y=26297;return"Berserking"end end;if K.BloodFury:IsCastable()and o()and(g:BuffUp(K.AspectoftheWildBuff)and(h:TimeToDie()>120+K.BloodFuryBuff:BaseDuration()or(h:HealthPercentage()<35 or not K.KillerInstinct:IsAvailable()))or h:TimeToDie()<16)then if p(K.BloodFury,nil)then Y=20572;return"Blood Fury"end end;if K.LightsJudgment:IsCastable()and o()and(i:BuffRemains(K.FrenzyPetBuff)>X or i:BuffDown(K.FrenzyPetBuff))then if p(K.LightsJudgment,nil,nil,40)then Y=255647;return"Light's Judgment"end end;if J.Commons.Enabled.Potions and M.PotionOfSpectralAgility:IsReady()and v and(g:BuffUp(K.AspectoftheWildBuff)or h:TimeToDie()<26)then if p(M.PotionOfSpectralAgility,nil)then Y=50;return"Potion of Spectral Agility"end end end;local function aj()if B and K.AspectoftheWild:IsCastable()and UnitExists("pet")then if p(K.AspectoftheWild,nil)then Y=193530;return"Aspect of the Wild (Cleave)"end end;if K.BarbedShot:IsCastable()then if H.CastTargetIf(K.BarbedShot,R,"min",aa,ae)then return"Barbed Shot (Cleave - 1)"end;if i:BuffUp(K.FrenzyPetBuff)and i:BuffRemains(K.FrenzyPetBuff)<=X+0.5 then if p(K.BarbedShot,nil,nil,not U)then Y=217200;return"Barbed Shot (Cleave - 1@Target)"end end end;if K.MultiShot:IsReady()and(X-i:BuffRemains(K.BeastCleavePetBuff)>0.25 or X-g:BuffRemains(K.BeastCleaveBuff)>0.25)then if p(K.MultiShot,nil,nil,not U)then Y=2643;return"Multi-Shot (Cleave - 1)"end end;if K.TarTrap:IsCastable()and(P and h:BuffDown(K.SoulforgeEmbersDebuff)and K.Flare:CooldownRemains()<g:GCD())then if p(K.TarTrap,nil,nil,not h:IsInRange(40))then Y=187698;return"tar_trap st 4"end end;if K.Flare:IsCastable()and not K.TarTrap:CooldownUp()and P then if p(K.Flare,nil)then Y=1543;return"flare st 5"end end;if r and K.DeathChakram:IsCastable()and g:Focus()+g:FocusCastRegen(K.DeathChakram:ExecuteTime())<g:FocusMax()then if p(K.DeathChakram,nil,nil)then Y=325028;return"death_chakram st"end end;if r and K.WildSpirits:IsCastable()then if p(K.WildSpirits,nil,nil)then Y=328231;return"wild_spirits st"end end;if K.BarbedShot:IsCastable()then if H.CastTargetIf(K.BarbedShot,R,"min",aa,af)then return"Barbed Shot (Cleave - 2)"end;if K.BarbedShot:FullRechargeTime()<X+0.5 and a8(K.BestialWrath:CooldownRemains())or K.BestialWrath:CooldownRemains()<12+X and K.ScentOfBlood:IsAvailable()then if p(K.BarbedShot,nil,nil,not U)then Y=217200;return"Barbed Shot (Cleave - 2@Target)"end end end;if true then if K.BestialWrath:IsCastable()and UnitExists("pet")and D then if p(K.BestialWrath,nil)then Y=19574;return"Bestial Wrath (Cleave)"end end;if K.ResonatingArrow:IsCastable()and r then if p(K.ResonatingArrow,nil,nil)then Y=308491;return"resonating_arrow cleave"end end;if K.Stampede:IsCastable()and C and(g:BuffUp(K.AspectoftheWildBuff)or h:TimeToDie()<15 or not B)then if p(K.Stampede,nil,nil,not V)then Y=201430;return"Stampede (Cleave)"end end;if K.WailingArrow:IsReady()and s and not g:IsMoving()and h:IsInMeleeRange(40)then if p(K.WailingArrow,nil,nil,not U)then Y=355589;return"Wailing Arrow (Cleave)"end end;if K.FlayedShot:IsCastable()and r then if p(K.FlayedShot,nil,nil)then Y=324149;return"flayed_shot cleave"end end end;if K.KillShot:IsCastable()then if p(K.KillShot,nil,nil,not U)then Y=53351;return"Kill Shot (Cleave)"end end;if K.ChimaeraShot:IsCastable()then if p(K.ChimaeraShot,nil,nil,not U)then Y=53209;return"Chimaera Shot (Cleave)"end end;if E and K.Bloodshed:IsCastable()then if p(K.Bloodshed,nil)then Y=321530;return"Bloodshed (ST)"end end;if K.AMurderofCrows:IsReady()then if p(K.AMurderofCrows,nil,nil,not U)then Y=131894;return"A Murder of Crows (Cleave)"end end;if K.Barrage:IsReady()and i:BuffRemains(K.BeastCleavePetBuff)>K.Barrage:ExecuteTime()and g:BuffRemains(K.BeastCleaveBuff)>K.Barrage:ExecuteTime()then if p(K.Barrage,nil,nil,not U)then Y=120360;return"Barrage (Cleave)"end end;if K.KillCommand:IsReady()and UnitExists("pet")and W and g:Focus()>K.KillCommand:Cost()+K.MultiShot:Cost()then if p(K.KillCommand)then Y=34026;return"Kill Command (Cleave)"end end;if K.BagofTricks:IsCastable()and(g:BuffDown(K.BestialWrathBuff)or h:TimeToDie()<5)then if p(K.BagofTricks,nil,nil,not U)then Y=312411;return"Bag of Tricks (ST)"end end;if K.DireBeast:IsReady()then if p(K.DireBeast,nil,nil,not U)then Y=120679;return"Dire Beast (Cleave)"end end;if K.BarbedShot:IsCastable()then if H.CastTargetIf(K.BarbedShot,R,"min",aa,ag)then return"Barbed Shot (Cleave - 3)"end;if h:TimeToDie()<9 and K.Bloodletting:ConduitEnabled()then if p(K.BarbedShot,nil,nil,not U)then Y=217200;return"Barbed Shot (Cleave - 3@Target)"end end end;if K.CobraShot:IsCastable()and g:FocusTimeToMaxPredicted()<X*2 then if p(K.CobraShot)then Y=193455;return"Cobra-Shot (Cleave)"end end end;local function ak()if B and K.AspectoftheWild:IsCastable()and UnitExists("pet")then if p(K.AspectoftheWild,nil)then Y=193530;return"Aspect of the Wild (ST)"end end;if K.BarbedShot:IsCastable()and(i:BuffUp(K.FrenzyPetBuff)and i:BuffRemains(K.FrenzyPetBuff)<=X+0.5)then if p(K.BarbedShot,nil,nil,not U)then Y=217200;return"Barbed Shot (ST - 1)"end end;if K.TarTrap:IsCastable()and(P and h:BuffDown(K.SoulforgeEmbersDebuff)and K.Flare:CooldownRemains()<g:GCD())then if p(K.TarTrap,nil,nil,not h:IsInRange(40))then Y=187698;return"tar_trap st 4"end end;if K.Flare:IsCastable()and not K.TarTrap:CooldownUp()and P then if p(K.Flare,nil)then Y=1543;return"flare st 5"end end;if E and K.Bloodshed:IsCastable()then if p(K.Bloodshed,nil)then Y=321530;return"Bloodshed (ST)"end end;if s and not g:IsMoving()and h:IsInMeleeRange(40)and K.WailingArrow:IsReady()and g:Covenant()=="Night Fae"then if p(K.WailingArrow,nil,nil,not U)then Y=355589;return"Wailing Arrow (ST)"end end;if r and K.WildSpirits:IsCastable()then if p(K.WildSpirits,nil,nil)then Y=328231;return"wild_spirits st"end end;if r and K.FlayedShot:IsCastable()then if p(K.FlayedShot,nil,nil)then Y=324149;return"flayed_shot st"end end;if K.KillShot:IsCastable()then if p(K.KillShot,nil,nil,not U)then Y=53351;return"Kill Shot (ST)"end end;if s and not g:IsMoving()and h:IsInMeleeRange(40)and K.WailingArrow:IsReady()and g:Covenant()~="Night Fae"and(K.ResonatingArrow:CooldownRemains()<g:GCD()or g:Covenant()~="Kyrian"or not K.ResonatingArrow:CooldownUp()or h:TimeToDie()<5)then if p(K.WailingArrow,nil,nil,not U)then Y=355589;return"Wailing Arrow (ST)"end end;if K.BarbedShot:IsCastable()and(K.BestialWrath:CooldownRemains()<12*K.BarbedShot:ChargesFractional()+X and K.ScentOfBlood:IsAvailable()or K.BarbedShot:FullRechargeTime()<X and a8(K.BestialWrath:CooldownRemains())or h:TimeToDie()<9)then if p(K.BarbedShot,nil,nil,not U)then Y=217200;return"Barbed Shot (ST - 1)"end end;if r and K.DeathChakram:IsCastable()and g:Focus()+g:FocusCastRegen(K.DeathChakram:ExecuteTime())<g:FocusMax()then if p(K.DeathChakram,nil,nil)then Y=325028;return"death_chakram st"end end;if K.Stampede:IsCastable()and C and((g:BuffUp(K.AspectoftheWildBuff)or not B)and(g:BuffUp(K.BestialWrathBuff)or not D)or h:TimeToDie()<15)then if p(K.Stampede,nil,nil,not V)then Y=201430;return"Stampede (ST)"end end;if K.AMurderofCrows:IsReady()then if p(K.AMurderofCrows,nil,nil,not U)then Y=131894;return"A Murder of Crows (ST)"end end;if r and K.ResonatingArrow:IsCastable()and(g:BuffUp(K.BestialWrathBuff)or not D or h:TimeToDie()<10)then if p(K.ResonatingArrow,nil,nil)then Y=308491;return"resonating_arrow st"end end;if D and UnitExists("pet")and K.BestialWrath:IsCastable()and(not K.WildSpirits:IsAvailable()or K.WildSpirits:CooldownRemains()>15 or not r or g:Covenant()=="Kyrian"and(K.ResonatingArrow:CooldownRemains()<5 or K.ResonatingArrow:CooldownRemains()>20 or not r)or h:TimeToDie()<15 or g:Covenant()~="Night Fae"and g:Covenant()~="Kyrian")then if p(K.BestialWrath,nil)then Y=19574;return"Bestial Wrath (ST)"end end;if K.ChimaeraShot:IsCastable()then if p(K.ChimaeraShot,nil,nil,not U)then Y=53209;return"Chimaera Shot (ST)"end end;if K.KillCommand:IsReady()and UnitExists("pet")and W then if p(K.KillCommand)then Y=34026;return"Kill Command (ST)"end end;if K.BagofTricks:IsCastable()and(g:BuffDown(K.BestialWrathBuff)or h:TimeToDie()<5)then if p(K.BagofTricks,nil,nil,not U)then Y=312411;return"Bag of Tricks (ST)"end end;if K.DireBeast:IsReady()then if p(K.DireBeast,nil,nil,not U)then Y=120679;return"Dire Beast (ST)"end end;if K.CobraShot:IsReady()and(g:Focus()-K.CobraShot:Cost()+g:FocusRegen()*(K.KillCommand:CooldownRemains()-1)>K.KillCommand:Cost()or K.KillCommand:CooldownRemains()>1+X or(g:BuffUp(K.BestialWrathBuff)or g:BuffUp(K.NesingwarysTrappingApparatusBuff))and not Q or h:TimeToDie()<3)then if p(K.CobraShot,nil,nil,not U)then Y=193455;return"Cobra Shot (ST)"end end;if K.BarbedShot:IsCastable()and(g:BuffUp(K.WildSpiritsBuff)or K.BarbedShot:ChargesFractional()>1.2 and K.Bloodletting:ConduitEnabled())then if p(K.BarbedShot,nil,nil,not U)then Y=217200;return"Barbed Shot (ST - 3)"end end end;local function al()t=HeroRotationCharDB.Toggles[6]r=HeroRotationCharDB.Toggles[4]s=HeroRotationCharDB.Toggles[5]or o()u=HeroRotationCharDB.Toggles[12]v=HeroRotationCharDB.Toggles[15]w=HeroRotationCharDB.Toggles[120]x=HeroRotationCharDB.Toggles[121]y=HeroRotationCharDB.Toggles[122]z=HeroRotationCharDB.Toggles[123]A=HeroRotationCharDB.Toggles[124]B=false;C=false;D=false;E=false;if J.BeastMastery.AspectoftheWild=="CDs"and o()or J.BeastMastery.AspectoftheWild=="Small CDs"and(o()or s)or J.BeastMastery.AspectoftheWild=="Always"then B=true end;if J.BeastMastery.Stampede=="CDs"and o()or J.BeastMastery.Stampede=="Small CDs"and(o()or s)or J.BeastMastery.Stampede=="Always"then C=true end;if(J.BeastMastery.BestialWrathCD=="CDs"and o()or J.BeastMastery.BestialWrathCD=="Small CDs"and(o()or s)or J.BeastMastery.BestialWrathCD=="Always")and(not g:IsInDungeonArea()or g:IsInDungeonArea()and AreaTTD(R)>=15)then D=true end;if J.BeastMastery.Bloodshed=="CDs"and o()or J.BeastMastery.Bloodshed=="Small CDs"and(o()or s)or J.BeastMastery.Bloodshed=="Always"then E=true end end;local function am()if K.Stomp:IsAvailable()then d.SplashEnemies.ChangeFriendTargetsTracking("Mine Only")else d.SplashEnemies.ChangeFriendTargetsTracking("All")end;local an,ao=GetInventoryItemID("player",13)local ap,ao=GetInventoryItemID("player",14)a0()if Z>0 then Z=0 end;if Y>0 then Y=0 end;local aq=K.BloodBolt:IsPetKnown()and l.FindBySpellID(K.BloodBolt:ID())and K.BloodBolt or K.Bite:IsPetKnown()and l.FindBySpellID(K.Bite:ID())and K.Bite or K.Claw:IsPetKnown()and l.FindBySpellID(K.Claw:ID())and K.Claw or K.Smack:IsPetKnown()and l.FindBySpellID(K.Smack:ID())and K.Smack or nil;local ar=K.Growl:IsPetKnown()and l.FindBySpellID(K.Growl:ID())and K.Growl or nil;if n()then R=g:GetEnemiesInRange(40)T=aq and#g:GetEnemiesInSpellActionRange(aq)or h:GetEnemiesInSplashRangeCount(8)else R={}T=0 end;U=h:IsInRange(40)V=h:IsInRange(30)W=ar and h:IsSpellInActionRange(ar)or h:IsInRange(30)al()if K.Exhilaration:IsCastable()and g:HealthPercentage()<=J.Commons.ExhilarationHP then if p(K.Exhilaration,nil)then Y=109304;return"Exhilaration"end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if K.CobraShot:IsCastable()and U then if p(K.CobraShot,nil)then Z=1193455;return"explosive MO SWD"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if K.CobraShot:IsCastable()and U then if p(K.CobraShot,nil)then Y=193455;return"explosive  SWD"end end end;F={228318,178658,333227,334800,334967,324737,326450,334470,326450,320703,320012,324085,333241,331510,344739}if UnitExists("target")and K.TranqualizingShot:IsCastable()then if UnitCanAttack("player","target")and UnitAffectingCombat("target")and UnitIsDead("target")~=true and K.TranqualizingShot:IsCastable()and K.TranqualizingShot:CooldownRemains(BypassRecovery)<=0 then for as=0,40 do local ao,ao,at,type,ao,ao,ao,ao,ao,au=UnitBuff("target",as)for ao,av in pairs(F)do if av==au then if m.Cast(K.TranqualizingShot,nil)then Y=19801;return"Tranq Enrage"end end end end end end;if m.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+m.GUISettings.General.OpenerReset elseif m.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]m.ToggleIconFrame:UpdateButtonText(6)m.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if w and K.Bindingshot:IsAvailable()and K.Bindingshot:CooldownRemains(BypassRecovery)<=0 then if m.Cast(K.Bindingshot,nil,nil,nil)then Y=109248;return"queue Binding Shot"end elseif(not K.Bindingshot:IsUsableP()or K.Bindingshot:CooldownRemains()>0)and w then HeroRotationCharDB.Toggles[120]=not HeroRotationCharDB.Toggles[120]m.Print("Binding Shot Queue is now "..(HeroRotationCharDB.Toggles[120]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if x and K.FreezingTrap:IsAvailable()and K.FreezingTrap:CooldownRemains(BypassRecovery)<=0 then if m.Cast(K.FreezingTrap,nil,nil,nil)then Y=187650;return"queue Freezing Trap"end elseif(not K.FreezingTrap:IsUsableP()or K.FreezingTrap:CooldownRemains()>0)and x then HeroRotationCharDB.Toggles[121]=not HeroRotationCharDB.Toggles[121]m.Print("Freezing Trap Queue is now "..(HeroRotationCharDB.Toggles[121]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if y and K.Intimidation:IsAvailable()and K.Intimidation:CooldownRemains(BypassRecovery)<=0 then if m.Cast(K.Intimidation,nil,nil,nil)then Y=19577;return"queue Intimidation"end elseif(not K.Intimidation:IsUsableP()or K.Intimidation:CooldownRemains()>0)and y then HeroRotationCharDB.Toggles[122]=not HeroRotationCharDB.Toggles[122]m.Print("Intimidation Queue is now "..(HeroRotationCharDB.Toggles[122]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if z and K.Flare:IsAvailable()and K.Flare:CooldownRemains(BypassRecovery)<=0 then if m.Cast(K.Flare,nil,nil,nil)then Y=1543;return"queue Flare"end elseif(not K.Flare:IsUsableP()or K.Flare:CooldownRemains()>0)and z then HeroRotationCharDB.Toggles[123]=not HeroRotationCharDB.Toggles[123]m.Print("Flare Queue is now "..(HeroRotationCharDB.Toggles[123]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if A and K.TarTrap:IsAvailable()and K.TarTrap:CooldownRemains(BypassRecovery)<=0 then if m.Cast(K.TarTrap,nil,nil,nil)then Y=187698;return"queue TarTrap"end elseif(not K.TarTrap:IsUsableP()or K.TarTrap:CooldownRemains()>0)and A then HeroRotationCharDB.Toggles[124]=not HeroRotationCharDB.Toggles[124]m.Print("Tar Trap Queue is now "..(HeroRotationCharDB.Toggles[124]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if g:IsCasting(K.RevivePet)then if p(K.PoolFocus)then Y=999999;return"Pooling Focus"end end;if K.SummonPet:IsCastable()then if J.Commons.SummonPetSlot==1 and not g:PrevGCD(1,L[J.Commons.SummonPetSlot])then if p(L[J.Commons.SummonPetSlot],nil)then Y=883;return"Summon Pet"end elseif J.Commons.SummonPetSlot==2 and not g:PrevGCD(1,L[J.Commons.SummonPetSlot])then if p(L[J.Commons.SummonPetSlot],nil)then Y=83242;return"Summon Pet"end elseif J.Commons.SummonPetSlot==3 and not g:PrevGCD(1,L[J.Commons.SummonPetSlot])then if p(L[J.Commons.SummonPetSlot],nil)then Y=83243;return"Summon Pet"end elseif J.Commons.SummonPetSlot==4 and not g:PrevGCD(1,L[J.Commons.SummonPetSlot])then if p(L[J.Commons.SummonPetSlot],nil)then Y=83244;return"Summon Pet"end elseif J.Commons.SummonPetSlot==5 and not g:PrevGCD(1,L[J.Commons.SummonPetSlot])then if p(L[J.Commons.SummonPetSlot],nil)then Y=83245;return"Summon Pet"end end end;if(i:IsDeadOrGhost()or not UnitExists("pet"))and K.RevivePet:IsCastable()and not g:IsMoving()and not J.Commons.SummonPetSlot==0 then if p(K.RevivePet,nil)then Y=982;return"Revive Pet"end end;local aw,ax,ao=GetSpellCooldown(34477)if g:AffectingCombat()and J.Commons.AutoMisdirect then if aw+ax-GetTime()<=0 and K.Misdirection:IsAvailable()and K.Misdirection:CooldownRemains(BypassRecovery)<=0 and UnitExists("focus")and(UnitInParty("focus")or UnitInRaid("focus")or UnitIsUnit("focus","pet"))and IsItemInRange(32698,"focus")then if m.Cast(K.Misdirection)then Z=134477;return"MD Focus"end end end;if not i:IsDeadOrGhost()and UnitExists("pet")and K.MendPet:IsCastable()and i:HealthPercentage()<=J.Commons.MendPetHighHP then if p(K.MendPet)then Y=1982;return"Mend Pet High Priority"end end;if not g:AffectingCombat()and(t or J.BeastMastery.DBMSupport and(K.BestialWrath:IsCastable()and D and m.BossMods:GetPullTimer()<X and m.BossMods:GetPullTimer()>0 or m.BossMods:GetPullTimer()<0.5 and m.BossMods:GetPullTimer()>0))and H.TargetIsValid()then O=ah()if O then return O end end;if H.TargetIsValid()and(g:AffectingCombat()or t)then O=H.Interrupt(40,K.CounterShot,nil,_)if O then Y=147362;return O end;if not h:AffectingCombat()and not h:IsDummy()and not h:NPCID()==153285 and T>=1 then Y=999 end;if not h:AffectingCombat()and not h:IsDummy()and not h:NPCID()==153285 then if p(K.PoolFocus)then Y=999999;return"Pooling Focus"end end;if o()and J.Commons.Enabled.Trinkets and(g:BuffRemains(K.AspectoftheWildBuff)>10 or K.AspectoftheWild:CooldownRemains()>60 or not B or h:TimeToDie()<20)then local ay=g:GetUseableTrinkets(N)if ay then if p(ay,nil,nil)then if ay:ID()==an then Y=24;return"Generic use_items for "..ay:Name()elseif ay:ID()==ap then Y=30;return"Generic use_items for "..ay:Name()end end end end;if true then O=ai()if O then return O end end;if T>1 then O=aj()else O=ak()end;if O then return O end;if not i:IsDeadOrGhost()and UnitExists("pet")and K.MendPet:IsCastable()and i:HealthPercentage()<=J.Commons.MendPetLowHP then if p(K.MendPet)then Y=1982;return"Mend Pet Low Priority (w/ Target)"end end;if p(K.PoolFocus)then Y=999999;return"Pooling Focus"end end;if not i:IsDeadOrGhost()and UnitExists("pet")and K.MendPet:IsCastable()and i:HealthPercentage()<=J.Commons.MendPetLowHP then if p(K.MendPet)then Y=1982;return"Mend Pet Low Priority (w/o Target)"end end;if not K.RocketBarrage:IsCastable()and UnitRace("player")=="Goblin"and h:IsInMeleeRange(30)then if p(K.RocketBarrage)then Y=69041;return"RocketBarrage"end end end;local function az()d.Print("BeastMastery can use pet abilities to better determine AoE, makes sure you have Growl and Blood Bolt / Bite / Claw / Smack in your player action bars.")end;function ReturnSpell1()if Y==0 then return 0 else return Y end end;function ReturnSpellMO1()if Z==0 then return 0 else return Z end end;m.SetAPL(253,am,az)