local a=HeroLib;local b=HeroCache;local c=a.Unit;local d=c.Player;local e=c.Pet;local f=c.Target;local g=a.Spell;local h=a.Item;local i=HeroRotation;local j=g.Evoker.Devastation;local k=g.Evoker.Augmentation;local GetPowerRegenForPowerType=GetPowerRegenForPowerType;local l=Enum.PowerType.Essence;local m;m=a.AddCoreOverride("Spell.IsCastable",function(self,n,o,p,q,r)local s=true;if o then local t=q or f;s=t:IsInRange(o,p)end;local u=m(self,n,o,p,q,r)if self==j.Firestorm then return u and not d:IsCasting(self)elseif self==j.TipTheScales then return u and not d:BuffUp(self)else return u end end,1467)local v;v=a.AddCoreOverride("Player.IsMoving",function(self)local u=v(self)return u and d:BuffDown(j.HoverBuff)and d:BuffDown(j.BurnoutBuff)end,1467)a.AddCoreOverride("Player.EssenceTimeToMax",function()local w=d:EssenceDeficit()if w==0 then return 0 end;local x=GetPowerRegenForPowerType(l)if not x or x<0.2 then x=0.2 end;local y=1/x;local z=b.Persistent.Player.LastPowerUpdate;return w*y-(GetTime()-z)end,1467)a.AddCoreOverride("Player.EssenceTimeToX",function(A)local B=d:Essence()if B>=A then return 0 end;local x=GetPowerRegenForPowerType(l)local y=1/x;local z=b.Persistent.Player.LastPowerUpdate;return(A-B)*y-(GetTime()-z)end,1467)local C;C=a.AddCoreOverride("Spell.IsCastable",function(self,n,o,p,q,r)local s=true;if o then local t=q or f;s=t:IsInRange(o,p)end;local u=C(self,n,o,p,q,r)if self==k.TipTheScales or self==k.Upheaval or self==k.FireBreath then return u and not d:BuffUp(self)else return u end end,1473)local D;D=a.AddCoreOverride("Spell.IsReady",function(self,n,o,p,q,r)local s=true;if o then local t=q or f;s=t:IsInRange(o,p)end;local u=D(self,n,o,p,q,r)if self==k.Eruption then return u and d:EssenceP()>=2 elseif self==k.EbonMight then return u and not d:IsCasting(self)elseif self==k.Unravel then return u and f:EnemyAbsorb()else return u end end,1473)local E;E=a.AddCoreOverride("Player.IsMoving",function(self)local u=E(self)return u and d:BuffDown(k.HoverBuff)end,1473)local F;F=a.AddCoreOverride("Player.BuffRemains",function(self,g,G,r)if g==k.EbonMightSelfBuff then return self:IsCasting(k.EbonMight)and 10 or F(self,g,G,r)else return F(self,g,G,r)end end,1473)a.AddCoreOverride("Player.EmpowerCastTime",function(self,H)local I=d:SpellHaste()local J=k.FontofMagic:IsAvailable()and 0.8 or 1;local K=k.FontofMagic:IsAvailable()and 4 or 3;if not H then H=K end;return(1+0.75*(H-1))*I*J end,1473)a.AddCoreOverride("Player.EssenceP",function()local B=d:Essence()if not d:IsCasting()and not d:IsChanneling()then return B else if d:IsCasting(k.Eruption)and d:BuffDown(k.EssenceBurstBuff)then return B-2 else return B end end end,1473)a.AddCoreOverride("Player.EssenceTimeToMax",function()local w=d:EssenceDeficit()if w==0 then return 0 end;local x=GetPowerRegenForPowerType(l)if not x or x<0.2 then x=0.2 end;local y=1/x;local z=b.Persistent.Player.LastPowerUpdate;return w*y-(GetTime()-z)end,1473)a.AddCoreOverride("Player.EssenceTimeToX",function(A)local B=d:Essence()if B>=A then return 0 end;local x=GetPowerRegenForPowerType(l)local y=1/x;local z=b.Persistent.Player.LastPowerUpdate;return(A-B)*y-(GetTime()-z)end,1473)