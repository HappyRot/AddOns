local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=HeroRotation;local m=l.AoEON;local n=l.CDsON;local o=l.Cast;local p=l.CastSuggested;local q=HeroRotationCharDB.Toggles[4]local r=HeroRotationCharDB.Toggles[5]local s=HeroRotationCharDB.Toggles[6]local t=not HeroRotationCharDB.Toggles[15]local u=HeroRotationCharDB.Toggles[12]local v=HeroRotationCharDB.Toggles[60]local w=math.min;local x=j.Priest.Shadow;local y=k.Priest.Shadow;local z={y.DarkmoonDeckPutrescence:ID(),y.DreadfireVessel:ID(),y.EmpyrealOrdinance:ID(),y.GlyphofAssimilation:ID(),y.InscrutableQuantumDevice:ID(),y.MacabreSheetMusic:ID(),y.ShadowedOrbofTorment:ID(),y.SinfulGladiatorsBadgeofFerocity:ID(),y.SoullettingRuby:ID(),y.SunbloodAmethyst:ID()}local A=g:GetEquipment()local B=k(0)local C=k(0)local D,E=GetInventoryItemID("player",13)local F,E=GetInventoryItemID("player",14)if A[13]then B=k(A[13])end;if A[14]then C=k(A[14])end;local G;local H,I,J,K;local L,M;local N;local O;local P=0;local Q=0;local R=0;local S=l.Commons.Everyone;local T={General=l.GUISettings.General,Commons=l.GUISettings.APL.Priest.Commons,Shadow=l.GUISettings.APL.Priest.Shadow}local U=false;local V=false;local W=1;local X=false;local Y=false;local Z=g:HasLegendaryEquipped(202)local _=g:HasLegendaryEquipped(161)local a0=g:HasLegendaryEquipped(158)local a1=g:HasLegendaryEquipped(159)d:RegisterForEvent(function()U=false;V=false;W=1;X=false;Y=false end,"PLAYER_REGEN_ENABLED")d:RegisterForEvent(function()Z=g:HasLegendaryEquipped(202)_=g:HasLegendaryEquipped(161)a0=g:HasLegendaryEquipped(158)a1=g:HasLegendaryEquipped(159)end,"PLAYER_EQUIPMENT_CHANGED")d:RegisterForEvent(function()x.ShadowCrash:RegisterInFlight()end,"LEARNED_SPELL_IN_TAB")x.ShadowCrash:RegisterInFlight()local function a2(a3)if a3 then return 1 else return 0 end end;local function a4(a3)return a3~=0 end;local function a5(a6,a7)if a7 then return a6:DebuffUp(x.ShadowWordPainDebuff)and a6:DebuffUp(x.VampiricTouchDebuff)and a6:DebuffUp(x.DevouringPlagueDebuff)else return a6:DebuffUp(x.ShadowWordPainDebuff)and a6:DebuffUp(x.VampiricTouchDebuff)end end;local function a8(a9)local aa=0;for ab in pairs(a9)do local ac=a9[ab]if ac:DebuffDown(x.ShadowWordPainDebuff)then aa=aa+1 end end;return aa end;local function ad(a9)local ae=0;for ab in pairs(a9)do local ac=a9[ab]if ac:DebuffRefreshable(x.ShadowWordPainDebuff)then ae=ae+1 end end;return ae end;local function af(ag)return not a5(ag,true)end;local function ah(ag)if(ag:HealthPercentage()<20 and M<4 or x.Mindbender:TimeSinceLastCast()<=15 and a1)and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==f("mouseover"):GUID()and T.Shadow.TargetSwap=="Mouseover"then P=101;return true elseif(ag:HealthPercentage()<20 and M<4 or x.Mindbender:TimeSinceLastCast()<=15 and a1)and(ag:AffectingCombat()or ag:IsDummy())and T.Shadow.TargetSwap=="AutoSwap"and ag:GUID()~=h:GUID()and not u then P=999;if P==999 then starttime=GetTime()endtime=starttime+0.25 elseif P>0 and endtime~=nil and GetTime()>endtime then P=0 end;return true elseif(ag:HealthPercentage()<20 and M<4 or x.Mindbender:TimeSinceLastCast()<=15 and a1)and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==h:GUID()then Q=1;return true elseif(ag:HealthPercentage()<20 and M<4 or x.Mindbender:TimeSinceLastCast()<=15 and a1)and(ag:AffectingCombat()or ag:IsDummy())then return true end end;local function ai(ag)if ag:TimeToDie()<20 and g:BuffDown(x.VoidformBuff)and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==f("mouseover"):GUID()and T.Shadow.TargetSwap=="Mouseover"then P=102;return true elseif ag:TimeToDie()<20 and g:BuffDown(x.VoidformBuff)and(ag:AffectingCombat()or ag:IsDummy())and T.Shadow.TargetSwap=="AutoSwap"and ag:GUID()~=h:GUID()and not u then P=999;if P==999 then starttime=GetTime()endtime=starttime+0.25 elseif P>0 and endtime~=nil and GetTime()>endtime then P=0 end;return true elseif ag:TimeToDie()<20 and g:BuffDown(x.VoidformBuff)and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==h:GUID()then Q=2;return true elseif ag:TimeToDie()<20 and g:BuffDown(x.VoidformBuff)and(ag:AffectingCombat()or ag:IsDummy())then return true end end;local function aj(ag)if a5(ag,false)and ag:TimeToDie()>3 and(g:BuffDown(x.VoidformBuff)or g:BuffRemains(x.VoidformBuff)<x.VoidBolt:CooldownRemains()-0.5)and x.VampiricTouchDebuff:AuraActiveCount()>=M and M<5+6*a2(x.TwistofFate:IsAvailable())and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==f("mouseover"):GUID()and T.Shadow.TargetSwap=="Mouseover"then P=103;return true elseif a5(ag,false)and ag:TimeToDie()>3 and(g:BuffDown(x.VoidformBuff)or g:BuffRemains(x.VoidformBuff)<x.VoidBolt:CooldownRemains()-0.5)and x.VampiricTouchDebuff:AuraActiveCount()>=M and M<5+6*a2(x.TwistofFate:IsAvailable())and(ag:AffectingCombat()or ag:IsDummy())and T.Shadow.TargetSwap=="AutoSwap"and ag:GUID()~=h:GUID()and not u then P=999;if P==999 then starttime=GetTime()endtime=starttime+0.25 elseif P>0 and endtime~=nil and GetTime()>endtime then P=0 end;return true elseif a5(ag,false)and ag:TimeToDie()>3 and(g:BuffDown(x.VoidformBuff)or g:BuffRemains(x.VoidformBuff)<x.VoidBolt:CooldownRemains()-0.5)and x.VampiricTouchDebuff:AuraActiveCount()>=M and M<5+6*a2(x.TwistofFate:IsAvailable())and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==h:GUID()then Q=3;return true elseif a5(ag,false)and ag:TimeToDie()>3 and(g:BuffDown(x.VoidformBuff)or g:BuffRemains(x.VoidformBuff)<x.VoidBolt:CooldownRemains()-0.5)and x.VampiricTouchDebuff:AuraActiveCount()>=M and M<5+6*a2(x.TwistofFate:IsAvailable())and(ag:AffectingCombat()or ag:IsDummy())then return true end end;local function ak(ag)if(ag:DebuffRefreshable(x.VampiricTouchDebuff)and(ag:TimeToDie()>8 or ag:IsDummy())or x.Misery:IsAvailable()and ag:DebuffRefreshable(x.ShadowWordPainDebuff)or g:BuffUp(x.UnfurlingDarknessBuff))and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==f("mouseover"):GUID()and T.Shadow.TargetSwap=="Mouseover"then P=104;return true elseif(ag:DebuffRefreshable(x.VampiricTouchDebuff)and(ag:TimeToDie()>8 or ag:IsDummy())or x.Misery:IsAvailable()and ag:DebuffRefreshable(x.ShadowWordPainDebuff)or g:BuffUp(x.UnfurlingDarknessBuff))and(ag:AffectingCombat()or ag:IsDummy())and T.Shadow.TargetSwap=="AutoSwap"and ag:GUID()~=h:GUID()and not u then P=999;if P==999 then starttime=GetTime()endtime=starttime+0.25 elseif P>0 and endtime~=nil and GetTime()>endtime then P=0 end;return true elseif(ag:DebuffRefreshable(x.VampiricTouchDebuff)and(ag:TimeToDie()>8 or ag:IsDummy())or x.Misery:IsAvailable()and ag:DebuffRefreshable(x.ShadowWordPainDebuff)or g:BuffUp(x.UnfurlingDarknessBuff))and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==h:GUID()then Q=4;return true elseif(ag:DebuffRefreshable(x.VampiricTouchDebuff)and(ag:TimeToDie()>8 or ag:IsDummy())or x.Misery:IsAvailable()and ag:DebuffRefreshable(x.ShadowWordPainDebuff)or g:BuffUp(x.UnfurlingDarknessBuff))and(ag:AffectingCombat()or ag:IsDummy())then return true end end;local function al(ag)if ag:DebuffRefreshable(x.ShadowWordPainDebuff)and ag:TimeToDie()>4 and not x.Misery:IsAvailable()and not(x.SearingNightmare:IsAvailable()and M>W)and(not x.PsychicLink:IsAvailable()or x.PsychicLink:IsAvailable()and M<=2)and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==f("mouseover"):GUID()and T.Shadow.TargetSwap=="Mouseover"then P=105;return true elseif ag:DebuffRefreshable(x.ShadowWordPainDebuff)and ag:TimeToDie()>4 and not x.Misery:IsAvailable()and not(x.SearingNightmare:IsAvailable()and M>W)and(not x.PsychicLink:IsAvailable()or x.PsychicLink:IsAvailable()and M<=2)and(ag:AffectingCombat()or ag:IsDummy())and T.Shadow.TargetSwap=="AutoSwap"and ag:GUID()~=h:GUID()and not u then P=999;if P==999 then starttime=GetTime()endtime=starttime+0.25 elseif P>0 and endtime~=nil and GetTime()>endtime then P=0 end;return true elseif ag:DebuffRefreshable(x.ShadowWordPainDebuff)and ag:TimeToDie()>4 and not x.Misery:IsAvailable()and not(x.SearingNightmare:IsAvailable()and M>W)and(not x.PsychicLink:IsAvailable()or x.PsychicLink:IsAvailable()and M<=2)and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==h:GUID()then Q=5;return true elseif ag:DebuffRefreshable(x.ShadowWordPainDebuff)and ag:TimeToDie()>4 and not x.Misery:IsAvailable()and not(x.SearingNightmare:IsAvailable()and M>W)and(not x.PsychicLink:IsAvailable()or x.PsychicLink:IsAvailable()and M<=2)and(ag:AffectingCombat()or ag:IsDummy())then return true end end;local function am(ag)if x.SearingNightmare:IsAvailable()and ag:DebuffRefreshable(x.ShadowWordPainDebuff)and M>2 and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==f("mouseover"):GUID()and T.Shadow.TargetSwap=="Mouseover"then P=106;return true elseif x.SearingNightmare:IsAvailable()and ag:DebuffRefreshable(x.ShadowWordPainDebuff)and M>2 and(ag:AffectingCombat()or ag:IsDummy())and T.Shadow.TargetSwap=="AutoSwap"and ag:GUID()~=h:GUID()and not u then P=999;if P==999 then starttime=GetTime()endtime=starttime+0.25 elseif P>0 and endtime~=nil and GetTime()>endtime then P=0 end;return true elseif x.SearingNightmare:IsAvailable()and ag:DebuffRefreshable(x.ShadowWordPainDebuff)and M>2 and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==h:GUID()then Q=6;return true elseif x.SearingNightmare:IsAvailable()and ag:DebuffRefreshable(x.ShadowWordPainDebuff)and M>2 and(ag:AffectingCombat()or ag:IsDummy())then return true end end;local function an(ag)if g:Insanity()<90 and(a5(ag,true)and(not x.VoidEruption:CooldownUp()or not x.HungeringVoid:IsAvailable())or g:BuffUp(x.VoidformBuff))and(not x.HungeringVoid:IsAvailable()or h:DebuffUp(x.HungeringVoidDebuff)or g:BuffDown(x.VoidformBuff))and(not x.SearingNightmare:IsAvailable()or M<5)and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==f("mouseover"):GUID()and T.Shadow.TargetSwap=="Mouseover"then P=107;return true elseif g:Insanity()<90 and(a5(ag,true)and(not x.VoidEruption:CooldownUp()or not x.HungeringVoid:IsAvailable())or g:BuffUp(x.VoidformBuff))and(not x.HungeringVoid:IsAvailable()or h:DebuffUp(x.HungeringVoidDebuff)or g:BuffDown(x.VoidformBuff))and(not x.SearingNightmare:IsAvailable()or M<5)and(ag:AffectingCombat()or ag:IsDummy())and T.Shadow.TargetSwap=="AutoSwap"and ag:GUID()~=h:GUID()and not u then P=999;if P==999 then starttime=GetTime()endtime=starttime+0.25 elseif P>0 and endtime~=nil and GetTime()>endtime then P=0 end;return true elseif g:Insanity()<90 and(a5(ag,true)and(not x.VoidEruption:CooldownUp()or not x.HungeringVoid:IsAvailable())or g:BuffUp(x.VoidformBuff))and(not x.HungeringVoid:IsAvailable()or h:DebuffUp(x.HungeringVoidDebuff)or g:BuffDown(x.VoidformBuff))and(not x.SearingNightmare:IsAvailable()or M<5)and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==h:GUID()then Q=7;return true elseif g:Insanity()<90 and(a5(ag,true)and(not x.VoidEruption:CooldownUp()or not x.HungeringVoid:IsAvailable())or g:BuffUp(x.VoidformBuff))and(not x.HungeringVoid:IsAvailable()or h:DebuffUp(x.HungeringVoidDebuff)or g:BuffDown(x.VoidformBuff))and(not x.SearingNightmare:IsAvailable()or M<5)and(ag:AffectingCombat()or ag:IsDummy())then return true end end;local function ao(ag)return ag:HealthPercentage()end;local function ap(ag)if(g:BuffUp(x.PowerInfusionBuff)or not T.Shadow.SelfPI or y.ShadowedOrbofTorment:IsEquipped())and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==f("mouseover"):GUID()and T.Shadow.TargetSwap=="Mouseover"then if y.SoullettingRuby:ID()==GetInventoryItemID("player",13)then P=241;return true elseif y.SoullettingRuby:ID()==GetInventoryItemID("player",14)then P=251;return true end elseif(g:BuffUp(x.PowerInfusionBuff)or not T.Shadow.SelfPI or y.ShadowedOrbofTorment:IsEquipped())and(ag:AffectingCombat()or ag:IsDummy())and T.Shadow.TargetSwap=="AutoSwap"and ag:GUID()~=h:GUID()and not u then P=999;return true elseif(g:BuffUp(x.PowerInfusionBuff)or not T.Shadow.SelfPI or y.ShadowedOrbofTorment:IsEquipped())and(ag:AffectingCombat()or ag:IsDummy())and ag:GUID()==h:GUID()then if y.SoullettingRuby:ID()==GetInventoryItemID("player",13)then P=241;return true elseif y.SoullettingRuby:ID()==GetInventoryItemID("player",14)then P=251;return true end elseif(g:BuffUp(x.PowerInfusionBuff)or not T.Shadow.SelfPI or y.ShadowedOrbofTorment:IsEquipped())and(ag:AffectingCombat()or ag:IsDummy())then return true end end;local function aq()if S.TargetIsValid()and not g:IsDeadOrGhost()and not g:AffectingCombat()and s and not g:IsMoving()then if x.ArcaneTorrent:IsCastable()and n()then if o(x.ArcaneTorrent,nil,nil,not h:IsSpellInRange(x.ArcaneTorrent))then Q=28;return"arcane_torrent 6"end end;if T.Commons.Enabled.Trinkets and y.ShadowedOrbofTorment:IsEquippedAndReady()then if o(y.ShadowedOrbofTorment,nil,nil)then if y.ShadowedOrbofTorment:ID()==D then Q=24;return"top trinket 1"elseif y.ShadowedOrbofTorment:ID()==F then Q=25;return"top trinket 2"end end end;W=2;if x.VampiricTouch:IsCastable()then if o(x.VampiricTouch,nil,nil,not h:IsSpellInRange(x.VampiricTouch))then Q=4;return"vampiric_touch 10"end end;if x.MindBlast:IsCastable()and(x.Misery:IsAvailable()and(not _ or not x.VoidTorrent:IsAvailable()))then if o(x.MindBlast,nil,nil,not h:IsSpellInRange(x.MindBlast))then Q=9;return"mind_blast 12"end end;if x.VoidTorrent:IsCastable()and(r or n)and(x.Misery:IsAvailable()and _)then if o(x.VoidTorrent,nil,nil,not h:IsSpellInRange(x.VoidTorrent))then Q=3;return"void_torrent 14"end end;if x.MindFlay:IsCastable()and not g:IsChanneling(x.MindFlay)and(x.Misery:IsAvailable()and _ and not x.VoidTorrent:IsAvailable())then if o(x.MindFlay,nil,nil,not h:IsSpellInRange(x.MindFlay))then Q=10;return"mind_flay 15"end end;if x.ShadowWordPain:IsCastable()and not x.Misery:IsAvailable()then if o(x.ShadowWordPain,nil,nil,not h:IsSpellInRange(x.ShadowWordPain))then Q=5;return"shadow_word_pain 16"end end end end;local function ar()if y.DarkmoonDeckPutrescence:IsEquippedAndReady()then if o(y.DarkmoonDeckPutrescence,nil,nil,not h:IsInRange(40))then if y.DarkmoonDeckPutrescence:ID()==D then Q=24;return"top trinket 1"elseif y.DarkmoonDeckPutrescence:ID()==F then Q=25;return"top trinket 2"end end end;if y.SunbloodAmethyst:IsEquippedAndReady()then if o(y.SunbloodAmethyst,nil,nil,not h:IsInRange(40))then if y.SunbloodAmethyst:ID()==D then Q=24;return"top trinket 1"elseif y.SunbloodAmethyst:ID()==F then Q=25;return"top trinket 2"end end end;if y.GlyphofAssimilation:IsEquippedAndReady()then if o(y.GlyphofAssimilation,nil,nil,not h:IsInRange(50))then if y.GlyphofAssimilation:ID()==D then Q=24;return"top trinket 1"elseif y.GlyphofAssimilation:ID()==F then Q=25;return"top trinket 2"end end end;if y.DreadfireVessel:IsEquippedAndReady()then if o(y.DreadfireVessel,nil,nil,not h:IsInRange(50))then if y.DreadfireVessel:ID()==D then Q=24;return"top trinket 1"elseif y.DreadfireVessel:ID()==F then Q=25;return"top trinket 2"end end end end;local function as()if y.EmpyrealOrdinance:IsEquippedAndReady()and(x.VoidEruption:CooldownRemains()<=12 or x.VoidEruption:CooldownRemains()>27)then if o(y.EmpyrealOrdinance,nil,nil,not h:IsInRange(40))then if y.EmpyrealOrdinance:ID()==D then Q=24;return"top trinket 1"elseif y.EmpyrealOrdinance:ID()==F then Q=25;return"top trinket 2"end end end;if y.InscrutableQuantumDevice:IsEquippedAndReady()and(g:BuffUp(x.VoidformBuff)and g:BuffUp(x.PowerInfusionBuff)or d.BossFilteredFightRemains("<=",20)or g:BuffUp(x.PowerInfusionBuff)and d.BossFilteredFightRemains("<",x.VoidEruption:CooldownRemains()+15)or g:BuffUp(x.VoidformBuff)and d.BossFilteredFightRemains("<",x.PowerInfusion:CooldownRemains()+15)or x.PowerInfusion:CooldownRemains()>=10 and x.VoidEruption:CooldownRemains()>=10 and d.BossFilteredFightRemains(">=",190))then if o(y.InscrutableQuantumDevice,nil,nil)then if y.InscrutableQuantumDevice:ID()==D then Q=24;return"top trinket 1"elseif y.InscrutableQuantumDevice:ID()==F then Q=25;return"top trinket 2"end end end;if y.MacabreSheetMusic:IsEquippedAndReady()and x.VoidEruption:CooldownRemains()>10 then if o(y.MacabreSheetMusic,nil,nil)then if y.MacabreSheetMusic:ID()==D then Q=24;return"top trinket 1"elseif y.MacabreSheetMusic:ID()==F then Q=25;return"top trinket 2"end end end;if y.SoullettingRuby:IsEquippedAndReady()and(g:BuffUp(x.PowerInfusionBuff)or not T.Shadow.SelfPI or y.ShadowedOrbofTorment:IsEquipped())then if o(y.SoullettingRuby,nil,nil)then if y.SoullettingRuby:ID()==D then Q=24;return"top trinket 1"elseif y.SoullettingRuby:ID()==F then Q=25;return"top trinket 2"end end end;if y.SinfulGladiatorsBadgeofFerocity:IsEquippedAndReady()and x.VoidEruption:CooldownRemains()>=10 then if o(y.SinfulGladiatorsBadgeofFerocity,nil,nil)then if y.SinfulGladiatorsBadgeofFerocity:ID()==D then Q=24;return"top trinket 1"elseif y.SinfulGladiatorsBadgeofFerocity:ID()==F then Q=25;return"top trinket 2"end end end;if y.ShadowedOrbofTorment:IsEquippedAndReady()and(g:BuffDown(x.VoidformBuff)or g:PrevGCD(1,x.VoidBolt))then if o(y.ShadowedOrbofTorment,nil,nil)then if y.ShadowedOrbofTorment:ID()==D then Q=24;return"top trinket 1"elseif y.ShadowedOrbofTorment:ID()==F then Q=25;return"top trinket 2"end end end;if(not x.HungeringVoid:IsAvailable()or h:DebuffUp(x.HungeringVoidDebuff))and(g:BuffUp(x.VoidformBuff)or x.VoidEruption:CooldownRemains()>10)then local G=ar()if G then return G end end;if g:BuffUp(x.VoidformBuff)or g:BuffUp(x.PowerInfusionBuff)or x.VoidEruption:CooldownRemains()>10 then local at=g:GetUseableTrinkets(z)if at then if o(at,nil,nil)then if at:ID()==D then Q=24;return"top trinket 1"elseif at:ID()==F then Q=25;return"top trinket 2"end end end end end;local function au()if x.PowerInfusion:IsCastable()and not g:IsMoving()and(T.Shadow.SelfPI and(g:BuffUp(x.VoidformBuff)or g:Covenant()~="Kyrian"and x.VoidEruption:CooldownRemains()>=10 or d.BossFilteredFightRemains("<",x.VoidEruption:CooldownRemains()))and(d.BossFilteredFightRemains(">=",x.VoidEruption:CooldownRemains()+15)and x.VoidEruption:CooldownRemains()<=g:GCD()*4 or d.BossFilteredFightRemains(">",x.PowerInfusion:Cooldown())or d.BossFilteredFightRemains("<",x.VoidEruption:CooldownRemains()+15)or g:Covenant()=="Kyrian"or g:BloodlustUp()))then if o(x.PowerInfusion,nil)then Q=11;return"power_infusion 50"end end;if x.FaeGuardians:IsReady()and q and(g:BuffDown(x.VoidformBuff)and(not x.VoidTorrent:CooldownUp()or not x.VoidTorrent:IsAvailable())and(U and M==1 or x.VampiricTouchDebuff:AuraActiveCount()==M and M>1)or g:BuffUp(x.VoidformBuff)and(x.GroveInvigoration:IsAvailable()or x.FieldofBlossoms:IsAvailable()))then if o(x.FaeGuardians,nil)then Q=12;return"fae_guardians 52"end end;if x.Mindgames:IsReady()and not g:IsMoving()and q then if o(x.Mindgames,J,an,not h:IsSpellInRange(x.Mindgames))then Q=13;return"mindgames 54"end end;if x.UnholyNova:IsReady()and q and((g:BuffUp(x.PowerInfusionBuff)or x.PowerInfusion:CooldownRemains()>=10 or not T.Shadow.SelfPI)and(not x.HungeringVoid:IsAvailable()or h:DebuffUp(x.HungeringVoidDebuff)or g:BuffDown(x.VoidformBuff)))then if o(x.UnholyNova,nil,nil,not h:IsSpellInRange(x.UnholyNova))then Q=14;return"unholy_nova 56"end end;if x.BoonoftheAscended:IsCastable()and q and(g:BuffDown(x.VoidformBuff)and not x.VoidEruption:CooldownUp()and M>1 and not x.SearingNightmare:IsAvailable()or g:BuffUp(x.VoidformBuff)and M<2 and not x.SearingNightmare:IsAvailable()and(g:PrevGCD(1,x.VoidBolt)and(not y.EmpyrealOrdinance:IsEquipped()or not x.HungeringVoid:IsAvailable())or y.EmpyrealOrdinance:IsEquipped()and y.EmpyrealOrdinance:CooldownRemains()<=162 and h:DebuffUp(x.HungeringVoidDebuff))or g:BuffUp(x.VoidformBuff)and x.SearingNightmare:IsAvailable())then if o(x.BoonoftheAscended,nil)then Q=15;return"boon_of_the_ascended 58"end end;if T.Commons.Enabled.Trinkets then local G=as()if G then return G end end end;local function av()if x.AscendedBlast:IsReady()and M<=3 then if o(x.AscendedBlast,nil,nil,not h:IsSpellInRange(x.AscendedBlast))then Q=16;return"ascended_blast 70"end end;if x.AscendedNova:IsReady()and(#H>1 and M>1+a2(x.SearingNightmare:IsAvailable()))then if o(x.AscendedNova,nil,nil,not h:IsInRange(8))then Q=17;return"ascended_nova 72"end end end;local function aw()if x.SearingNightmare:IsReady()and g:IsChanneling(x.MindSear)and(X and not Y or O>0 and M>1)then if o(x.SearingNightmare,nil,nil,not h:IsInRange(40))then Q=18;return"searing_nightmare 80"end end;if x.SearingNightmare:IsReady()and g:IsChanneling(x.MindSear)and(O>0 and M>2)then if o(x.SearingNightmare,nil,nil,not h:IsInRange(40))then Q=18;return"searing_nightmare 82"end end;if x.MindBlast:IsCastable()and(g:BuffUp(x.DarkThoughtBuff)and(g:IsChanneling(x.MindFlay)or g:IsChanneling(x.MindSear)))then if o(x.MindBlast,nil,nil,not h:IsSpellInRange(x.MindBlast))then Q=9;return"mind_blast 84"end end end;local function ax()if g:BuffUp(x.BoonoftheAscendedBuff)then local G=av()if G then return G end end;if x.VoidBolt:CooldownUp()and g:BuffUp(x.DissonantEchoesBuff)then if o(x.VoidBolt,nil,nil,not h:IsInRange(40))then Q=19;return"void_bolt 90"end end;if x.VoidEruption:IsReady()and not g:IsMoving()and n()and(Y and(g:Insanity()>=40 or x.Mindbender:TimeSinceLastCast()<=15 and a1 and(not x.MindBlast:CooldownUp()and not x.ShadowWordDeath:CooldownUp()or M>=4)and(g:Insanity()<=85 or x.SearingNightmare:IsAvailable()and X)and not x.Mindbender:CooldownUp()and(not x.MindBlast:CooldownUp()or M>2)))then if o(x.VoidEruption,nil,nil,not h:IsSpellInRange(x.VoidEruption))then Q=20;return"void_eruption 92"end end;if x.ShadowWordPain:IsCastable()and(g:BuffUp(x.FaeGuardiansBuff)and h:DebuffDown(x.WrathfulFaerieDebuff)and M<4)then if x.Misery:IsAvailable()and h:TimeToDie()>=6 then if o(x.VampiricTouch,nil,nil,not h:IsSpellInRange(x.VampiricTouch))then Q=4;return"vampiric_touch 94"end else if o(x.ShadowWordPain,nil,nil,not h:IsSpellInRange(x.ShadowWordPain))then Q=5;return"shadow_word_pain 94"end end end;if n()then local G=au()if G then return G end end;if x.MindSear:IsCastable()and not g:IsMoving()and not g:IsChanneling(x.MindSear)and(x.SearingNightmare:IsAvailable()and M>W and N>0 and not x.Mindbender:CooldownUp())then if o(x.MindSear,nil,nil,not h:IsSpellInRange(x.MindSear))then Q=6;return"mind_sear 97"end end;if x.Damnation:IsCastable()then if S.CastCycle(x.Damnation,J,af,not h:IsSpellInRange(x.Damnation))then Q=36;return"damnation 98"end end;if x.ShadowWordDeath:IsReady()and(x.Mindbender:TimeSinceLastCast()<=15 and a1 and 15-x.Mindbender:TimeSinceLastCast()<=g:GCD()+0.5)then if o(x.ShadowWordDeath,nil,nil,not h:IsSpellInRange(x.ShadowWordDeath))then Q=1;return"shadow_word_death 99"end end;if x.MindBlast:IsCastable()and not g:IsMoving()and M<4 and((x.MindBlast:Charges()>=1 and(h:DebuffUp(x.HungeringVoidDebuff)or not x.HungeringVoid:IsAvailable())or 15-x.Mindbender:TimeSinceLastCast()<=x.MindBlast:CastTime()+g:GCD()+0.5)and x.Mindbender:TimeSinceLastCast()<=15 and a1 and 15-x.Mindbender:TimeSinceLastCast()>x.MindBlast:CastTime())then if o(x.MindBlast,nil,nil,not h:IsSpellInRange(x.MindBlast))then Q=9;return"mind_blast 100"end end;if x.VoidBolt:IsCastable()and(M<4 or x.HungeringVoid:IsAvailable()and M<=6)and(g:Insanity()<=85 and x.HungeringVoid:IsAvailable()and x.SearingNightmare:IsAvailable()and M<=6 or(x.HungeringVoid:IsAvailable()and not x.SearingNightmare:IsAvailable()or M==1))then if o(x.VoidBolt,nil,nil,not h:IsInRange(40))then Q=19;return"void_bolt 101"end end;if x.DevouringPlague:IsReady()and(M<3 or g:BuffUp(x.VoidformBuff))and((h:DebuffRefreshable(x.DevouringPlagueDebuff)or g:Insanity()>75)and(not Y or g:Insanity()>=85)and(not x.SearingNightmare:IsAvailable()or x.SearingNightmare:IsAvailable()and not X))then if o(x.DevouringPlague,nil,nil,not h:IsSpellInRange(x.DevouringPlague))then Q=21;return"devouring_plague 102"end end;if x.VoidBolt:IsCastable()and(M<4 or x.HungeringVoid:IsAvailable()and M<=6)and(M<4+a2(x.DissonantEchoes:ConduitEnabled())and g:Insanity()<=85 and x.SearingNightmare:IsAvailable()or not x.SearingNightmare:IsAvailable())then if o(x.VoidBolt,nil,nil,not h:IsInRange(40))then Q=19;return"void_bolt 103"end end;if x.ShadowWordDeath:IsReady()and h:IsSpellInRange(x.ShadowWordDeath)and(h:HealthPercentage()<20 and M<4 or x.Mindbender:TimeSinceLastCast()<=15 and a1)then if o(x.ShadowWordDeath,nil)then Q=1;return"shadow_word_death 104"end end;if x.ShadowWordDeath:IsReady()and M<4 then if S.CastCycle(x.ShadowWordDeath,J,ah,not h:IsSpellInRange(x.ShadowWordDeath),nil)then return"shadow_word_death 104"end end;if x.SurrenderToMadness:IsCastable()then if S.CastCycle(x.SurrenderToMadness,J,ai,not h:IsSpellInRange(x.SurrenderToMadness),T.Shadow.OffGCDasOffGCD.SurrenderToMadness)then return"surrender_to_madness 106"end end;if x.VoidTorrent:IsCastable()and not g:IsMoving()and M<4 then if a5(h,false)and h:TimeToDie()>3 and(g:BuffDown(x.VoidformBuff)or g:BuffRemains(x.VoidformBuff)<x.VoidBolt:CooldownRemains()-0.5)and x.VampiricTouchDebuff:AuraActiveCount()>=M and M<5+6*a2(x.TwistofFate:IsAvailable())then if o(x.VoidTorrent,nil)then Q=3;return"void_torrent 107"end end end;if x.Mindbender:IsCastable()and n()and(h:DebuffUp(x.VampiricTouchDebuff)and(x.SearingNightmare:IsAvailable()and M>W or h:DebuffUp(x.ShadowWordPainDebuff))and(not a1 or x.VampiricTouchDebuff:AuraActiveCount()>=M))then if o(x.Mindbender,nil,nil,not h:IsSpellInRange(x.Mindbender))then Q=22;return"shadowfiend/mindbender 108"end end;if x.ShadowWordDeath:IsReady()and(a0 and U and h:TimeToX(20)>x.ShadowWordDeath:Cooldown()+g:GCD())then if o(x.ShadowWordDeath,nil,nil,not h:IsSpellInRange(x.ShadowWordDeath))then Q=1;return"shadow_word_death 112"end end;if x.ShadowCrash:IsCastable()and(r or n)then if o(x.ShadowCrash,nil,nil,not h:IsInRange(40))then Q=23;return"shadow_crash 114"end end;if x.MindSear:IsCastable()and not g:IsMoving()and not g:IsChanneling(x.MindSear)and(M>W and g:BuffUp(x.DarkThoughtBuff))then if o(x.MindSear,nil,nil,not h:IsSpellInRange(x.MindSear))then Q=6;return"mind_sear 118"end end;if x.MindFlay:IsCastable()and not g:IsMoving()and not g:IsCasting(x.MindFlay)and(g:BuffUp(x.DarkThoughtBuff)and not(g:BuffUp(x.VoidformBuff)and x.VoidBolt:CooldownRemains()<=g:GCD())and U)then if o(x.MindFlay,nil,nil,not h:IsSpellInRange(x.MindFlay))then Q=10;return"mind_flay 120"end end;if x.DevouringPlague:IsReady()and(M<3 or g:BuffUp(x.VoidformBuff))and M<4 and(_ and U and not V)then if o(x.DevouringPlague,nil,nil,not h:IsSpellInRange(x.DevouringPlague))then Q=21;return"devouring_plague 121"end end;if x.MindBlast:IsCastable()and not g:IsMoving()and(U and M<4+2*a2(x.Misery:IsAvailable())+x.VampiricTouchDebuff:AuraActiveCount()*a2(x.PsychicLink:IsAvailable())+w(5,M)*a2(x.Mindbender:TimeSinceLastCast()<=15 and a1)and(not a1 or not x.Mindbender:CooldownUp()and a1 or x.VampiricTouchDebuff:AuraActiveCount()==M))then if o(x.MindBlast,nil,nil,not h:IsSpellInRange(x.MindBlast))then Q=9;return"mind_blast 122"end end;if x.VampiricTouch:IsCastable()and not g:IsMoving()and(h:DebuffRefreshable(x.VampiricTouchDebuff)and not g:IsCasting(x.VampiricTouch)and h:IsSpellInRange(x.VampiricTouch)and(h:TimeToDie()>8 or h:IsDummy())or x.Misery:IsAvailable()and h:DebuffRefreshable(x.ShadowWordPainDebuff)or g:BuffUp(x.UnfurlingDarknessBuff))then if o(x.VampiricTouch,nil)then Q=4;return"vampiric_touch 124"end end;if x.VampiricTouch:IsCastable()and not g:IsMoving()and(M<4 or M<7 and g:Insanity()<30 and g:BuffDown(x.DarkThoughtBuff))then if S.CastCycle(x.VampiricTouch,J,ak,not h:IsSpellInRange(x.VampiricTouch))then return"vampiric_touch 124"end end;if x.ShadowWordPain:IsCastable()and M<4 and(h:DebuffRefreshable(x.ShadowWordPainDebuff)and h:TimeToDie()>4 and not x.Misery:IsAvailable()and x.PsychicLink:IsAvailable()and M>2)then if o(x.ShadowWordPain,nil,nil,not h:IsSpellInRange(x.ShadowWordPain))then Q=5;return"shadow_word_pain 126"end end;if x.ShadowWordPain:IsCastable()and(h:DebuffRefreshable(x.ShadowWordPainDebuff)and h:IsSpellInRange(x.ShadowWordPain)and(h:TimeToDie()>4 or h:IsDummy())and not x.Misery:IsAvailable()and not(x.SearingNightmare:IsAvailable()and M>W)and(not x.PsychicLink:IsAvailable()or x.PsychicLink:IsAvailable()and M<=2))then if o(x.ShadowWordPain,nil)then Q=5;return"shadow_word_pain 128"end end;if x.ShadowWordPain:IsCastable()and M<4 and not x.Misery:IsAvailable()then if S.CastCycle(x.ShadowWordPain,J,al,not h:IsSpellInRange(x.ShadowWordPain))then return"shadow_word_pain 128"end end;if x.MindSear:IsCastable()and not g:IsMoving()and not g:IsChanneling(x.MindSear)and M>W and(x.VoidBolt:CooldownRemains()>=g:GCD()or not g:BuffUp(x.VoidformBuff))then if o(x.MindSear,nil,nil,not h:IsSpellInRange(x.MindSear))then Q=6;return"mind_sear 130"end end;if x.MindFlay:IsCastable()and not g:IsMoving()and not g:IsChanneling(x.MindFlay)and M<=W and(x.VoidBolt:CooldownRemains()>=g:GCD()or not g:BuffUp(x.VoidformBuff))then if o(x.MindFlay,nil,nil,not h:IsSpellInRange(x.MindFlay))then Q=10;return"mind_flay 132"end end;if x.ShadowWordDeath:IsReady()and g:IsMoving()then if o(x.ShadowWordDeath,nil,nil,not h:IsSpellInRange(x.ShadowWordDeath))then Q=1;return"shadow_word_death 133"end end;if x.ShadowWordPain:IsCastable()and g:IsMoving()then if o(x.ShadowWordPain,nil,nil,not h:IsSpellInRange(x.ShadowWordPain))then Q=5;return"shadow_word_pain 134"end end end;local function ay()s=HeroRotationCharDB.Toggles[6]q=HeroRotationCharDB.Toggles[4]r=HeroRotationCharDB.Toggles[5]u=HeroRotationCharDB.Toggles[12]t=not HeroRotationCharDB.Toggles[15]v=HeroRotationCharDB.Toggles[60]end;local function az()H=g:GetEnemiesInMeleeRange(8)I=g:GetEnemiesInRange(30)J=g:GetEnemiesInRange(40)K=h:GetEnemiesInSplashRange(10)D,E=GetInventoryItemID("player",13)F,E=GetInventoryItemID("player",14)if m()then L=h:GetEnemiesInSplashRangeCount(8)M=h:GetEnemiesInSplashRangeCount(10)else L=1;M=1 end;if v then M=10;L=10 end;N=a8(K)O=ad(K)if not BotOn then P=0;Q=0 end;if P>0 then P=0 end;if Q>0 then Q=0 end;G=ay()if l.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+l.GUISettings.General.OpenerReset elseif l.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]l.ToggleIconFrame:UpdateButtonText(6)l.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if g:IsChanneling(j(355321))then if o(x.Pool,nil)then Q=999;return"Trinket Channel"end end;if x.Shadowform:IsCastable()and g:BuffDown(x.ShadowformBuff)then if o(x.Shadowform,nil)then Q=8;return"shadowform 4"end end;if g:IsChanneling(x.VoidTorrent)then if o(x.Pool,nil)then Q=99999;return"channeling 4"end end;if not g:AffectingCombat()and S.TargetIsValid()and s then local G=aq()if G then return G end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if x.ShadowWordDeath:IsCastable()then if o(x.ShadowWordDeath,nil)then P=101;return"explosive MO SWD"end end;if x.ShadowWordPain:IsCastable()then if o(x.ShadowWordPain,nil)then P=105;return"explosive MO SWP"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if x.ShadowWordDeath:IsCastable()then if o(x.ShadowWordDeath,nil)then Q=1;return"explosive  SWD"end end;if x.ShadowWordPain:IsCastable()then if o(x.ShadowWordPain,nil)then Q=5;return"explosive  SWP"end end end;if S.TargetIsValid()and g:AffectingCombat()then if x.Dispersion:IsCastable()and g:HealthPercentage()<T.Shadow.DispersionHP then if o(x.Dispersion,nil)then Q=35;return"dispersion low_hp"end end;if y.PotionofPhantomFire:IsReady()and T.Commons.Enabled.Potions and t and(g:BuffUp(x.VoidformBuff)or g:BuffUp(x.PowerInfusionBuff))then if o(y.PotionofPhantomFire,nil,nil)then Q=26;return"potion_of_spectral_intellect 2"end end;U=a5(h,false)V=a5(h,true)X=M>2+a2(g:BuffUp(x.VoidformBuff))Y=x.VoidEruption:CooldownUp()and(M==1 or M>=4 or x.HungeringVoid:IsAvailable()or g:Covenant()=="Kyrian")if n()then if x.Fireblood:IsCastable()and g:BuffUp(x.VoidformBuff)then if o(x.Fireblood,nil)then Q=32;return"fireblood 22"end end;if x.Berserking:IsCastable()and g:BuffUp(x.VoidformBuff)then if o(x.Berserking,nil)then Q=33;return"berserking 24"end end;if x.LightsJudgment:IsCastable()and M>=2 then if o(x.LightsJudgment,nil,nil,not h:IsSpellInRange(x.LightsJudgment))then Q=30;return"lights_judgment 26"end end;if x.AncestralCall:IsCastable()and g:BuffUp(x.VoidformBuff)then if o(x.AncestralCall,nil)then Q=34;return"ancestral_call 28"end end;if x.BagofTricks:IsCastable()then if o(x.BagofTricks,nil,nil,not h:IsSpellInRange(x.BagofTricks))then Q=31;return"bag_of_tricks 30"end end end;if true then local G=aw()if G then return G end end;if true then local G=ax()if G then return G end end end end;local function aA()x.VampiricTouchDebuff:RegisterAuraTracking()end;function ReturnSpell()if Q==0 then return 0 else return Q end end;function ReturnSpellMO()if P==0 then return 0 else return P end end;l.SetAPL(258,az,aA)