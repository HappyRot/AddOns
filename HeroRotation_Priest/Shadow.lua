local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=HeroRotation;local m=l.AoEON;local n=l.CDsON;local o=l.Cast;local p=l.CastSuggested;local q=HeroRotationCharDB.Toggles[4]local r=HeroRotationCharDB.Toggles[5]local s=HeroRotationCharDB.Toggles[6]local t=not HeroRotationCharDB.Toggles[15]local u=HeroRotationCharDB.Toggles[12]local v=HeroRotationCharDB.Toggles[60]local w=HeroRotationCharDB.Toggles[61]local x=false;local y=false;local z=false;local A=false;local B=false;local C=0;local D=math.min;local E=j.Priest.Shadow;local F=k.Priest.Shadow;local G={F.ArchitectsIngenuityCore:ID(),F.EmpyrealOrdinance:ID(),F.InscrutableQuantumDevice:ID(),F.MacabreSheetMusic:ID(),F.ShadowedOrbofTorment:ID(),F.SinfulGladiatorsBadgeofFerocity:ID(),F.SoullettingRuby:ID(),F.TheFirstSigil:ID(),F.ScarsofFraternalStrife:ID()}local H=g:GetEquipment()local I=k(0)local J=k(0)local K,L=GetInventoryItemID("player",13)local M,L=GetInventoryItemID("player",14)if H[13]then I=k(H[13])end;if H[14]then J=k(H[14])end;local N;local O,P,Q,R;local S,T;local U;local V;local W=0;local X=0;local Y=0;local Z;local _;local a0=l.Commons.Everyone;local a1={General=l.GUISettings.General,Commons=l.GUISettings.APL.Priest.Commons,Shadow=l.GUISettings.APL.Priest.Shadow}local a2=0;local a3=0;local a4=0;local Z=0;local a5=0;local a6=false;local a7=false;local a8=1;local a9=false;local aa=false;local ab=false;local ac=false;local ad=0;local ae=false;local af=2;local ag=g:HasLegendaryEquipped(202)local ah=g:HasLegendaryEquipped(161)local ai=g:HasLegendaryEquipped(158)local aj=g:HasLegendaryEquipped(159)local ak=j(200174)d:RegisterForEvent(function()a6=false;a7=false;a8=1;a9=false;ae=false end,"PLAYER_REGEN_ENABLED")d:RegisterForEvent(function()ag=g:HasLegendaryEquipped(202)ah=g:HasLegendaryEquipped(161)ai=g:HasLegendaryEquipped(158)aj=g:HasLegendaryEquipped(159)end,"PLAYER_EQUIPMENT_CHANGED")d:RegisterForEvent(function()E.ShadowCrash:RegisterInFlight()end,"LEARNED_SPELL_IN_TAB")E.ShadowCrash:RegisterInFlight()local function al(am)if am then return 1 else return 0 end end;local function an(am)return am~=0 end;local function ao(ap,aq)if aq then return ap:DebuffUp(E.ShadowWordPainDebuff)and(ap:DebuffUp(E.VampiricTouchDebuff)or ap:TimeToDie()<18)and ap:DebuffUp(E.DevouringPlagueDebuff)else return ap:DebuffUp(E.ShadowWordPainDebuff)and(ap:DebuffUp(E.VampiricTouchDebuff)or ap:TimeToDie()<18)end end;local function ar(as)local at=0;if as~=nil then for au in pairs(as)do local av=as[au]if av:DebuffDown(E.ShadowWordPainDebuff)then at=at+1 end end end;return at end;local function aw(as)local ax=0;if as~=nil then for au in pairs(as)do local av=as[au]if av:DebuffRefreshable(E.ShadowWordPainDebuff)then ax=ax+1 end end end;return ax end;local function ay(az)if(az:DebuffRefreshable(E.VampiricTouchDebuff)or az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffDown(E.MindDevourerBuff)and g:Insanity()<50)and(g:BuffStack(E.DarkThoughtBuff)<af or not g:HasTier(28,2))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then W=1136149;return true elseif(az:DebuffRefreshable(E.VampiricTouchDebuff)or az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffDown(E.MindDevourerBuff)and g:Insanity()<50)and(g:BuffStack(E.DarkThoughtBuff)<af or not g:HasTier(28,2))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif(az:DebuffRefreshable(E.VampiricTouchDebuff)or az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffDown(E.MindDevourerBuff)and g:Insanity()<50)and(g:BuffStack(E.DarkThoughtBuff)<af or not g:HasTier(28,2))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then X=136149;return true elseif(az:DebuffRefreshable(E.VampiricTouchDebuff)or az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffDown(E.MindDevourerBuff)and g:Insanity()<50)and(g:BuffStack(E.DarkThoughtBuff)<af or not g:HasTier(28,2))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aA(az)if(az:HealthPercentage()<20 and T<4 or ak:TimeSinceLastCast()<=15 and aj and T<=7)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then W=1136149;return true elseif(az:HealthPercentage()<20 and T<4 or ak:TimeSinceLastCast()<=15 and aj and T<=7)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif(az:HealthPercentage()<20 and T<4 or ak:TimeSinceLastCast()<=15 and aj)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then X=136149;return true elseif(az:HealthPercentage()<20 and T<4 or ak:TimeSinceLastCast()<=15 and aj)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aB(az)if az:TimeToDie()<20 and g:BuffDown(E.VoidformBuff)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then W=1319952;return true elseif az:TimeToDie()<20 and g:BuffDown(E.VoidformBuff)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif az:TimeToDie()<20 and g:BuffDown(E.VoidformBuff)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then X=319952;return true elseif az:TimeToDie()<20 and g:BuffDown(E.VoidformBuff)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aC(az)if(ao(az,false)and az:TimeToDie()>=18 and((az:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0)or E.Misery:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then W=1263165;return true elseif(ao(az,false)and az:TimeToDie()>=18 and((az:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0)or E.Misery:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif(ao(az,false)and az:TimeToDie()>=18 and((az:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0)or E.Misery:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then X=263165;return true elseif(ao(az,false)and az:TimeToDie()>=18 and((az:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0)or E.Misery:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aD(az)if(az:DebuffRefreshable(E.VampiricTouchDebuff)and(az:TimeToDie()>18 or az:IsDummy()or az:NPCID()==153285)and(az:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0 or E.Misery:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then W=134914;return true elseif(az:DebuffRefreshable(E.VampiricTouchDebuff)and(az:TimeToDie()>18 or az:IsDummy()or az:NPCID()==153285)and(az:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0 or E.Misery:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif(az:DebuffRefreshable(E.VampiricTouchDebuff)and(az:TimeToDie()>18 or az:IsDummy()or az:NPCID()==153285)and(az:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0 or E.Misery:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then X=34914;return true elseif(az:DebuffRefreshable(E.VampiricTouchDebuff)and(az:TimeToDie()>18 or az:IsDummy()or az:NPCID()==153285)and(az:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0 or E.Misery:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aE(az)if az:DebuffRefreshable(E.ShadowWordPainDebuff)and az:TimeToDie()>4 and not E.Misery:IsAvailable()and not(E.SearingNightmare:IsAvailable()and T>a8)and(not E.PsychicLink:IsAvailable()or E.PsychicLink:IsAvailable()and T<=2)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then W=1589;return true elseif az:DebuffRefreshable(E.ShadowWordPainDebuff)and az:TimeToDie()>4 and not E.Misery:IsAvailable()and not(E.SearingNightmare:IsAvailable()and T>a8)and(not E.PsychicLink:IsAvailable()or E.PsychicLink:IsAvailable()and T<=2)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif az:DebuffRefreshable(E.ShadowWordPainDebuff)and az:TimeToDie()>4 and not E.Misery:IsAvailable()and not(E.SearingNightmare:IsAvailable()and T>a8)and(not E.PsychicLink:IsAvailable()or E.PsychicLink:IsAvailable()and T<=2)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then X=589;return true elseif az:DebuffRefreshable(E.ShadowWordPainDebuff)and az:TimeToDie()>4 and not E.Misery:IsAvailable()and not(E.SearingNightmare:IsAvailable()and T>a8)and(not E.PsychicLink:IsAvailable()or E.PsychicLink:IsAvailable()and T<=2)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aF(az)if E.SearingNightmare:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)and T>2 and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then W=148045;return true elseif E.SearingNightmare:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)and T>2 and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif E.SearingNightmare:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)and T>2 and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then X=48045;return true elseif E.SearingNightmare:IsAvailable()and az:DebuffRefreshable(E.ShadowWordPainDebuff)and T>2 and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aG(az)if g:Insanity()<90 and(ao(az,true)and(not E.VoidEruption:CooldownUp()or not y or not E.HungeringVoid:IsAvailable())or g:BuffUp(E.VoidformBuff))and(not E.HungeringVoid:IsAvailable()or az:DebuffUp(E.HungeringVoidDebuff)or g:BuffDown(E.VoidformBuff))and(not E.SearingNightmare:IsAvailable()or T<5)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then W=1323673;return true elseif g:Insanity()<90 and(ao(az,true)and(not E.VoidEruption:CooldownUp()or not y or not E.HungeringVoid:IsAvailable())or g:BuffUp(E.VoidformBuff))and(not E.HungeringVoid:IsAvailable()or az:DebuffUp(E.HungeringVoidDebuff)or g:BuffDown(E.VoidformBuff))and(not E.SearingNightmare:IsAvailable()or T<5)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif g:Insanity()<90 and(ao(az,true)and(not E.VoidEruption:CooldownUp()or not y or not E.HungeringVoid:IsAvailable())or g:BuffUp(E.VoidformBuff))and(not E.HungeringVoid:IsAvailable()or az:DebuffUp(E.HungeringVoidDebuff)or g:BuffDown(E.VoidformBuff))and(not E.SearingNightmare:IsAvailable()or T<5)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then X=323673;return true elseif g:Insanity()<90 and(ao(az,true)and(not E.VoidEruption:CooldownUp()or not y or not E.HungeringVoid:IsAvailable())or g:BuffUp(E.VoidformBuff))and(not E.HungeringVoid:IsAvailable()or az:DebuffUp(E.HungeringVoidDebuff)or g:BuffDown(E.VoidformBuff))and(not E.SearingNightmare:IsAvailable()or T<5)and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aH(az)return az:HealthPercentage()end;local function aI(az)if(g:BuffUp(E.PowerInfusionBuff)or not a1.Shadow.SelfPI or F.ShadowedOrbofTorment:IsEquipped())and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==f("mouseover"):GUID()and a1.Shadow.TargetSwap=="Mouseover"then if F.SoullettingRuby:ID()==GetInventoryItemID("player",13)then W=241;return true elseif F.SoullettingRuby:ID()==GetInventoryItemID("player",14)then W=251;return true end elseif(g:BuffUp(E.PowerInfusionBuff)or not a1.Shadow.SelfPI or F.ShadowedOrbofTorment:IsEquipped())and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and a1.Shadow.TargetSwap=="AutoSwap"and az:GUID()~=h:GUID()and not u then W=999;return true elseif(g:BuffUp(E.PowerInfusionBuff)or not a1.Shadow.SelfPI or F.ShadowedOrbofTorment:IsEquipped())and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)and az:GUID()==h:GUID()then if F.SoullettingRuby:ID()==GetInventoryItemID("player",13)then W=241;return true elseif F.SoullettingRuby:ID()==GetInventoryItemID("player",14)then W=251;return true end elseif(g:BuffUp(E.PowerInfusionBuff)or not a1.Shadow.SelfPI or F.ShadowedOrbofTorment:IsEquipped())and(az:AffectingCombat()or az:IsDummy()or az:NPCID()==153285 or az:NPCID()==168326)then return true end end;local function aJ()if a0.TargetIsValid()and not g:IsDeadOrGhost()and not g:AffectingCombat()and(s or a1.Commons.DBMSupport and l.BossMods:GetPullTimer()<_+g:GCD()and l.BossMods:GetPullTimer()>0)and not g:IsMoving()then if E.Fleshcraft:IsCastable()and(C==0 or C>E.Fleshcraft:ExecuteTime())and q and not g:IsMoving()and(E.PustuleEruption:SoulbindEnabled()or E.VolatileSolvent:SoulbindEnabled())then if o(E.Fleshcraft,nil,nil)then X=324631;return"fleshcraft precombat 1"end end;if E.ArcaneTorrent:IsCastable()and n()then if o(E.ArcaneTorrent,nil,nil,not h:IsSpellInRange(E.ArcaneTorrent))then X=28730;return"arcane_torrent 6"end end;if(a1.Commons.Enabled.TopTrinket or a1.Commons.Enabled.BottomTrinket)and F.ShadowedOrbofTorment:IsEquippedAndReady()and(C==0 or C>2)then if o(F.ShadowedOrbofTorment,nil,nil)then if F.ShadowedOrbofTorment:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.ShadowedOrbofTorment:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;a8=2;if E.VampiricTouch:IsCastable()and(C==0 or C>E.VampiricTouch:CastTime()+0.5)and not E.Damnation:IsAvailable()then if o(E.VampiricTouch,nil,nil,not h:IsSpellInRange(E.VampiricTouch))then X=34914;return"vampiric_touch 10"end end;if E.MindBlast:IsReady()and(C==0 or C>E.MindBlast:CastTime()+0.5)and E.Damnation:IsAvailable()then if o(E.MindBlast,nil,nil,not h:IsSpellInRange(E.MindBlast))then X=8092;return"mind_blast 11"end end;if E.MindBlast:IsCastable()and(C==0 or C>E.MindBlast:CastTime()+0.5)and(E.Misery:IsAvailable()and(not ah or not E.VoidTorrent:IsAvailable()))then if o(E.MindBlast,nil,nil,not h:IsSpellInRange(E.MindBlast))then X=8092;return"mind_blast 12"end end;if E.VoidTorrent:IsCastable()and(C==0 or C>3+0.5)and z and(E.Misery:IsAvailable()and ah)then if o(E.VoidTorrent,nil,nil,not h:IsSpellInRange(E.VoidTorrent))then X=263165;return"void_torrent 14"end end;if E.MindFlay:IsCastable()and(C==0 or C>1)and not g:IsChanneling(E.MindFlay)and T<=a8 and(E.Misery:IsAvailable()and ah and not E.VoidTorrent:IsAvailable())then if o(E.MindFlay,nil,nil,not h:IsSpellInRange(E.MindFlay))then X=15407;return"mind_flay 15"end end;if E.ShadowWordPain:IsCastable()and not E.Misery:IsAvailable()then if o(E.ShadowWordPain,nil,nil,not h:IsSpellInRange(E.ShadowWordPain))then X=589;return"shadow_word_pain 16"end end end end;local function aK()if F.EmpyrealOrdinance:IsEquippedAndReady()and(E.VoidEruption:CooldownRemains()<=12 and y or(E.VoidEruption:CooldownRemains()>27 or not y))then if o(F.EmpyrealOrdinance,nil,nil,not h:IsInRange(40))then if F.EmpyrealOrdinance:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.EmpyrealOrdinance:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if F.InscrutableQuantumDevice:IsEquippedAndReady()and(g:BuffUp(E.VoidformBuff)and g:BuffUp(E.PowerInfusionBuff)or d.BossFilteredFightRemains("<=",20)or g:BuffUp(E.PowerInfusionBuff)and(d.BossFilteredFightRemains("<",E.VoidEruption:CooldownRemains()+15)or not y)or g:BuffUp(E.VoidformBuff)and(d.BossFilteredFightRemains("<",E.PowerInfusion:CooldownRemains()+15)or not x)or(E.PowerInfusion:CooldownRemains()>=10 or not x)and(E.VoidEruption:CooldownRemains()>=10 or not y)and d.BossFilteredFightRemains(">=",190))then if o(F.InscrutableQuantumDevice,nil,nil)then if F.InscrutableQuantumDevice:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.InscrutableQuantumDevice:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if F.MacabreSheetMusic:IsEquippedAndReady()and(E.VoidEruption:CooldownRemains()>10 or not y)then if o(F.MacabreSheetMusic,nil,nil)then if F.MacabreSheetMusic:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.MacabreSheetMusic:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if F.SoullettingRuby:IsEquippedAndReady()and(g:BuffUp(E.PowerInfusionBuff)or not a1.Shadow.SelfPI or F.ShadowedOrbofTorment:IsEquipped())then if o(F.SoullettingRuby,nil,nil)then if F.SoullettingRuby:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.SoullettingRuby:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if F.TheFirstSigil:IsEquippedAndReady()and(g:BuffUp(E.VoidformBuff)or g:BuffUp(E.PowerInfusionBuff)or not a1.Shadow.SelfPI or E.VoidEruption:CooldownRemains()>10 or F.SoullettingRuby:IsEquipped()and not F.SoullettingRuby:IsReady()or Z<20)then if o(F.TheFirstSigil,nil,nil)then if F.TheFirstSigil:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.TheFirstSigil:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if F.SinfulGladiatorsBadgeofFerocity:IsEquippedAndReady()and(E.VoidEruption:CooldownRemains()>=10 or not y)then if o(F.SinfulGladiatorsBadgeofFerocity,nil,nil)then if F.SinfulGladiatorsBadgeofFerocity:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.SinfulGladiatorsBadgeofFerocity:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if F.ShadowedOrbofTorment:IsEquippedAndReady()and(C==0 or C>2.5)and(E.PowerInfusion:CooldownRemains()<=10 and E.VoidEruption:CooldownRemains()<=10 and(CovenantID==4 or CovenantID==1)or(CovenantID==2 or CovenantID==3)and(g:BuffDown(E.VoidformBuff)or g:PrevGCD(1,E.VoidBolt)))then if o(F.ShadowedOrbofTorment,nil,nil)then if F.ShadowedOrbofTorment:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.ShadowedOrbofTorment:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if F.ArchitectsIngenuityCore:IsEquippedAndReady()then if o(F.ArchitectsIngenuityCore,nil,nil,not h:IsInRange(30))then if F.ArchitectsIngenuityCore:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.ArchitectsIngenuityCore:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if F.ScarsofFraternalStrife:IsEquippedAndReady()and(g:BuffDown(E.ScarsofFraternalStrifeBuff4)and a4>1 or(g:BuffUp(E.VoidformBuff)or g:BuffUp(E.PowerInfusionBuff)or E.VoidEruption:CooldownRemains()>10))then if o(F.ScarsofFraternalStrife,nil,nil)then if F.ScarsofFraternalStrife:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif F.ScarsofFraternalStrife:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end;if g:BuffUp(E.VoidformBuff)or g:BuffUp(E.PowerInfusionBuff)or(E.VoidEruption:CooldownRemains()>10 or not y)then local aL=g:GetUseableTrinkets(G)if aL then if o(aL,nil,nil)then if aL:ID()==K and a1.Commons.Enabled.TopTrinket then X=24;return"top trinket 1"elseif aL:ID()==M and a1.Commons.Enabled.BottomTrinket then X=30;return"top trinket 2"end end end end end;local function aM()if E.PowerInfusion:IsCastable()and x and not g:IsMoving()and(a1.Shadow.SelfPI and(g:BuffUp(E.VoidformBuff)or g:Covenant()~="Kyrian"and g:Covenant()~="Necrolord"and(E.VoidEruption:CooldownRemains()>=10 or not y)or Z<E.VoidEruption:CooldownRemains()or not y)and(Z>=E.VoidEruption:CooldownRemains()+15 and y and(E.VoidEruption:CooldownRemains()<=g:GCD()*4 and y)or Z>E.PowerInfusion:Cooldown()and x or(Z<E.VoidEruption:CooldownRemains()+15 or not y)or CovenantID==1 or g:BloodlustUp()))then if o(E.PowerInfusion,nil)then X=10060;return"power_infusion 50"end end;if E.FaeGuardians:IsReady()and q and(g:BuffDown(E.VoidformBuff)and(not E.VoidTorrent:CooldownUp()or not z or not E.VoidTorrent:IsAvailable())and(a6 and T==1 or ad and T>1)or g:BuffUp(E.VoidformBuff)and(E.GroveInvigoration:IsAvailable()or E.FieldofBlossoms:IsAvailable()))then if o(E.FaeGuardians,nil)then X=327661;return"fae_guardians 52"end end;if E.Mindgames:IsReady()and(C==0 or C>E.Mindgames:CastTime()+0.5)and not g:IsMoving()and q then if g:Insanity()<90 and(ao(h,true)and(not E.VoidEruption:CooldownUp()or not y or not E.HungeringVoid:IsAvailable())or g:BuffUp(E.VoidformBuff))and(not E.HungeringVoid:IsAvailable()or h:DebuffRemains(E.HungeringVoidDebuff)>E.Mindgames:CastTime()or g:BuffDown(E.VoidformBuff))and(not E.SearingNightmare:IsAvailable()or T<5)then if o(E.Mindgames,nil,nil,not h:IsSpellInRange(E.Mindgames))then X=323673;return"mindgames 54"end end end;if E.UnholyNova:IsReady()and q and(not E.HungeringVoid:IsAvailable()and a6 or h:DebuffUp(E.HungeringVoidDebuff)and g:BuffUp(E.VoidformBuff)or(E.VoidEruption:CooldownRemains()>10 or not y or not ae)and g:BuffDown(E.VoidformBuff))then if o(E.UnholyNova,nil,nil,not h:IsSpellInRange(E.UnholyNova))then X=324724;return"Shadow_nova 56"end end;if E.BoonoftheAscended:IsCastable()and(C==0 or C>E.BoonoftheAscended:CastTime()+0.5)and q and(g:BuffDown(E.VoidformBuff)and(not E.VoidEruption:CooldownUp()or not y)and T>1 and not E.SearingNightmare:IsAvailable()or g:BuffUp(E.VoidformBuff)and T<2 and not E.SearingNightmare:IsAvailable()and(g:PrevGCD(1,E.VoidBolt)and(not F.EmpyrealOrdinance:IsEquipped()or not E.HungeringVoid:IsAvailable())or F.EmpyrealOrdinance:IsEquipped()and F.EmpyrealOrdinance:CooldownRemains()<=162 and h:DebuffUp(E.HungeringVoidDebuff))or g:BuffUp(E.VoidformBuff)and E.SearingNightmare:IsAvailable())then if o(E.BoonoftheAscended,nil)then X=325013;return"boon_of_the_ascended 58"end end;if true then local N=aK()if N then return N end end;if E.Fleshcraft:IsCastable()and q and(C==0 or C>g:GCD()*1.25)and a1.Shadow.CastCancelFC and(E.VolatileSolvent:SoulbindEnabled()and g:BuffRemains(E.VolatileSolventHumanBuff)<10 and g:BuffDown(E.VoidformBuff)and g:BuffDown(E.PowerInfusionBuff))then if o(E.Fleshcraft,nil,nil)then X=324631;return"fleshcraft 60"end end end;local function aN()if E.AscendedBlast:IsReady()and T<=3 then if o(E.AscendedBlast,nil,nil,not h:IsSpellInRange(E.AscendedBlast))then X=235283;return"ascended_blast 70"end end;if E.AscendedNova:IsReady()and(#O>1 and T>1+al(E.SearingNightmare:IsAvailable()))then if o(E.AscendedNova,nil,nil,not h:IsInRange(8))then X=325020;return"ascended_nova 72"end end end;local function aO()if E.MindBlast:IsCastable()and(g:BuffUp(E.DarkThoughtBuff)and g:IsChanneling())then if g:HasTier(28,4)and g:BuffUp(E.DarkThoughtBuff)and E.Mindbender:TimeSinceLastCast()<15 and aj and g:BuffDown(E.VoidformBuff)and g:BuffRemains(E.LivingShadowBuff)<Z or g:BuffUp(E.DarkThoughtBuff)and g:BuffRemains(E.LivingShadowBuff)<g:GCD()*(3+al(g:BuffDown(E.VoidformBuff))*16)and g:BuffRemains(E.LivingShadowBuff)<Z then if o(E.MindBlast,nil,nil,not h:IsSpellInRange(E.MindBlast))then X=8092;return"mind_blast 84"end end end;if E.SearingNightmare:IsReady()and g:IsChanneling(E.MindSear)and(a9 and not ae or V>0 and T>1 or g:Insanity()>85)then if o(E.SearingNightmare,nil,nil,not h:IsInRange(40))then X=341385;return"searing_nightmare 80"end end;if E.SearingNightmare:IsReady()and g:IsChanneling(E.MindSear)and(V>0 and T>2)then if o(E.SearingNightmare,nil,nil,not h:IsInRange(40))then X=341385;return"searing_nightmare 82"end end;if E.MindBlast:IsCastable()and(g:BuffUp(E.DarkThoughtBuff)and g:IsChanneling())then if o(E.MindBlast,nil,nil,not h:IsSpellInRange(E.MindBlast))then X=8092;return"mind_blast 84"end end end;local function aP()if g:BuffUp(E.BoonoftheAscendedBuff)then local N=aN()if N then return N end end;if E.VoidBolt:CooldownUp()and g:BuffUp(E.DissonantEchoesBuff)then if o(E.VoidBolt,nil,nil,not h:IsInRange(40))then X=214771;return"void_bolt 90"end end;if E.VoidEruption:IsReady()and(C==0 or C>E.VoidEruption:CastTime()+0.5)and y and not g:IsMoving()and(ae and(g:Insanity()>=25+15*al(g:Race()=="BloodElf"and a4<30)or ak:TimeSinceLastCast()<=15 and aj and(not E.MindBlast:CooldownUp()or g:IsCasting(E.MindBlast))and not E.ShadowWordDeath:CooldownUp())and(g:Insanity()<=85 or E.SearingNightmare:IsAvailable()and a9))then if o(E.VoidEruption,nil,nil,not h:IsSpellInRange(E.VoidEruption))then X=228260;return"void_eruption 92"end end;if E.ShadowWordPain:IsCastable()and(g:BuffUp(E.FaeGuardiansBuff)and h:DebuffDown(E.WrathfulFaerieDebuff)and T<4)then if E.Misery:IsAvailable()and h:TimeToDie()>=18 then if o(E.VampiricTouch,nil,nil,not h:IsSpellInRange(E.VampiricTouch))then X=34914;return"vampiric_touch 94"end else if o(E.ShadowWordPain,nil,nil,not h:IsSpellInRange(E.ShadowWordPain))then X=589;return"shadow_word_pain 94"end end end;if E.MindSear:IsCastable()and(C==0 or C>1)and not g:IsMoving()and not g:IsChanneling(E.MindSear)and(E.SearingNightmare:IsAvailable()and T>a8 and U>0 and(not ak:CooldownUp()or not B)and T>=4)then if o(E.MindSear,nil,nil,not h:IsSpellInRange(E.MindSear))then X=48045;return"mind_sear 97"end end;if true then local N=aM()if N then return N end end;if E.MindSear:IsCastable()and(C==0 or C>1)and not g:IsMoving()and not g:IsChanneling(E.MindSear)and(E.SearingNightmare:IsAvailable()and T>a8 and U>0 and(not ak:CooldownUp()or not B))then if o(E.MindSear,nil,nil,not h:IsSpellInRange(E.MindSear))then X=48045;return"mind_sear 97"end end;if E.Damnation:IsCastable()then if a0.CastCycle(E.Damnation,Q,ay,not h:IsSpellInRange(E.Damnation))then X=341374;return"damnation 98"end end;if E.ShadowWordDeath:IsReady()and ak:TimeSinceLastCast()<=15 and aj and 15-ak:TimeSinceLastCast()<=g:GCD()+0.5 and T<=7 then if o(E.ShadowWordDeath,nil,nil,not h:IsSpellInRange(E.ShadowWordDeath))then X=136149;return"shadow_word_death 99"end end;if E.MindBlast:IsCastable()and(C==0 or C>E.MindBlast:CastTime()+0.5)and not g:IsMoving()and E.MindBlast:CastTime()<E.VoidBolt:CooldownRemains()and((E.MindBlast:Charges()>1 and(h:DebuffUp(E.HungeringVoidDebuff)or not E.HungeringVoid:IsAvailable())or E.Mindbender:TimeSinceLastCast()<=15 and 15-E.Mindbender:TimeSinceLastCast()<=E.MindBlast:CastTime()+g:GCD()+0.5)and E.Mindbender:TimeSinceLastCast()<=15 and aj and 15-E.Mindbender:TimeSinceLastCast()>E.MindBlast:CastTime()and T<=7 or g:BuffUp(E.DarkThoughtBuff)and g:BuffUp(E.VoidformBuff)and not E.VoidBolt:CooldownUp()and(not aj or E.Mindbender:TimeSinceLastCast()>15)and g:HasTier(28,4))then if o(E.MindBlast,nil,nil,not h:IsSpellInRange(E.MindBlast))then X=8092;return"mind_blast 100"end end;if E.VoidBolt:IsCastable()and(T<4 or E.HungeringVoid:IsAvailable()and T<=6)and(g:Insanity()<=85 and E.HungeringVoid:IsAvailable()and E.SearingNightmare:IsAvailable()and T<=6 or(E.HungeringVoid:IsAvailable()and not E.SearingNightmare:IsAvailable()or T==1))then if o(E.VoidBolt,nil,nil,not h:IsInRange(40))then X=214771;return"void_bolt 101"end end;if E.DevouringPlague:IsReady()and(g:HasTier(28,4)or E.HungeringVoid:IsAvailable())and E.SearingNightmare:IsAvailable()and E.Mindbender:TimeSinceLastCast()<=15 and aj and g:BuffUp(E.VoidformBuff)and T<=6 then if o(E.DevouringPlague,nil,nil,not h:IsSpellInRange(E.DevouringPlague))then X=335467;return"devouring_plague 102"end end;if E.DevouringPlague:IsReady()and((h:DebuffRefreshable(E.DevouringPlagueDebuff)or g:Insanity()>75 or E.VoidTorrent:IsAvailable()and E.VoidTorrent:CooldownRemains()<=3*g:GCD()and z)and(not ae or g:Insanity()>=85)and(not E.SearingNightmare:IsAvailable()or E.SearingNightmare:IsAvailable()and not a9))then if o(E.DevouringPlague,nil,nil,not h:IsSpellInRange(E.DevouringPlague))then X=335467;return"devouring_plague 102"end end;if E.VoidBolt:IsCastable()and(T<4 or E.HungeringVoid:IsAvailable()and T<=6)and(T<4+al(E.DissonantEchoes:ConduitEnabled())and g:Insanity()<=85 and E.SearingNightmare:IsAvailable()or not E.SearingNightmare:IsAvailable())then if o(E.VoidBolt,nil,nil,not h:IsInRange(40))then X=214771;return"void_bolt 103"end end;if E.ShadowWordDeath:IsReady()and h:IsSpellInRange(E.ShadowWordDeath)and(h:HealthPercentage()<20 and T<4 or ak:TimeSinceLastCast()<=15 and aj and T<=7)then if o(E.ShadowWordDeath,nil)then X=136149;return"shadow_word_death 104"end end;if E.ShadowWordDeath:IsReady()and T<4 then if a0.CastCycle(E.ShadowWordDeath,Q,aA,not h:IsSpellInRange(E.ShadowWordDeath),nil)then return"shadow_word_death 104"end end;if E.SurrenderToMadness:IsCastable()then if a0.CastCycle(E.SurrenderToMadness,Q,aB,not h:IsSpellInRange(E.SurrenderToMadness),a1.Shadow.OffGCDasOffGCD.SurrenderToMadness)then return"surrender_to_madness 106"end end;if E.VoidTorrent:IsCastable()and(C==0 or C>3+0.5)and z and not g:IsMoving()then if ao(h,false)and h:TimeToDie()>3 and(g:BuffDown(E.VoidformBuff)or g:BuffRemains(E.VoidformBuff)<E.VoidBolt:CooldownRemains()+0.5 or g:PrevGCD(1,E.VoidBolt)and 3<=E.VoidBolt:CooldownRemains()and not g:BloodlustUp()and T<3)and ad and T<5+6*al(E.TwistofFate:IsAvailable())then if o(E.VoidTorrent,nil)then X=263165;return"void_torrent 107"end end end;if ak:IsCastable()and B and(E.SearingNightmare:IsAvailable()and T>a8 or h:DebuffUp(E.ShadowWordPainDebuff))and ad then if o(E.Mindbender,nil,nil,not h:IsSpellInRange(E.Mindbender))then X=200174;return"shadowfiend/mindbender 108"end end;if E.ShadowWordDeath:IsReady()and(ai and a6 and h:TimeToX(20)>E.ShadowWordDeath:Cooldown()+g:GCD())then if o(E.ShadowWordDeath,nil,nil,not h:IsSpellInRange(E.ShadowWordDeath))then X=136149;return"shadow_word_death 112"end end;if E.ShadowCrash:IsCastable()and A then if o(E.ShadowCrash,nil,nil,not h:IsInRange(40))then X=205385;return"shadow_crash 114"end end;if E.MindSear:IsCastable()and(C==0 or C>1)and not g:IsMoving()and not g:IsChanneling(E.MindSear)and(T>a8 and g:BuffUp(E.DarkThoughtBuff))then if o(E.MindSear,nil,nil,not h:IsSpellInRange(E.MindSear))then X=48045;return"mind_sear 118"end end;if E.MindFlay:IsCastable()and(C==0 or C>1)and T<=a8 and not g:IsMoving()and not g:IsCasting(E.MindFlay)and(g:BuffUp(E.DarkThoughtBuff)and a6 and not(g:BuffUp(E.VoidformBuff)and not ae and E.MindBlast:FullRechargeTime()>=g:GCD()+0.150))then if o(E.MindFlay,nil,nil,not h:IsSpellInRange(E.MindFlay))then X=15407;return"mind_flay 120"end end;if E.DevouringPlague:IsReady()and(T<3 or g:BuffUp(E.VoidformBuff))and T<4 and(ah and a6 and not a7)then if o(E.DevouringPlague,nil,nil,not h:IsSpellInRange(E.DevouringPlague))then X=335467;return"devouring_plague 121"end end;if E.MindBlast:IsCastable()and(C==0 or C>E.MindBlast:CastTime()+0.5)and not g:IsMoving()and(a6 and T<4+2*al(E.Misery:IsAvailable())+E.VampiricTouchDebuff:AuraActiveCount()*al(E.PsychicLink:IsAvailable())+D(5,T)*al(ak:TimeSinceLastCast()<=15 and aj)and(not aj or(not ak:CooldownUp()or not B)and aj or ad))then if o(E.MindBlast,nil,nil,not h:IsSpellInRange(E.MindBlast))then X=8092;return"mind_blast 122"end end;if E.VampiricTouch:IsCastable()and(C==0 or C>E.VampiricTouch:CastTime()+0.5)and not g:IsMoving()and not g:IsCasting(E.VampiricTouch)and h:IsSpellInRange(E.VampiricTouch)and(h:DebuffRefreshable(E.VampiricTouchDebuff)and(h:TimeToDie()>18 or h:IsDummy()or h:NPCID()==153285)and(h:DebuffUp(E.VampiricTouchDebuff)or not ad)and ab>0 or E.Misery:IsAvailable()and h:DebuffRefreshable(E.ShadowWordPainDebuff)or g:BuffUp(E.UnfurlingDarknessBuff))then if o(E.VampiricTouch,nil)then X=34914;return"vampiric_touch 124"end end;if E.VampiricTouch:IsCastable()and(C==0 or C>E.VampiricTouch:CastTime()+0.5)and not g:IsMoving()and(T<=4 or T<7 and g:Insanity()<30 and g:BuffDown(E.DarkThoughtBuff))then if a0.CastCycle(E.VampiricTouch,Q,aD,not h:IsSpellInRange(E.VampiricTouch))then return"vampiric_touch 124"end end;if E.ShadowWordPain:IsCastable()and T<4 and(h:DebuffRefreshable(E.ShadowWordPainDebuff)and h:TimeToDie()>4 and not E.Misery:IsAvailable()and E.PsychicLink:IsAvailable()and T>2)then if o(E.ShadowWordPain,nil,nil,not h:IsSpellInRange(E.ShadowWordPain))then X=589;return"shadow_word_pain 126"end end;if E.ShadowWordPain:IsCastable()and(h:DebuffRefreshable(E.ShadowWordPainDebuff)and h:IsSpellInRange(E.ShadowWordPain)and(h:TimeToDie()>4 or h:IsDummy()or h:NPCID()==153285)and not E.Misery:IsAvailable()and not(E.SearingNightmare:IsAvailable()and T>a8)and(not E.PsychicLink:IsAvailable()or E.PsychicLink:IsAvailable()and T<=2))then if o(E.ShadowWordPain,nil)then X=589;return"shadow_word_pain 128"end end;if E.ShadowWordPain:IsCastable()and T<=4 and not E.Misery:IsAvailable()then if a0.CastCycle(E.ShadowWordPain,Q,aE,not h:IsSpellInRange(E.ShadowWordPain))then return"shadow_word_pain 128"end end;if E.MindSear:IsCastable()and(C==0 or C>1)and not g:IsMoving()and not g:IsChanneling(E.MindSear)and T>a8 and(E.VoidBolt:CooldownRemains()>=g:GCD()*0.75 or not g:BuffUp(E.VoidformBuff)or T>6)then if o(E.MindSear,nil,nil,not h:IsSpellInRange(E.MindSear))then X=48045;return"mind_sear 130"end end;if E.MindFlay:IsCastable()and(C==0 or C>1)and not g:IsMoving()and T<=a8 and not g:IsChanneling(E.MindFlay)and(g:BuffDown(E.DarkThoughtBuff)or E.VoidBolt:CooldownUp()and(g:BuffUp(E.VoidformBuff)or g:BuffDown(E.DarkThoughtBuff)and g:BuffUp(E.DissonantEchoesBuff)))and(E.VoidBolt:CooldownRemains()>=g:GCD()*0.75 or not g:BuffUp(E.VoidformBuff))then if o(E.MindFlay,nil,nil,not h:IsSpellInRange(E.MindFlay))then X=15407;return"mind_flay 132"end end;if E.ShadowWordDeath:IsReady()and g:IsMoving()then if o(E.ShadowWordDeath,nil,nil,not h:IsSpellInRange(E.ShadowWordDeath))then X=136149;return"shadow_word_death 133"end end;if E.ShadowWordPain:IsCastable()and g:IsMoving()then if o(E.ShadowWordPain,nil,nil,not h:IsSpellInRange(E.ShadowWordPain))then X=589;return"shadow_word_pain 134"end end end;local function aQ()s=HeroRotationCharDB.Toggles[6]q=HeroRotationCharDB.Toggles[4]r=HeroRotationCharDB.Toggles[5]u=HeroRotationCharDB.Toggles[12]t=not HeroRotationCharDB.Toggles[15]v=HeroRotationCharDB.Toggles[60]w=HeroRotationCharDB.Toggles[61]x=false;y=false;z=false;A=false;B=false;if a1.Shadow.PowerInfusion=="CDs"and n()or a1.Shadow.PowerInfusion=="Small CDs"and(n()or r)or a1.Shadow.PowerInfusion=="Always"then x=true end;if a1.Shadow.VoidEruption=="CDs"and n()or a1.Shadow.VoidEruption=="Small CDs"and(n()or r)or a1.Shadow.VoidEruption=="Always"then y=true end;if a1.Shadow.VoidTorrent=="CDs"and n()or a1.Shadow.VoidTorrent=="Small CDs"and(n()or r)or a1.Shadow.VoidTorrent=="Always"then z=true end;if a1.Shadow.MindBender=="CDs"and n()or a1.Shadow.MindBender=="Small CDs"and(n()or r)or a1.Shadow.MindBender=="Always"then B=true end;if a1.Shadow.ShadowCrash=="CDs"and n()or a1.Shadow.ShadowCrash=="Small CDs"and(n()or r)or a1.Shadow.ShadowCrash=="Always"then A=true end;C=0;for aR=1,20 do if select(10,UnitDebuff("player",aR))==240447 then if select(6,UnitDebuff("player",aR))~=nil then C=select(6,UnitDebuff("player",aR))-GetTime()end end end;_=0;if E.Fleshcraft:IsCastable()and(C==0 or C>E.Fleshcraft:ExecuteTime())and q and not g:IsMoving()and(E.PustuleEruption:SoulbindEnabled()or E.VolatileSolvent:SoulbindEnabled())then _=_+3 end;if E.ArcaneTorrent:IsCastable()and n()then _=_+g:GCD()end;if(F.ShadowedOrbofTorment:ID()==K and a1.Commons.Enabled.TopTrinket or F.ShadowedOrbofTorment:ID()==M and a1.Commons.Enabled.BottomTrinket)and F.ShadowedOrbofTorment:IsEquippedAndReady()and(C==0 or C>2)then _=_+2 end;if E.VampiricTouch:IsCastable()and(C==0 or C>E.VampiricTouch:CastTime()+0.5)and not E.Damnation:IsAvailable()then _=_+E.VampiricTouch:CastTime()end;if E.MindBlast:IsReady()and(C==0 or C>E.MindBlast:CastTime()+0.5)and E.Damnation:IsAvailable()then _=_+E.MindBlast:CastTime()end end;local function aS()O=g:GetEnemiesInMeleeRange(8)P=g:GetEnemiesInRange(30)Q=g:GetEnemiesInRange(40)R=h:GetEnemiesInSplashRange(15)K,L=GetInventoryItemID("player",13)M,L=GetInventoryItemID("player",14)if m()and a1.Commons.AoeMode=="Conservative"then S=h:GetEnemiesInSplashRangeCount(8)T=h:GetEnemiesInSplashRangeCount(15)elseif m()and a1.Commons.AoeMode=="Aggresive"then local aT=0;for aU=1,20 do local aV="nameplate"..aU;if UnitExists(aV)then if UnitCanAttack("player",aV)then if UnitCanAttack("player",aV)and UnitAffectingCombat("target")and IsItemInRange(32698,aV)and UnitDetailedThreatSituation("player",aV)~=nil or f(aV):IsDummy()or string.find(UnitGUID(aV),153285)or string.find(UnitGUID(aV),31146)or string.find(UnitGUID(aV),176581)or string.find(UnitGUID(aV),179124)or string.find(UnitGUID(aV),179010)or string.find(UnitGUID(aV),180323)or string.find(UnitGUID(aV),179010)or string.find(UnitGUID(aV),179942)or string.find(UnitGUID(aV),176521)or string.find(UnitGUID(aV),177594)or string.find(UnitGUID(aV),177117)or string.find(UnitGUID(aV),176581)or string.find(UnitGUID(aV),180840)or string.find(UnitGUID(aV),176605)or UnitName(aV)=="Glacial Spike"or string.find(UnitGUID(aV),180473)or string.find(UnitGUID(aV),180474)or string.find(UnitGUID(aV),176929)or string.find(UnitGUID(aV),176920)or string.find(UnitGUID(aV),177154)or string.find(UnitGUID(aV),177787)or string.find(UnitGUID(aV),177889)or string.find(UnitGUID(aV),177891)or string.find(UnitGUID(aV),177892)or string.find(UnitGUID(aV),168326)then aT=aT+1 end end end end;S=aT;T=aT end;local aW=0;for aX=1,20 do local aV="nameplate"..aX;if UnitExists(aV)then if UnitCanAttack("player",aV)then if UnitCanAttack("player",aV)and UnitAffectingCombat("target")and IsItemInRange(32698,aV)and UnitDetailedThreatSituation("player",aV)~=nil and f(aV):TimeToDie()>=12 or f(aV):IsDummy()or string.find(UnitGUID(aV),153285)or string.find(UnitGUID(aV),31146)or string.find(UnitGUID(aV),176581)or string.find(UnitGUID(aV),179124)or string.find(UnitGUID(aV),179010)or string.find(UnitGUID(aV),180323)or string.find(UnitGUID(aV),179010)or string.find(UnitGUID(aV),179942)or string.find(UnitGUID(aV),176521)or string.find(UnitGUID(aV),177594)or string.find(UnitGUID(aV),177117)or string.find(UnitGUID(aV),176581)or string.find(UnitGUID(aV),180840)or string.find(UnitGUID(aV),176605)or UnitName(aV)=="Glacial Spike"or string.find(UnitGUID(aV),180473)or string.find(UnitGUID(aV),180474)or string.find(UnitGUID(aV),176929)or string.find(UnitGUID(aV),176920)or string.find(UnitGUID(aV),177154)or string.find(UnitGUID(aV),177787)or string.find(UnitGUID(aV),177889)or string.find(UnitGUID(aV),177891)or string.find(UnitGUID(aV),177892)or string.find(UnitGUID(aV),168326)then aW=aW+1 end end end end;if not m()then S=1;T=1;aW=1 end;if v then T=10;S=10 end;U=ar(R)V=aw(R)if not BotOn then W=0;X=0 end;if W>0 then W=0 end;if X>0 then X=0 end;N=aQ()if j(200174):IsAvailable()then ak=j(200174)else ak=j(34433)end;if l.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+l.GUISettings.General.OpenerReset elseif l.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]l.ToggleIconFrame:UpdateButtonText(6)l.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if w and E.MassDispell:IsUsableP()and E.MassDispell:CooldownRemains(BypassRecovery)<=0 then if l.Cast(E.MassDispell,nil,nil,nil)then X=327830;return"queue RingOfPeace"end elseif(not E.MassDispell:IsUsableP()or E.MassDispell:CooldownRemains(BypassRecovery)>0)and w then HeroRotationCharDB.Toggles[61]=not HeroRotationCharDB.Toggles[61]l.Print("Mass Dispel Queue is now "..(HeroRotationCharDB.Toggles[61]and"|cff00ff00on|r."or"|cffff0000off|r."))end;local aY=select(1,UnitCastingInfo("player"))if C~=0 and C<0.5 and(g:IsChanneling(E.MindSear)or g:IsChanneling(E.MindFlay))then if o(E.Pool,nil)then X=1999;return"Quaking Stope"end end;if g:IsDeadOrGhost()then X=999 end;if g:IsChanneling(j(355321))then if o(E.Pool,nil)then X=999;return"Trinket Channel"end end;if E.Shadowform:IsCastable()and g:BuffDown(E.ShadowformBuff)then if o(E.Shadowform,nil)then X=232698;return"shadowform 4"end end;if E.PowerWordShield:IsCastable()and g:DebuffDown(E.WeakenedSoul)and not g:IsChanneling()and not g:IsCasting()and(a1.Shadow.PWS=="Moving"and g:IsMoving()or a1.Shadow.PWS=="Always"or a1.Shadow.PWS=="OOC Moving"and g:IsMoving()and not g:AffectingCombat())then if o(E.PowerWordShield,nil)then X=17;return"PW:S Settings"end end;if g:IsChanneling(E.VoidTorrent)then local N=aO()if N then return N end;if o(E.Pool,nil)then X=99999;return"channeling 4"end end;if g:IsChanneling(j(324631))then if g:AffectingCombat()and a1.Shadow.CastCancelFC then X=1999 elseif l.CastAnnotated(E.Pool,false,"WAIT")then X=99999;return"Pool During Fleshcraft"end end;a8=2;if not g:AffectingCombat()and(s or a1.Commons.DBMSupport and l.BossMods:GetPullTimer()<_+g:GCD()and l.BossMods:GetPullTimer()>0)and a0.TargetIsValid()and not g:IsMoving()then local N=aJ()if N then return N end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if E.ShadowWordDeath:IsCastable()then if o(E.ShadowWordDeath,nil)then W=1136149;return"explosive MO SWD"end end;if E.ShadowWordPain:IsCastable()then if o(E.ShadowWordPain,nil)then W=1589;return"explosive MO SWP"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if E.ShadowWordDeath:IsCastable()then if o(E.ShadowWordDeath,nil)then X=136149;return"explosive  SWD"end end;if E.ShadowWordPain:IsCastable()then if o(E.ShadowWordPain,nil)then X=589;return"explosive  SWP"end end end;if a0.TargetIsValid()and g:AffectingCombat()and(h:AffectingCombat()or h:IsDummy()or h:NPCID()==153285 or h:NPCID()==168326 or h:NPCID()==176581 or h:NPCID()==176920 or h:NPCID()==177892)and not g:IsDeadOrGhost()then Z=d.FightRemains(R,false)if h:IsDummy()or h:NPCID()==153285 or h:NPCID()==168326 or h:NPCID()==176581 or h:NPCID()==176920 then Z=99999999999 end;a4=d.CombatTime()a5=Z+a4;if E.Dispersion:IsCastable()and g:HealthPercentage()<a1.Shadow.DispersionHP then if o(E.Dispersion,nil)then X=47585;return"dispersion low_hp"end end;if E.DesperatePrayer:IsCastable()and g:HealthPercentage()<a1.Shadow.DesperatePrayerHP then if o(E.DesperatePrayer,nil)then X=19236;return"DesperatePrayer low_hp"end end;if F.PotionofPhantomFire:IsReady()and a1.Commons.Enabled.Potions and t and(g:BuffUp(E.VoidformBuff)or g:BuffUp(E.PowerInfusionBuff))then if o(F.PotionofPhantomFire,nil,nil)then X=50;return"potion_of_phantomfire 2"end end;if F.PotionofSpectralIntellect:IsReady()and a1.Commons.Enabled.Potions and t and(g:BuffUp(E.VoidformBuff)or g:BuffUp(E.PowerInfusionBuff))then if o(F.PotionofSpectralIntellect,nil,nil)then X=50;return"potion_of_spectral_intellect 2"end end;a6=ao(h,false)a7=ao(h,true)a9=T>2+al(g:BuffUp(E.VoidformBuff))aa=not SpheresHarmonyEquipped and(CovenantID~=4 or(a5>=330 and a4<=200 or a5<=250 and a5>=200))or E.PowerInfusion:CooldownRemains()<g:GCD()*3 and x or(g:BuffUp(E.PowerInfusionBuff)or Z<=25)ab=aW;if E.SearingNightmare:IsAvailable()and aW==7 then ab=5+2*al(aa and E.VoidEruption:CooldownRemains()<=10 and E.HungeringVoid:IsAvailable())end;if E.SearingNightmare:IsAvailable()and T>=7 then ab=0 end;if E.SearingNightmare:IsAvailable()and aW>4 then ab=4 end;if E.SearingNightmare:IsAvailable()and aW>=8 and not E.ShadowCrash:IsAvailable()then ab=0 end;if g:BuffUp(E.VoidformBuff)then ab=al(aW<=5)*aW end;ac=0;if h:TimeToDie()>=18 then ac=1 end;ad=E.VampiricTouchDebuff:AuraActiveCount()>=ab or not ac;ae=E.VoidEruption:CooldownUp()and aa and y and x;if n()then if E.Fireblood:IsCastable()and g:BuffUp(E.VoidformBuff)then if o(E.Fireblood,nil)then X=265221;return"fireblood 22"end end;if E.Berserking:IsCastable()and g:BuffUp(E.VoidformBuff)then if o(E.Berserking,nil)then X=26297;return"berserking 24"end end;if E.LightsJudgment:IsCastable()and T>=2 then if o(E.LightsJudgment,nil,nil,not h:IsSpellInRange(E.LightsJudgment))then X=255647;return"lights_judgment 26"end end;if E.AncestralCall:IsCastable()and g:BuffUp(E.VoidformBuff)then if o(E.AncestralCall,nil)then X=274738;return"ancestral_call 28"end end;if E.BagofTricks:IsCastable()then if o(E.BagofTricks,nil,nil,not h:IsSpellInRange(E.BagofTricks))then X=312411;return"bag_of_tricks 30"end end end;if true then local N=aO()if N then return N end end;if true then local N=aP()if N then return N end end end;if a0.TargetIsValid()and not UnitIsFriend("target","player")and g:AffectingCombat()and(not h:AffectingCombat()and not h:IsDummy()and h:NPCID()~=153285)and not u then W=999 end end;local function aZ()E.VampiricTouchDebuff:RegisterAuraTracking()end;function ReturnSpell()if X==0 then return 0 else return X end end;function ReturnSpellMO()if W==0 then return 0 else return W end end;l.SetAPL(258,aS,aZ)