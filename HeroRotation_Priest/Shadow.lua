local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Target;local i=f.Pet;local j=d.Spell;local k=d.Item;local l=HeroRotation;local m=l.AoEON;local n=l.CDsON;local o=l.Cast;local p=l.CastSuggested;local q=HeroRotationCharDB.Toggles[4]local r=HeroRotationCharDB.Toggles[5]local s=HeroRotationCharDB.Toggles[6]local t=not HeroRotationCharDB.Toggles[15]local u=HeroRotationCharDB.Toggles[12]local v=HeroRotationCharDB.Toggles[60]local w=HeroRotationCharDB.Toggles[61]local x=HeroRotationCharDB.Toggles[62]local y=false;local z=false;local A=false;local B=false;local C=false;local D=0;local E=math.min;local F=j.Priest.Shadow;local G=k.Priest.Shadow;local H={G.ArchitectsIngenuityCore:ID(),G.EmpyrealOrdinance:ID(),G.InscrutableQuantumDevice:ID(),G.MacabreSheetMusic:ID(),G.ShadowedOrbofTorment:ID(),G.SinfulGladiatorsBadgeofFerocity:ID(),G.SoullettingRuby:ID(),G.TheFirstSigil:ID(),G.ScarsofFraternalStrife:ID()}local I=g:GetEquipment()local J=k(0)local K=k(0)local L,M=GetInventoryItemID("player",13)local N,M=GetInventoryItemID("player",14)if I[13]then J=k(I[13])end;if I[14]then K=k(I[14])end;local O;local P,Q,R,S;local T,U;local V;local W;local X=0;local Y=0;local Z=0;local _;local a0;local a1=l.Commons.Everyone;local a2={General=l.GUISettings.General,Commons=l.GUISettings.APL.Priest.Commons,Shadow=l.GUISettings.APL.Priest.Shadow}local a3=0;local a4=0;local a5=0;local _=0;local a6=0;local a7=false;local a8=false;local a9=1;local aa=false;local ab=false;local ac=false;local ad=false;local ae=0;local af=false;local ag=2;local ah=g:HasLegendaryEquipped(202)local ai=g:HasLegendaryEquipped(161)local aj=g:HasLegendaryEquipped(158)local ak=g:HasLegendaryEquipped(159)local al=j(200174)d:RegisterForEvent(function()a7=false;a8=false;a9=1;aa=false;af=false end,"PLAYER_REGEN_ENABLED")local am=g:CovenantID()d:RegisterForEvent(function()am=g:CovenantID()end,"COVENANT_CHOSEN")d:RegisterForEvent(function()ah=g:HasLegendaryEquipped(202)ai=g:HasLegendaryEquipped(161)aj=g:HasLegendaryEquipped(158)ak=g:HasLegendaryEquipped(159)end,"PLAYER_EQUIPMENT_CHANGED")d:RegisterForEvent(function()F.ShadowCrash:RegisterInFlight()end,"LEARNED_SPELL_IN_TAB")F.ShadowCrash:RegisterInFlight()local function an(ao)if ao then return 1 else return 0 end end;local function ap(ao)return ao~=0 end;local function aq(ar,as)if as then return ar:DebuffUp(F.ShadowWordPainDebuff)and(ar:DebuffUp(F.VampiricTouchDebuff)or ar:TimeToDie()<18)and ar:DebuffUp(F.DevouringPlagueDebuff)else return ar:DebuffUp(F.ShadowWordPainDebuff)and(ar:DebuffUp(F.VampiricTouchDebuff)or ar:TimeToDie()<18)end end;local function at(au)local av=0;if au~=nil then for aw in pairs(au)do local ax=au[aw]if ax:DebuffDown(F.ShadowWordPainDebuff)then av=av+1 end end end;return av end;local function ay(au)local az=0;if au~=nil then for aw in pairs(au)do local ax=au[aw]if ax:DebuffRefreshable(F.ShadowWordPainDebuff)then az=az+1 end end end;return az end;local function aA(aB)if(aB:DebuffRefreshable(F.VampiricTouchDebuff)or aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffDown(F.MindDevourerBuff)and g:Insanity()<50)and(g:BuffStack(F.DarkThoughtBuff)<ag or not g:HasTier(28,2))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then X=1136149;return true elseif(aB:DebuffRefreshable(F.VampiricTouchDebuff)or aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffDown(F.MindDevourerBuff)and g:Insanity()<50)and(g:BuffStack(F.DarkThoughtBuff)<ag or not g:HasTier(28,2))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;if X==999 then starttime=GetTime()endtime=starttime+0.25 elseif X>0 and endtime~=nil and GetTime()>endtime then X=0 end;return true elseif(aB:DebuffRefreshable(F.VampiricTouchDebuff)or aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffDown(F.MindDevourerBuff)and g:Insanity()<50)and(g:BuffStack(F.DarkThoughtBuff)<ag or not g:HasTier(28,2))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then Y=136149;return true elseif(aB:DebuffRefreshable(F.VampiricTouchDebuff)or aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffDown(F.MindDevourerBuff)and g:Insanity()<50)and(g:BuffStack(F.DarkThoughtBuff)<ag or not g:HasTier(28,2))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aC(aB)if(aB:HealthPercentage()<20 and U<4 or F.Mindbender:TimeSinceLastCast()<=15 and ak and U<=7)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then X=1136149;return true elseif(aB:HealthPercentage()<20 and U<4 or F.Mindbender:TimeSinceLastCast()<=15 and ak and U<=7)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;if X==999 then starttime=GetTime()endtime=starttime+0.25 elseif X>0 and endtime~=nil and GetTime()>endtime then X=0 end;return true elseif(aB:HealthPercentage()<20 and U<4 or F.Mindbender:TimeSinceLastCast()<=15 and ak)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then Y=136149;return true elseif(aB:HealthPercentage()<20 and U<4 or F.Mindbender:TimeSinceLastCast()<=15 and ak)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aD(aB)if aB:TimeToDie()<20 and g:BuffDown(F.VoidformBuff)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then X=1319952;return true elseif aB:TimeToDie()<20 and g:BuffDown(F.VoidformBuff)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;if X==999 then starttime=GetTime()endtime=starttime+0.25 elseif X>0 and endtime~=nil and GetTime()>endtime then X=0 end;return true elseif aB:TimeToDie()<20 and g:BuffDown(F.VoidformBuff)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then Y=319952;return true elseif aB:TimeToDie()<20 and g:BuffDown(F.VoidformBuff)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aE(aB)if(aq(aB,false)and aB:TimeToDie()>=18 and((aB:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0)or F.Misery:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then X=1263165;return true elseif(aq(aB,false)and aB:TimeToDie()>=18 and((aB:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0)or F.Misery:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;if X==999 then starttime=GetTime()endtime=starttime+0.25 elseif X>0 and endtime~=nil and GetTime()>endtime then X=0 end;return true elseif(aq(aB,false)and aB:TimeToDie()>=18 and((aB:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0)or F.Misery:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then Y=263165;return true elseif(aq(aB,false)and aB:TimeToDie()>=18 and((aB:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0)or F.Misery:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aF(aB)if(aB:DebuffRefreshable(F.VampiricTouchDebuff)and(aB:TimeToDie()>18 or aB:IsDummy()or aB:NPCID()==153285)and(aB:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0 or F.Misery:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then X=134914;return true elseif(aB:DebuffRefreshable(F.VampiricTouchDebuff)and(aB:TimeToDie()>18 or aB:IsDummy()or aB:NPCID()==153285)and(aB:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0 or F.Misery:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;if X==999 then starttime=GetTime()endtime=starttime+0.25 elseif X>0 and endtime~=nil and GetTime()>endtime then X=0 end;return true elseif(aB:DebuffRefreshable(F.VampiricTouchDebuff)and(aB:TimeToDie()>18 or aB:IsDummy()or aB:NPCID()==153285)and(aB:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0 or F.Misery:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then Y=34914;return true elseif(aB:DebuffRefreshable(F.VampiricTouchDebuff)and(aB:TimeToDie()>18 or aB:IsDummy()or aB:NPCID()==153285)and(aB:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0 or F.Misery:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aG(aB)if aB:DebuffRefreshable(F.ShadowWordPainDebuff)and aB:TimeToDie()>4 and not F.Misery:IsAvailable()and not(F.SearingNightmare:IsAvailable()and U>a9)and(not F.PsychicLink:IsAvailable()or F.PsychicLink:IsAvailable()and U<=2)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then X=1589;return true elseif aB:DebuffRefreshable(F.ShadowWordPainDebuff)and aB:TimeToDie()>4 and not F.Misery:IsAvailable()and not(F.SearingNightmare:IsAvailable()and U>a9)and(not F.PsychicLink:IsAvailable()or F.PsychicLink:IsAvailable()and U<=2)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;if X==999 then starttime=GetTime()endtime=starttime+0.25 elseif X>0 and endtime~=nil and GetTime()>endtime then X=0 end;return true elseif aB:DebuffRefreshable(F.ShadowWordPainDebuff)and aB:TimeToDie()>4 and not F.Misery:IsAvailable()and not(F.SearingNightmare:IsAvailable()and U>a9)and(not F.PsychicLink:IsAvailable()or F.PsychicLink:IsAvailable()and U<=2)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then Y=589;return true elseif aB:DebuffRefreshable(F.ShadowWordPainDebuff)and aB:TimeToDie()>4 and not F.Misery:IsAvailable()and not(F.SearingNightmare:IsAvailable()and U>a9)and(not F.PsychicLink:IsAvailable()or F.PsychicLink:IsAvailable()and U<=2)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aH(aB)if F.SearingNightmare:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)and U>2 and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then X=148045;return true elseif F.SearingNightmare:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)and U>2 and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;if X==999 then starttime=GetTime()endtime=starttime+0.25 elseif X>0 and endtime~=nil and GetTime()>endtime then X=0 end;return true elseif F.SearingNightmare:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)and U>2 and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then Y=48045;return true elseif F.SearingNightmare:IsAvailable()and aB:DebuffRefreshable(F.ShadowWordPainDebuff)and U>2 and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aI(aB)if g:Insanity()<90 and(aq(aB,true)and(not F.VoidEruption:CooldownUp()or not z or not F.HungeringVoid:IsAvailable())or g:BuffUp(F.VoidformBuff))and(not F.HungeringVoid:IsAvailable()or aB:DebuffUp(F.HungeringVoidDebuff)or g:BuffDown(F.VoidformBuff))and(not F.SearingNightmare:IsAvailable()or U<5)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then X=1323673;return true elseif g:Insanity()<90 and(aq(aB,true)and(not F.VoidEruption:CooldownUp()or not z or not F.HungeringVoid:IsAvailable())or g:BuffUp(F.VoidformBuff))and(not F.HungeringVoid:IsAvailable()or aB:DebuffUp(F.HungeringVoidDebuff)or g:BuffDown(F.VoidformBuff))and(not F.SearingNightmare:IsAvailable()or U<5)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;if X==999 then starttime=GetTime()endtime=starttime+0.25 elseif X>0 and endtime~=nil and GetTime()>endtime then X=0 end;return true elseif g:Insanity()<90 and(aq(aB,true)and(not F.VoidEruption:CooldownUp()or not z or not F.HungeringVoid:IsAvailable())or g:BuffUp(F.VoidformBuff))and(not F.HungeringVoid:IsAvailable()or aB:DebuffUp(F.HungeringVoidDebuff)or g:BuffDown(F.VoidformBuff))and(not F.SearingNightmare:IsAvailable()or U<5)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then Y=323673;return true elseif g:Insanity()<90 and(aq(aB,true)and(not F.VoidEruption:CooldownUp()or not z or not F.HungeringVoid:IsAvailable())or g:BuffUp(F.VoidformBuff))and(not F.HungeringVoid:IsAvailable()or aB:DebuffUp(F.HungeringVoidDebuff)or g:BuffDown(F.VoidformBuff))and(not F.SearingNightmare:IsAvailable()or U<5)and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aJ(aB)return aB:HealthPercentage()end;local function aK(aB)if(g:BuffUp(F.PowerInfusionBuff)or not a2.Shadow.SelfPI or G.ShadowedOrbofTorment:IsEquipped())and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==f("mouseover"):GUID()and a2.Shadow.TargetSwap=="Mouseover"then if G.SoullettingRuby:ID()==GetInventoryItemID("player",13)then X=241;return true elseif G.SoullettingRuby:ID()==GetInventoryItemID("player",14)then X=251;return true end elseif(g:BuffUp(F.PowerInfusionBuff)or not a2.Shadow.SelfPI or G.ShadowedOrbofTorment:IsEquipped())and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and a2.Shadow.TargetSwap=="AutoSwap"and aB:GUID()~=h:GUID()and not u then X=999;return true elseif(g:BuffUp(F.PowerInfusionBuff)or not a2.Shadow.SelfPI or G.ShadowedOrbofTorment:IsEquipped())and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)and aB:GUID()==h:GUID()then if G.SoullettingRuby:ID()==GetInventoryItemID("player",13)then X=241;return true elseif G.SoullettingRuby:ID()==GetInventoryItemID("player",14)then X=251;return true end elseif(g:BuffUp(F.PowerInfusionBuff)or not a2.Shadow.SelfPI or G.ShadowedOrbofTorment:IsEquipped())and(aB:AffectingCombat()or aB:IsDummy()or aB:NPCID()==153285 or aB:NPCID()==168326)then return true end end;local function aL()if a1.TargetIsValid()and not g:IsDeadOrGhost()and not g:AffectingCombat()and(s or a2.Commons.DBMSupport and l.BossMods:GetPullTimer()<a0+g:GCD()and l.BossMods:GetPullTimer()>0)and not g:IsMoving()then if F.Fleshcraft:IsCastable()and(D==0 or D>F.Fleshcraft:ExecuteTime())and q and not g:IsMoving()and(F.PustuleEruption:SoulbindEnabled()or F.VolatileSolvent:SoulbindEnabled())then if o(F.Fleshcraft,nil,nil)then Y=324631;return"fleshcraft precombat 1"end end;if F.ArcaneTorrent:IsCastable()and n()then if o(F.ArcaneTorrent,nil,nil,not h:IsSpellInRange(F.ArcaneTorrent))then Y=28730;return"arcane_torrent 6"end end;if(a2.Commons.Enabled.TopTrinket or a2.Commons.Enabled.BottomTrinket)and G.ShadowedOrbofTorment:IsEquippedAndReady()and(D==0 or D>2)then if o(G.ShadowedOrbofTorment,nil,nil)then if G.ShadowedOrbofTorment:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.ShadowedOrbofTorment:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;a9=2;if F.VampiricTouch:IsCastable()and(D==0 or D>F.VampiricTouch:CastTime()+0.5)and not F.Damnation:IsAvailable()then if o(F.VampiricTouch,nil,nil,not h:IsSpellInRange(F.VampiricTouch))then Y=34914;return"vampiric_touch 10"end end;if F.MindBlast:IsReady()and(D==0 or D>F.MindBlast:CastTime()+0.5)and F.Damnation:IsAvailable()then if o(F.MindBlast,nil,nil,not h:IsSpellInRange(F.MindBlast))then Y=8092;return"mind_blast 11"end end;if F.MindBlast:IsCastable()and(D==0 or D>F.MindBlast:CastTime()+0.5)and(F.Misery:IsAvailable()and(not ai or not F.VoidTorrent:IsAvailable()))then if o(F.MindBlast,nil,nil,not h:IsSpellInRange(F.MindBlast))then Y=8092;return"mind_blast 12"end end;if F.VoidTorrent:IsCastable()and(D==0 or D>3+0.5)and A and(F.Misery:IsAvailable()and ai)then if o(F.VoidTorrent,nil,nil,not h:IsSpellInRange(F.VoidTorrent))then Y=263165;return"void_torrent 14"end end;if F.MindFlay:IsCastable()and(D==0 or D>1)and not g:IsChanneling(F.MindFlay)and U<=a9 and(F.Misery:IsAvailable()and ai and not F.VoidTorrent:IsAvailable())then if o(F.MindFlay,nil,nil,not h:IsSpellInRange(F.MindFlay))then Y=15407;return"mind_flay 15"end end;if F.ShadowWordPain:IsCastable()and not F.Misery:IsAvailable()then if o(F.ShadowWordPain,nil,nil,not h:IsSpellInRange(F.ShadowWordPain))then Y=589;return"shadow_word_pain 16"end end end end;local function aM()if G.ScarsofFraternalStrife:IsEquippedAndReady()and(g:BuffDown(F.ScarsofFraternalStrifeBuff4)and a5>1 or(g:BuffUp(F.VoidformBuff)or g:BuffUp(F.PowerInfusionBuff)or F.VoidEruption:CooldownRemains()>10))then if o(G.ScarsofFraternalStrife,nil,nil)then if G.ScarsofFraternalStrife:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.ScarsofFraternalStrife:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if G.EmpyrealOrdinance:IsEquippedAndReady()and(F.VoidEruption:CooldownRemains()<=12 and z or(F.VoidEruption:CooldownRemains()>27 or not z))then if o(G.EmpyrealOrdinance,nil,nil,not h:IsInRange(40))then if G.EmpyrealOrdinance:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.EmpyrealOrdinance:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if G.InscrutableQuantumDevice:IsEquippedAndReady()and(g:BuffUp(F.VoidformBuff)and g:BuffUp(F.PowerInfusionBuff)or d.BossFilteredFightRemains("<=",20)or g:BuffUp(F.PowerInfusionBuff)and(d.BossFilteredFightRemains("<",F.VoidEruption:CooldownRemains()+15)or not z)or g:BuffUp(F.VoidformBuff)and(d.BossFilteredFightRemains("<",F.PowerInfusion:CooldownRemains()+15)or not y)or(F.PowerInfusion:CooldownRemains()>=10 or not y)and(F.VoidEruption:CooldownRemains()>=10 or not z)and d.BossFilteredFightRemains(">=",190))then if o(G.InscrutableQuantumDevice,nil,nil)then if G.InscrutableQuantumDevice:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.InscrutableQuantumDevice:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if G.MacabreSheetMusic:IsEquippedAndReady()and(F.VoidEruption:CooldownRemains()>10 or not z)then if o(G.MacabreSheetMusic,nil,nil)then if G.MacabreSheetMusic:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.MacabreSheetMusic:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if G.SoullettingRuby:IsEquippedAndReady()and(g:BuffUp(F.PowerInfusionBuff)or not a2.Shadow.SelfPI or G.ShadowedOrbofTorment:IsEquipped())then if o(G.SoullettingRuby,nil,nil)then if G.SoullettingRuby:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.SoullettingRuby:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if G.TheFirstSigil:IsEquippedAndReady()and(g:BuffUp(F.VoidformBuff)or g:BuffUp(F.PowerInfusionBuff)or not a2.Shadow.SelfPI or F.VoidEruption:CooldownRemains()>10 or G.SoullettingRuby:IsEquipped()and not G.SoullettingRuby:IsReady()or _<20)then if o(G.TheFirstSigil,nil,nil)then if G.TheFirstSigil:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.TheFirstSigil:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if G.SinfulGladiatorsBadgeofFerocity:IsEquippedAndReady()and(F.VoidEruption:CooldownRemains()>=10 or not z)then if o(G.SinfulGladiatorsBadgeofFerocity,nil,nil)then if G.SinfulGladiatorsBadgeofFerocity:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.SinfulGladiatorsBadgeofFerocity:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if G.ShadowedOrbofTorment:IsEquippedAndReady()and(D==0 or D>2.5)and(F.PowerInfusion:CooldownRemains()<=10 and y and F.VoidEruption:CooldownRemains()<=10 and z and(am==4 or am==1)or(am==2 or am==3)and(g:BuffDown(F.VoidformBuff)or g:PrevGCD(1,F.VoidBolt)))then if o(G.ShadowedOrbofTorment,nil,nil)then if G.ShadowedOrbofTorment:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.ShadowedOrbofTorment:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if G.ArchitectsIngenuityCore:IsEquippedAndReady()then if o(G.ArchitectsIngenuityCore,nil,nil,not h:IsInRange(30))then if G.ArchitectsIngenuityCore:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif G.ArchitectsIngenuityCore:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end;if g:BuffUp(F.VoidformBuff)or g:BuffUp(F.PowerInfusionBuff)or(F.VoidEruption:CooldownRemains()>10 or not z)then local aN=g:GetUseableTrinkets(H)if aN then if o(aN,nil,nil)then if aN:ID()==L and a2.Commons.Enabled.TopTrinket then Y=24;return"top trinket 1"elseif aN:ID()==N and a2.Commons.Enabled.BottomTrinket then Y=30;return"top trinket 2"end end end end end;local function aO()if F.PowerInfusion:IsCastable()and y and not g:IsMoving()and(a2.Shadow.SelfPI and(g:BuffUp(F.VoidformBuff)or g:Covenant()~="Kyrian"and g:Covenant()~="Necrolord"and(F.VoidEruption:CooldownRemains()>=10 or not z)or _<F.VoidEruption:CooldownRemains()or not z)and(_>=F.VoidEruption:CooldownRemains()+15 and z and(F.VoidEruption:CooldownRemains()<=g:GCD()*4 and z)or _>F.PowerInfusion:Cooldown()and y or(_<F.VoidEruption:CooldownRemains()+15 or not z)or am==1 or g:BloodlustUp()))then if o(F.PowerInfusion,nil)then Y=10060;return"power_infusion 50"end end;if F.FaeGuardians:IsReady()and q and(g:BuffDown(F.VoidformBuff)and(not F.VoidTorrent:CooldownUp()or not A or not F.VoidTorrent:IsAvailable())and(a7 and U==1 or ae and U>1)or g:BuffUp(F.VoidformBuff)and(F.GroveInvigoration:IsAvailable()or F.FieldofBlossoms:IsAvailable()))then if o(F.FaeGuardians,nil)then Y=327661;return"fae_guardians 52"end end;if F.Mindgames:IsReady()and(D==0 or D>F.Mindgames:CastTime()+0.5)and not g:IsMoving()and q then if g:Insanity()<90 and(aq(h,true)and(not F.VoidEruption:CooldownUp()or not z or not F.HungeringVoid:IsAvailable())or g:BuffUp(F.VoidformBuff))and(not F.HungeringVoid:IsAvailable()or h:DebuffRemains(F.HungeringVoidDebuff)>F.Mindgames:CastTime()or g:BuffDown(F.VoidformBuff))and(not F.SearingNightmare:IsAvailable()or U<5)then if o(F.Mindgames,nil,nil,not h:IsSpellInRange(F.Mindgames))then Y=323673;return"mindgames 54"end end end;if F.UnholyNova:IsReady()and q and(not F.HungeringVoid:IsAvailable()and a7 or h:DebuffUp(F.HungeringVoidDebuff)and g:BuffUp(F.VoidformBuff)or(F.VoidEruption:CooldownRemains()>10 or not z or not af)and g:BuffDown(F.VoidformBuff))then if o(F.UnholyNova,nil,nil,not h:IsSpellInRange(F.UnholyNova))then Y=324724;return"Shadow_nova 56"end end;if F.BoonoftheAscended:IsCastable()and(D==0 or D>F.BoonoftheAscended:CastTime()+0.5)and q and(g:BuffDown(F.VoidformBuff)and(not F.VoidEruption:CooldownUp()or not z)and U>1 and not F.SearingNightmare:IsAvailable()or g:BuffUp(F.VoidformBuff)and U<2 and not F.SearingNightmare:IsAvailable()and(g:PrevGCD(1,F.VoidBolt)and(not G.EmpyrealOrdinance:IsEquipped()or not F.HungeringVoid:IsAvailable())or G.EmpyrealOrdinance:IsEquipped()and G.EmpyrealOrdinance:CooldownRemains()<=162 and h:DebuffUp(F.HungeringVoidDebuff))or g:BuffUp(F.VoidformBuff)and F.SearingNightmare:IsAvailable())then if o(F.BoonoftheAscended,nil)then Y=325013;return"boon_of_the_ascended 58"end end;if true then local O=aM()if O then return O end end;if F.Fleshcraft:IsCastable()and q and(D==0 or D>g:GCD()*1.25)and a2.Shadow.CastCancelFC and(F.VolatileSolvent:SoulbindEnabled()and g:BuffRemains(F.VolatileSolventHumanBuff)<10 and g:BuffDown(F.VoidformBuff)and g:BuffDown(F.PowerInfusionBuff))then if o(F.Fleshcraft,nil,nil)then Y=324631;return"fleshcraft 60"end end end;local function aP()if F.AscendedBlast:IsReady()and U<=3 then if o(F.AscendedBlast,nil,nil,not h:IsSpellInRange(F.AscendedBlast))then Y=235283;return"ascended_blast 70"end end;if F.AscendedNova:IsReady()and(#P>1 and U>1+an(F.SearingNightmare:IsAvailable()))then if o(F.AscendedNova,nil,nil,not h:IsInRange(8))then Y=325020;return"ascended_nova 72"end end end;local function aQ()if F.MindBlast:IsCastable()and g:IsChanneling()then if g:HasTier(28,4)and g:BuffUp(F.DarkThoughtBuff)and F.Mindbender:TimeSinceLastCast()<15 and ak and g:BuffDown(F.VoidformBuff)and g:BuffRemains(F.LivingShadowBuff)<_ or g:BuffUp(F.DarkThoughtBuff)and g:BuffRemains(F.LivingShadowBuff)<g:GCD()*(3+an(g:BuffDown(F.VoidformBuff))*16)and g:BuffRemains(F.LivingShadowBuff)<_ then if o(F.MindBlast,nil,nil,not h:IsSpellInRange(F.MindBlast))then Y=8092;return"mind_blast 84"end end end;if F.SearingNightmare:IsReady()and g:IsChanneling(F.MindSear)and(aa and not af or W>0 and U>1 or g:Insanity()>85)then if o(F.SearingNightmare,nil,nil,not h:IsInRange(40))then Y=341385;return"searing_nightmare 80"end end;if F.SearingNightmare:IsReady()and g:IsChanneling(F.MindSear)and(W>0 and U>2)then if o(F.SearingNightmare,nil,nil,not h:IsInRange(40))then Y=341385;return"searing_nightmare 82"end end;if F.MindBlast:IsCastable()and(g:BuffUp(F.DarkThoughtBuff)and g:IsChanneling())and not g:HasTier(28,4)then if o(F.MindBlast,nil,nil,not h:IsSpellInRange(F.MindBlast))then Y=8092;return"mind_blast 84"end end end;local function aR()if g:BuffUp(F.BoonoftheAscendedBuff)then local O=aP()if O then return O end end;if F.VoidBolt:CooldownUp()and g:BuffUp(F.DissonantEchoesBuff)then if o(F.VoidBolt,nil,nil,not h:IsInRange(40))then Y=214771;return"void_bolt 90"end end;if F.VoidEruption:IsReady()and(D==0 or D>F.VoidEruption:CastTime()+0.5)and z and not g:IsMoving()and(af and(g:Insanity()>=25+15*an(g:Race()=="BloodElf"and a5<30)or F.Mindbender:TimeSinceLastCast()<=15 and ak and(not F.MindBlast:CooldownUp()or g:IsCasting(F.MindBlast))and not F.ShadowWordDeath:CooldownUp())and(g:Insanity()<=85 or F.SearingNightmare:IsAvailable()and aa))then if o(F.VoidEruption,nil,nil,not h:IsSpellInRange(F.VoidEruption))then Y=228260;return"void_eruption 92"end end;if F.ShadowWordPain:IsCastable()and(g:BuffUp(F.FaeGuardiansBuff)and h:DebuffDown(F.WrathfulFaerieDebuff)and U<4)then if F.Misery:IsAvailable()and h:TimeToDie()>=18 then if o(F.VampiricTouch,nil,nil,not h:IsSpellInRange(F.VampiricTouch))then Y=34914;return"vampiric_touch 94"end else if o(F.ShadowWordPain,nil,nil,not h:IsSpellInRange(F.ShadowWordPain))then Y=589;return"shadow_word_pain 94"end end end;if F.MindSear:IsCastable()and(D==0 or D>1)and not g:IsMoving()and not g:IsChanneling(F.MindSear)and(F.SearingNightmare:IsAvailable()and U>a9 and V>0 and(not al:CooldownUp()or not C)and U>=4)then if o(F.MindSear,nil,nil,not h:IsSpellInRange(F.MindSear))then Y=48045;return"mind_sear 97"end end;if true then local O=aO()if O then return O end end;if F.MindSear:IsCastable()and(D==0 or D>1)and not g:IsMoving()and not g:IsChanneling(F.MindSear)and(F.SearingNightmare:IsAvailable()and U>a9 and V>0 and(not al:CooldownUp()or not C))then if o(F.MindSear,nil,nil,not h:IsSpellInRange(F.MindSear))then Y=48045;return"mind_sear 97"end end;if F.Damnation:IsCastable()then if a1.CastCycle(F.Damnation,R,aA,not h:IsSpellInRange(F.Damnation))then Y=341374;return"damnation 98"end end;if F.ShadowWordDeath:IsReady()and F.Mindbender:TimeSinceLastCast()<=15 and ak and 15-F.Mindbender:TimeSinceLastCast()<=g:GCD()+0.5 and U<=7 then if o(F.ShadowWordDeath,nil,nil,not h:IsSpellInRange(F.ShadowWordDeath))then Y=136149;return"shadow_word_death 99"end end;if F.MindBlast:IsCastable()and(D==0 or D>F.MindBlast:CastTime()+0.5)and(not g:IsMoving()or g:BuffUp(F.DarkThoughtBuff))and(F.MindBlast:CastTime()<F.VoidBolt:CooldownRemains()or g:BuffUp(F.DarkThoughtBuff)and F.VoidBolt:CooldownRemains()>g:GCD()*1.1 or g:BuffDown(F.VoidformBuff))and(F.MindBlast:Charges()>1 and(h:DebuffUp(F.HungeringVoidDebuff)or not F.HungeringVoid:IsAvailable())or 15-F.Mindbender:TimeSinceLastCast()<=F.MindBlast:CastTime()+g:GCD()and F.Mindbender:TimeSinceLastCast()<=15 and ak and 15-F.Mindbender:TimeSinceLastCast()>F.MindBlast:CastTime()and U<=7 or g:BuffUp(F.DarkThoughtBuff)and g:BuffUp(F.VoidformBuff)and not F.VoidBolt:CooldownUp()and(not ak or F.Mindbender:TimeSinceLastCast()>15)and g:HasTier(28,4))then if o(F.MindBlast,nil,nil,not h:IsSpellInRange(F.MindBlast))then Y=8092;return"mind_blast 100"end end;if F.VoidBolt:IsCastable()and(U<4 or F.HungeringVoid:IsAvailable()and U<=6)and(g:Insanity()<=85 and F.HungeringVoid:IsAvailable()and F.SearingNightmare:IsAvailable()and U<=6 or(F.HungeringVoid:IsAvailable()and not F.SearingNightmare:IsAvailable()or U==1))then if o(F.VoidBolt,nil,nil,not h:IsInRange(40))then Y=214771;return"void_bolt 101"end end;if F.DevouringPlague:IsReady()and(g:HasTier(28,4)or F.HungeringVoid:IsAvailable())and F.SearingNightmare:IsAvailable()and F.Mindbender:TimeSinceLastCast()<=15 and ak and g:BuffUp(F.VoidformBuff)and U<=6 then if o(F.DevouringPlague,nil,nil,not h:IsSpellInRange(F.DevouringPlague))then Y=335467;return"devouring_plague 102"end end;if F.DevouringPlague:IsReady()and((h:DebuffRefreshable(F.DevouringPlagueDebuff)or g:Insanity()>75 or U>3 and F.Misery:IsAvailable()or F.VoidTorrent:IsAvailable()and F.VoidTorrent:CooldownRemains()<=3*g:GCD()and A)and(not af or g:Insanity()>=85)and(not F.SearingNightmare:IsAvailable()or F.SearingNightmare:IsAvailable()and not aa))then if o(F.DevouringPlague,nil,nil,not h:IsSpellInRange(F.DevouringPlague))then Y=335467;return"devouring_plague 102"end end;if F.VoidBolt:IsCastable()and(U<4 or F.HungeringVoid:IsAvailable()and U<=6)and(U<4+an(F.DissonantEchoes:ConduitEnabled())and g:Insanity()<=85 and F.SearingNightmare:IsAvailable()or not F.SearingNightmare:IsAvailable())then if o(F.VoidBolt,nil,nil,not h:IsInRange(40))then Y=214771;return"void_bolt 103"end end;if F.ShadowWordDeath:IsReady()and h:IsSpellInRange(F.ShadowWordDeath)and(h:HealthPercentage()<20 and U<4 or F.Mindbender:TimeSinceLastCast()<=15 and ak and U<=7)then if o(F.ShadowWordDeath,nil)then Y=136149;return"shadow_word_death 104"end end;if F.ShadowWordDeath:IsReady()and U<4 then if a1.CastCycle(F.ShadowWordDeath,R,aC,not h:IsSpellInRange(F.ShadowWordDeath),nil)then return"shadow_word_death 104"end end;if F.SurrenderToMadness:IsCastable()then if a1.CastCycle(F.SurrenderToMadness,R,aD,not h:IsSpellInRange(F.SurrenderToMadness),a2.Shadow.OffGCDasOffGCD.SurrenderToMadness)then return"surrender_to_madness 106"end end;if F.VoidTorrent:IsCastable()and(D==0 or D>3+0.5)and A and not g:IsMoving()then if aq(h,false)and h:TimeToDie()>3 and(g:BuffDown(F.VoidformBuff)or g:BuffRemains(F.VoidformBuff)<F.VoidBolt:CooldownRemains()+0.5 or g:PrevGCD(1,F.VoidBolt)and 3<=F.VoidBolt:CooldownRemains()and not g:BloodlustUp()and U<3)and ae and U<5+6*an(F.TwistofFate:IsAvailable())then if o(F.VoidTorrent,nil)then Y=263165;return"void_torrent 107"end end end;if al:IsCastable()and C and(F.SearingNightmare:IsAvailable()and U>a9 or h:DebuffUp(F.ShadowWordPainDebuff))and ae then if o(F.Mindbender,nil,nil,not h:IsSpellInRange(F.Mindbender))then Y=200174;return"shadowfiend/mindbender 108"end end;if F.ShadowWordDeath:IsReady()and(aj and a7 and h:TimeToX(20)>F.ShadowWordDeath:Cooldown()+g:GCD())then if o(F.ShadowWordDeath,nil,nil,not h:IsSpellInRange(F.ShadowWordDeath))then Y=136149;return"shadow_word_death 112"end end;if F.ShadowCrash:IsCastable()and B then if o(F.ShadowCrash,nil,nil,not h:IsInRange(40))then Y=205385;return"shadow_crash 114"end end;if F.MindSear:IsCastable()and(D==0 or D>1)and not g:IsMoving()and not g:IsChanneling(F.MindSear)and(U>a9 and g:BuffUp(F.DarkThoughtBuff))then if o(F.MindSear,nil,nil,not h:IsSpellInRange(F.MindSear))then Y=48045;return"mind_sear 118"end end;if F.MindFlay:IsCastable()and(D==0 or D>1)and U<=a9 and not g:IsMoving()and not g:IsChanneling(F.MindFlay)and(g:BuffUp(F.DarkThoughtBuff)and a7 and not(g:BuffUp(F.VoidformBuff)and not af and F.MindBlast:FullRechargeTime()>=g:GCD()+0.150))then if o(F.MindFlay,nil,nil,not h:IsSpellInRange(F.MindFlay))then Y=15407;return"mind_flay 120"end end;if F.DevouringPlague:IsReady()and(U<3 or g:BuffUp(F.VoidformBuff))and U<4 and(ai and a7 and not a8)then if o(F.DevouringPlague,nil,nil,not h:IsSpellInRange(F.DevouringPlague))then Y=335467;return"devouring_plague 121"end end;if F.MindBlast:IsCastable()and(D==0 or D>F.MindBlast:CastTime()+0.5)and(not g:IsMoving()or g:BuffUp(F.DarkThoughtBuff))and(F.VoidBolt:CooldownRemains()>=F.MindBlast:CastTime()or not g:BuffUp(F.VoidformBuff))and(a7 and U<4+2*an(F.Misery:IsAvailable())+F.VampiricTouchDebuff:AuraActiveCount()*an(F.PsychicLink:IsAvailable())+E(5,U)*an(F.Mindbender:TimeSinceLastCast()<=15 and ak)and(not ak or(not al:CooldownUp()or not C)and ak or ae))then if o(F.MindBlast,nil,nil,not h:IsSpellInRange(F.MindBlast))then Y=8092;return"mind_blast 122"end end;if F.VampiricTouch:IsCastable()and(D==0 or D>F.VampiricTouch:CastTime()+0.5)and not g:IsMoving()and not g:IsCasting(F.VampiricTouch)and h:IsSpellInRange(F.VampiricTouch)and(h:DebuffRefreshable(F.VampiricTouchDebuff)and(h:TimeToDie()>18 or h:IsDummy()or h:NPCID()==153285)and(h:DebuffUp(F.VampiricTouchDebuff)or not ae)and ac>0 or F.Misery:IsAvailable()and h:DebuffRefreshable(F.ShadowWordPainDebuff)or g:BuffUp(F.UnfurlingDarknessBuff))then if o(F.VampiricTouch,nil)then Y=34914;return"vampiric_touch 124"end end;if F.VampiricTouch:IsCastable()and(D==0 or D>F.VampiricTouch:CastTime()+0.5)and not g:IsMoving()and(U<=4 or U<7 and g:Insanity()<30 and g:BuffDown(F.DarkThoughtBuff))then if a1.CastCycle(F.VampiricTouch,R,aF,not h:IsSpellInRange(F.VampiricTouch))then return"vampiric_touch 124"end end;if F.ShadowWordPain:IsCastable()and U<4 and(h:DebuffRefreshable(F.ShadowWordPainDebuff)and h:TimeToDie()>4 and not F.Misery:IsAvailable()and F.PsychicLink:IsAvailable()and U>2)then if o(F.ShadowWordPain,nil,nil,not h:IsSpellInRange(F.ShadowWordPain))then Y=589;return"shadow_word_pain 126"end end;if F.ShadowWordPain:IsCastable()and(h:DebuffRefreshable(F.ShadowWordPainDebuff)and h:IsSpellInRange(F.ShadowWordPain)and(h:TimeToDie()>4 or h:IsDummy()or h:NPCID()==153285)and not F.Misery:IsAvailable()and not(F.SearingNightmare:IsAvailable()and U>a9)and(not F.PsychicLink:IsAvailable()or F.PsychicLink:IsAvailable()and U<=2))then if o(F.ShadowWordPain,nil)then Y=589;return"shadow_word_pain 128"end end;if F.ShadowWordPain:IsCastable()and U<=4 and not F.Misery:IsAvailable()then if a1.CastCycle(F.ShadowWordPain,R,aG,not h:IsSpellInRange(F.ShadowWordPain))then return"shadow_word_pain 128"end end;if F.MindSear:IsCastable()and(D==0 or D>1)and not g:IsMoving()and not g:IsChanneling(F.MindSear)and U>a9 and(F.VoidBolt:CooldownRemains()>=g:GCD()*0.75 or not g:BuffUp(F.VoidformBuff)or U>6)then if o(F.MindSear,nil,nil,not h:IsSpellInRange(F.MindSear))then Y=48045;return"mind_sear 130"end end;if F.MindFlay:IsCastable()and(D==0 or D>1)and not g:IsMoving()and U<=a9 and not g:IsChanneling(F.MindFlay)and(g:BuffDown(F.DarkThoughtBuff)or F.VoidBolt:CooldownUp()and(g:BuffUp(F.VoidformBuff)or g:BuffDown(F.DarkThoughtBuff)and g:BuffUp(F.DissonantEchoesBuff)))and(F.VoidBolt:CooldownRemains()>=g:GCD()*0.75 or not g:BuffUp(F.VoidformBuff))then if o(F.MindFlay,nil,nil,not h:IsSpellInRange(F.MindFlay))then Y=15407;return"mind_flay 132"end end;if F.ShadowWordDeath:IsReady()and g:IsMoving()then if o(F.ShadowWordDeath,nil,nil,not h:IsSpellInRange(F.ShadowWordDeath))then Y=136149;return"shadow_word_death 133"end end;if F.ShadowWordPain:IsCastable()and g:IsMoving()then if o(F.ShadowWordPain,nil,nil,not h:IsSpellInRange(F.ShadowWordPain))then Y=589;return"shadow_word_pain 134"end end end;local function aS()s=HeroRotationCharDB.Toggles[6]q=HeroRotationCharDB.Toggles[4]r=HeroRotationCharDB.Toggles[5]u=HeroRotationCharDB.Toggles[12]t=not HeroRotationCharDB.Toggles[15]v=HeroRotationCharDB.Toggles[60]w=HeroRotationCharDB.Toggles[61]x=HeroRotationCharDB.Toggles[62]y=false;z=false;A=false;B=false;C=false;if a2.Shadow.PowerInfusion=="CDs"and n()or a2.Shadow.PowerInfusion=="Small CDs"and(n()or r)or a2.Shadow.PowerInfusion=="Always"then y=true end;if a2.Shadow.VoidEruption=="CDs"and n()or a2.Shadow.VoidEruption=="Small CDs"and(n()or r)or a2.Shadow.VoidEruption=="Always"then z=true end;if a2.Shadow.VoidTorrent=="CDs"and n()or a2.Shadow.VoidTorrent=="Small CDs"and(n()or r)or a2.Shadow.VoidTorrent=="Always"then A=true end;if a2.Shadow.MindBender=="CDs"and n()or a2.Shadow.MindBender=="Small CDs"and(n()or r)or a2.Shadow.MindBender=="Always"then C=true end;if a2.Shadow.ShadowCrash=="CDs"and n()or a2.Shadow.ShadowCrash=="Small CDs"and(n()or r)or a2.Shadow.ShadowCrash=="Always"then B=true end;D=0;for aT=1,20 do if select(10,UnitDebuff("player",aT))==240447 then if select(6,UnitDebuff("player",aT))~=nil then D=select(6,UnitDebuff("player",aT))-GetTime()end end end;a0=0;if F.Fleshcraft:IsCastable()and(D==0 or D>F.Fleshcraft:ExecuteTime())and q and not g:IsMoving()and(F.PustuleEruption:SoulbindEnabled()or F.VolatileSolvent:SoulbindEnabled())then a0=a0+3 end;if F.ArcaneTorrent:IsCastable()and n()then a0=a0+g:GCD()end;if(G.ShadowedOrbofTorment:ID()==L and a2.Commons.Enabled.TopTrinket or G.ShadowedOrbofTorment:ID()==N and a2.Commons.Enabled.BottomTrinket)and G.ShadowedOrbofTorment:IsEquippedAndReady()and(D==0 or D>2)then a0=a0+2 end;if F.VampiricTouch:IsCastable()and(D==0 or D>F.VampiricTouch:CastTime()+0.5)and not F.Damnation:IsAvailable()then a0=a0+F.VampiricTouch:CastTime()end;if F.MindBlast:IsReady()and(D==0 or D>F.MindBlast:CastTime()+0.5)and F.Damnation:IsAvailable()then a0=a0+F.MindBlast:CastTime()end end;local function aU()P=g:GetEnemiesInMeleeRange(8)Q=g:GetEnemiesInRange(30)R=g:GetEnemiesInRange(40)S=h:GetEnemiesInSplashRange(15)L,M=GetInventoryItemID("player",13)N,M=GetInventoryItemID("player",14)if m()and a2.Commons.AoeMode=="Conservative"then T=h:GetEnemiesInSplashRangeCount(8)U=h:GetEnemiesInSplashRangeCount(15)elseif m()and a2.Commons.AoeMode=="Aggresive"then local aV=0;for aW=1,20 do local aX="nameplate"..aW;if UnitExists(aX)then if UnitCanAttack("player",aX)then if UnitCanAttack("player",aX)and UnitAffectingCombat("target")and IsItemInRange(32698,aX)and UnitDetailedThreatSituation("player",aX)~=nil or f(aX):IsDummy()or string.find(UnitGUID(aX),153285)or string.find(UnitGUID(aX),31146)or string.find(UnitGUID(aX),176581)or string.find(UnitGUID(aX),179124)or string.find(UnitGUID(aX),179010)or string.find(UnitGUID(aX),180323)or string.find(UnitGUID(aX),179010)or string.find(UnitGUID(aX),179942)or string.find(UnitGUID(aX),176521)or string.find(UnitGUID(aX),177594)or string.find(UnitGUID(aX),177117)or string.find(UnitGUID(aX),176581)or string.find(UnitGUID(aX),180840)or string.find(UnitGUID(aX),176605)or UnitName(aX)=="Glacial Spike"or string.find(UnitGUID(aX),180473)or string.find(UnitGUID(aX),180474)or string.find(UnitGUID(aX),176929)or string.find(UnitGUID(aX),176920)or string.find(UnitGUID(aX),177154)or string.find(UnitGUID(aX),177787)or string.find(UnitGUID(aX),177889)or string.find(UnitGUID(aX),177891)or string.find(UnitGUID(aX),177892)or string.find(UnitGUID(aX),168326)or string.find(UnitGUID(aX),182778)or string.find(UnitGUID(aX),183945)then aV=aV+1 end end end end;T=aV;U=aV end;local aY=0;for aZ=1,20 do local aX="nameplate"..aZ;if UnitExists(aX)then if UnitCanAttack("player",aX)then if UnitCanAttack("player",aX)and UnitAffectingCombat("target")and IsItemInRange(32698,aX)and UnitDetailedThreatSituation("player",aX)~=nil and f(aX):TimeToDie()>=12 or f(aX):IsDummy()or string.find(UnitGUID(aX),153285)or string.find(UnitGUID(aX),31146)or string.find(UnitGUID(aX),176581)or string.find(UnitGUID(aX),179124)or string.find(UnitGUID(aX),179010)or string.find(UnitGUID(aX),180323)or string.find(UnitGUID(aX),179010)or string.find(UnitGUID(aX),179942)or string.find(UnitGUID(aX),176521)or string.find(UnitGUID(aX),177594)or string.find(UnitGUID(aX),177117)or string.find(UnitGUID(aX),176581)or string.find(UnitGUID(aX),180840)or string.find(UnitGUID(aX),176605)or UnitName(aX)=="Glacial Spike"or string.find(UnitGUID(aX),180473)or string.find(UnitGUID(aX),180474)or string.find(UnitGUID(aX),176929)or string.find(UnitGUID(aX),176920)or string.find(UnitGUID(aX),177154)or string.find(UnitGUID(aX),177787)or string.find(UnitGUID(aX),177889)or string.find(UnitGUID(aX),177891)or string.find(UnitGUID(aX),177892)or string.find(UnitGUID(aX),168326)or string.find(UnitGUID(aX),182778)or string.find(UnitGUID(aX),183945)then aY=aY+1 end end end end;if not m()then T=1;U=1;aY=1 end;if v then U=10;T=10 end;V=at(S)W=ay(S)if not BotOn then X=0;Y=0 end;if X>0 then X=0 end;if Y>0 then Y=0 end;O=aS()if j(200174):IsAvailable()then al=j(200174)else al=j(34433)end;if l.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+l.GUISettings.General.OpenerReset elseif l.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]l.ToggleIconFrame:UpdateButtonText(6)l.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if w and F.MassDispell:IsUsableP()and F.MassDispell:CooldownRemains(BypassRecovery)<=0 then if l.Cast(F.MassDispell,nil,nil,nil)then Y=327830;return"queue RingOfPeace"end elseif(not F.MassDispell:IsUsableP()or F.MassDispell:CooldownRemains(BypassRecovery)>0)and w then HeroRotationCharDB.Toggles[61]=not HeroRotationCharDB.Toggles[61]l.Print("Mass Dispel Queue is now "..(HeroRotationCharDB.Toggles[61]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if x and j(9484):IsUsableP()and j(9484):CooldownRemains(BypassRecovery)<=0 then if f("mouseover"):GUID()~=nil and f("mouseover"):IsInRange(30)then X=19484;return"queue Shackle MO"end elseif(not j(9484):IsUsableP()or j(9484):CooldownRemains()>0 or g:PrevGCD(1,j(9484)))and x then HeroRotationCharDB.Toggles[62]=not HeroRotationCharDB.Toggles[62]l.Print("Shackle Undead Queue is now "..(HeroRotationCharDB.Toggles[62]and"|cff00ff00on|r."or"|cffff0000off|r."))end;local a_=select(1,UnitCastingInfo("player"))if D~=0 and D<0.5 and(g:IsChanneling(F.MindSear)or g:IsChanneling(F.MindFlay))then if o(F.Pool,nil)then Y=1999;return"Quaking Stope"end end;if g:IsDeadOrGhost()then Y=999 end;if g:IsChanneling(j(355321))then if o(F.Pool,nil)then Y=999;return"Trinket Channel"end end;if F.Shadowform:IsCastable()and g:BuffDown(F.ShadowformBuff)then if o(F.Shadowform,nil)then Y=232698;return"shadowform 4"end end;if F.PowerWordShield:IsCastable()and g:DebuffDown(F.WeakenedSoul)and not g:IsChanneling()and not g:IsCasting()and(a2.Shadow.PWS=="Moving"and g:IsMoving()or a2.Shadow.PWS=="Always"or a2.Shadow.PWS=="OOC Moving"and g:IsMoving()and not g:AffectingCombat())then if o(F.PowerWordShield,nil)then Y=17;return"PW:S Settings"end end;if g:IsChanneling(F.VoidTorrent)then local O=aQ()if O then return O end;if o(F.Pool,nil)then Y=99999;return"channeling 4"end end;if g:IsChanneling(j(324631))then if g:AffectingCombat()and a2.Shadow.CastCancelFC then Y=1999 elseif l.CastAnnotated(F.Pool,false,"WAIT")then Y=99999;return"Pool During Fleshcraft"end end;a9=2;if not g:AffectingCombat()and(s or a2.Commons.DBMSupport and l.BossMods:GetPullTimer()<a0+g:GCD()and l.BossMods:GetPullTimer()>0)and a1.TargetIsValid()and not g:IsMoving()then local O=aL()if O then return O end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if F.ShadowWordDeath:IsCastable()then if o(F.ShadowWordDeath,nil)then X=1136149;return"explosive MO SWD"end end;if F.ShadowWordPain:IsCastable()then if o(F.ShadowWordPain,nil)then X=1589;return"explosive MO SWP"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if F.ShadowWordDeath:IsCastable()then if o(F.ShadowWordDeath,nil)then Y=136149;return"explosive  SWD"end end;if F.ShadowWordPain:IsCastable()then if o(F.ShadowWordPain,nil)then Y=589;return"explosive  SWP"end end end;if a1.TargetIsValid()and g:AffectingCombat()and(h:AffectingCombat()or h:IsDummy()or h:NPCID()==153285 or h:NPCID()==168326 or h:NPCID()==176581 or h:NPCID()==176920 or h:NPCID()==177892 or h:NPCID()==182778 or h:NPCID()==185402 or h:NPCID()==183945 or h:NPCID()==182074 or h:NPCID()==184737 or h:NPCID()==179733 or UnitExists("boss1"))and not g:IsDeadOrGhost()then _=d.FightRemains(S,false)if h:IsDummy()or h:NPCID()==153285 or h:NPCID()==168326 or h:NPCID()==176581 or h:NPCID()==176920 then _=99999999999 end;a5=d.CombatTime()a6=_+a5;if F.Dispersion:IsCastable()and g:HealthPercentage()<a2.Shadow.DispersionHP then if o(F.Dispersion,nil)then Y=47585;return"dispersion low_hp"end end;if F.DesperatePrayer:IsCastable()and g:HealthPercentage()<a2.Shadow.DesperatePrayerHP then if o(F.DesperatePrayer,nil)then Y=19236;return"DesperatePrayer low_hp"end end;if g:HealthPercentage()<a2.Commons.HealthstoneHP and G.Healthstone:IsReady()and G.Healthstone:CooldownRemains()<=0 then if l.Cast(G.Healthstone,nil)then Y=40;return"Healthstone HP"end end;if g:HealthPercentage()<a2.Commons.HealPotHP and G.CosmicHealPot:IsReady()and G.CosmicHealPot:CooldownRemains()<=0 then if l.Cast(G.CosmicHealPot,nil)then Y=45;return"CosmicHealPot HP"end end;if g:HealthPercentage()<a2.Commons.HealPotHP and G.HealPot:IsReady()and G.HealPot:CooldownRemains()<=0 then if l.Cast(G.HealPot,nil)then Y=41;return"HealPot HP"end end;if G.PotionofPhantomFire:IsReady()and a2.Commons.Enabled.Potions and t and((g:BuffUp(F.VoidformBuff)or g:BuffUp(F.PowerInfusionBuff))and not l.GUISettings.General.HoldPotforBL or l.GUISettings.General.HoldPotforBL and g:BloodlustUp())then if o(G.PotionofPhantomFire,nil,nil)then Y=50;return"potion_of_phantomfire 2"end end;if G.PotionofSpectralIntellect:IsReady()and a2.Commons.Enabled.Potions and t and((g:BuffUp(F.VoidformBuff)or g:BuffUp(F.PowerInfusionBuff))and not l.GUISettings.General.HoldPotforBL or l.GUISettings.General.HoldPotforBL and g:BloodlustUp())then if o(G.PotionofSpectralIntellect,nil,nil)then Y=50;return"potion_of_spectral_intellect 2"end end;a9=2;a7=aq(h,false)a8=aq(h,true)aa=U>2+an(g:BuffUp(F.VoidformBuff))ab=not SpheresHarmonyEquipped and(am~=4 or(a6>=33 and a5<=20 or a6<=25 and a6>=20))or F.PowerInfusion:CooldownRemains()<g:GCD()*3 or g:BuffUp(F.PowerInfusionBuff)or _<=25;ac=aY;if F.SearingNightmare:IsAvailable()and aY==7 then ac=5+2*an(ab and F.VoidEruption:CooldownRemains()<=10 and F.HungeringVoid:IsAvailable())end;if F.SearingNightmare:IsAvailable()and U>=7 then ac=0 end;if F.SearingNightmare:IsAvailable()and aY>4 then ac=4 end;if F.SearingNightmare:IsAvailable()and aY>=8 and not F.ShadowCrash:IsAvailable()then ac=0 end;if g:BuffUp(F.VoidformBuff)then ac=an(aY<=5)*aY end;ad=0;if h:TimeToDie()>=18 then ad=1 end;ae=F.VampiricTouchDebuff:AuraActiveCount()>=ac or not ad;af=F.VoidEruption:CooldownUp()and z and ab;if n()then if F.Fireblood:IsCastable()and g:BuffUp(F.VoidformBuff)then if o(F.Fireblood,nil)then Y=265221;return"fireblood 22"end end;if F.Berserking:IsCastable()and g:BuffUp(F.VoidformBuff)then if o(F.Berserking,nil)then Y=26297;return"berserking 24"end end;if F.LightsJudgment:IsCastable()and U>=2 then if o(F.LightsJudgment,nil,nil,not h:IsSpellInRange(F.LightsJudgment))then Y=255647;return"lights_judgment 26"end end;if F.AncestralCall:IsCastable()and g:BuffUp(F.VoidformBuff)then if o(F.AncestralCall,nil)then Y=274738;return"ancestral_call 28"end end;if F.BagofTricks:IsCastable()then if o(F.BagofTricks,nil,nil,not h:IsSpellInRange(F.BagofTricks))then Y=312411;return"bag_of_tricks 30"end end end;if true then local O=aQ()if O then return O end end;if true then local O=aR()if O then return O end end end;if a1.TargetIsValid()and not UnitIsFriend("target","player")and g:AffectingCombat()and(not h:AffectingCombat()and not h:IsDummy()and h:NPCID()~=153285)and not u then X=999 end end;local function b0()F.VampiricTouchDebuff:RegisterAuraTracking()end;function ReturnSpell()if Y==0 then return 0 else return Y end end;function ReturnSpellMO()if X==0 then return 0 else return X end end;l.SetAPL(258,aU,b0)